<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#5698c3"><meta name="author" content="语轻星子"><meta name="copyright" content="语轻星子"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>CodeWhy-JavaScript高级-学习笔记1 | 轻语馆</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js" defer></script><script src="/js/pjax.js" defer></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><link class="aplayer-style-marker" rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script class="aplayer-script-marker" src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" defer></script><script class="meting-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js" defer></script><script>document.addEventListener(
  "pjax:success",
  function() {
    if (window.aplayers) {
      loadMeting();
    }
  },
  !1
);
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#5698c3"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"xxcijmz.top","root":"/","title":"轻语馆","version":"1.6.2","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"/data/sentences.json"},"algolia":{"appID":"I6Q6TFSWKC","apiKey":"8299a265813c86a465cc32755761abc9","indexName":"blogs","hits":{"per_page":10}}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="stylesheet" href="/css/content.css"><script src="//at.alicdn.com/t/font_3171041_jyp164m1jzi.js" async></script><meta name="description" content="深入JavaScript运行原理浏览器的工作原理 认识浏览器的内核 我们经常会说：不同的浏览器有不同的内核组成  Gecko：早期被Netscape和Mozilla Firefox浏览器浏览器使用；  Trident：微软开发，被IE4~IE11浏览器使用，但是Edge浏览器已经转向Blink；   Webkit：苹果基于KHTML开发、开源的，用于Safari，Google Chrome之前也在">
<meta property="og:type" content="article">
<meta property="og:title" content="CodeWhy-JavaScript高级-学习笔记1">
<meta property="og:url" content="https://xxcijmz.top/blogs/f3f94af8/index.html">
<meta property="og:site_name" content="轻语馆">
<meta property="og:description" content="深入JavaScript运行原理浏览器的工作原理 认识浏览器的内核 我们经常会说：不同的浏览器有不同的内核组成  Gecko：早期被Netscape和Mozilla Firefox浏览器浏览器使用；  Trident：微软开发，被IE4~IE11浏览器使用，但是Edge浏览器已经转向Blink；   Webkit：苹果基于KHTML开发、开源的，用于Safari，Google Chrome之前也在">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/1.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/2.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/4.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/3.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/5.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/7.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/9.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/10.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/8.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/12.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/11.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/13.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/14.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/15.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/16.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/17.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/18.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/19.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/20.jpg">
<meta property="og:image" content="https://xxcijmz.top/blogs/f3f94af8/21.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/22.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/23.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/24.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/25.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/26.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/27.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/28.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/29.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/30.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/31.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/32.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/33.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/34.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/35.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/36.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/37.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/38.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/39.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/40.jpg">
<meta property="og:image" content="https://xxcijmz.top/blogs/f3f94af8/41.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/42.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/43.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/44.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/45.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/46.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/47.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/48.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/49.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/50.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/51.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/52.jpg">
<meta property="og:image" content="https://xxcijmz.top/blogs/f3f94af8/53.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/54.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/55.jpg">
<meta property="og:image" content="https://xxcijmz.top/blogs/f3f94af8/56.jpg">
<meta property="og:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/57.jpg">
<meta property="og:image" content="https://xxcijmz.top/blogs/f3f94af8/3_webfront2021/four_front/Blog/source_posts/CodeWhy-JavaScript高级-学习笔记1/59.jpg">
<meta property="og:image" content="https://xxcijmz.top/blogs/f3f94af8/.jpg">
<meta property="article:published_time" content="2022-01-29T14:48:49.000Z">
<meta property="article:modified_time" content="2022-02-14T06:50:33.721Z">
<meta property="article:author" content="语轻星子">
<meta property="article:tag" content="JavaScript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/1.jpg"><script src="/js/ui/mode.js"></script></head><body><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="语轻星子"><img width="96" loading="lazy" src="https://cdn.jsdelivr.net/gh/xxc-yqxz/xxc-yqxz.github.io/images/avatar.jpg" alt="语轻星子"></a><div class="site-author-name"><a href="/about/">语轻星子</a></div><span class="site-name">轻语馆</span><sub class="site-subtitle">我也会加油，所以你也要加油，这是约定</sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">49</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">17</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">18</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://github.com/xxc-yqxz/xxc-yqxz.github.io" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://wpa.qq.com/msgrd?v=3&amp;uin=894043590&amp;site=qq&amp;menu=yes" title="QQ" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=1379764422" title="网易云音乐" target="_blank" style="color:#C10D0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/269921139" title="哔哩哔哩" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/demoShow/" title="布局练习" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-css"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B7%B1%E5%85%A5JavaScript%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">深入JavaScript运行原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">1.1.</span> <span class="toc-text">浏览器的工作原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%86%85%E6%A0%B8"><span class="toc-number">1.2.</span> <span class="toc-text">认识浏览器的内核</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B"><span class="toc-number">1.3.</span> <span class="toc-text">浏览器渲染过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86JavaScript%E5%BC%95%E6%93%8E"><span class="toc-number">1.4.</span> <span class="toc-text">认识JavaScript引擎</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%86%85%E6%A0%B8%E5%92%8CJS%E5%BC%95%E6%93%8E%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">1.5.</span> <span class="toc-text">浏览器内核和JS引擎的关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#V8%E5%BC%95%E6%93%8E%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-number">1.6.</span> <span class="toc-text">V8引擎的原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#V8%E5%BC%95%E6%93%8E%E7%9A%84%E6%9E%B6%E6%9E%84"><span class="toc-number">1.7.</span> <span class="toc-text">V8引擎的架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#V8%E5%BC%95%E6%93%8E%E7%9A%84%E8%A7%A3%E6%9E%90%E5%9B%BE"><span class="toc-number">1.8.</span> <span class="toc-text">V8引擎的解析图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript-%E4%BB%A3%E7%A0%81%E7%9A%84%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="toc-number">1.9.</span> <span class="toc-text">JavaScript 代码的执行过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98"><span class="toc-number">1.10.</span> <span class="toc-text">例题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%8E%AF%E5%A2%83%E5%92%8C%E7%8E%AF%E5%A2%83%E8%AE%B0%E5%BD%95"><span class="toc-number">1.11.</span> <span class="toc-text">变量环境和环境记录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="toc-number">1.12.</span> <span class="toc-text">面试题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JS%E7%9A%84%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%92%8C%E9%97%AD%E5%8C%85"><span class="toc-number">2.</span> <span class="toc-text">JS的内存管理和闭包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">2.1.</span> <span class="toc-text">认识内存管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JS%E7%9A%84%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">2.2.</span> <span class="toc-text">JS的内存管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JS%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6"><span class="toc-number">2.3.</span> <span class="toc-text">JS的垃圾回收</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84GC%E7%AE%97%E6%B3%95-%E5%BC%95%E7%94%A8%E8%AE%A1%E6%95%B0"><span class="toc-number">2.4.</span> <span class="toc-text">常见的GC算法 - 引用计数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JS%E4%B8%AD%E5%87%BD%E6%95%B0%E6%98%AF%E4%B8%80%E7%AD%89%E5%85%AC%E6%B0%91"><span class="toc-number">2.5.</span> <span class="toc-text">JS中函数是一等公民</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JS%E4%B8%AD%E9%97%AD%E5%8C%85%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">2.6.</span> <span class="toc-text">JS中闭包的定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AD%E5%8C%85%E7%9A%84%E8%AE%BF%E9%97%AE%E8%BF%87%E7%A8%8B"><span class="toc-number">2.7.</span> <span class="toc-text">闭包的访问过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AD%E5%8C%85%E7%9A%84%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F"><span class="toc-number">2.8.</span> <span class="toc-text">闭包的内存泄漏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E6%B5%8B%E8%AF%95"><span class="toc-number">2.9.</span> <span class="toc-text">内存泄漏测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AO%E4%B8%8D%E4%BD%BF%E7%94%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">2.10.</span> <span class="toc-text">AO不使用的问题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JS%E5%87%BD%E6%95%B0%E4%B8%AD%E7%9A%84-this-%E6%8C%87%E5%90%91"><span class="toc-number">3.</span> <span class="toc-text">JS函数中的 this 指向</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81this"><span class="toc-number">3.1.</span> <span class="toc-text">为什么需要this?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#this%E6%8C%87%E5%90%91%E4%BB%80%E4%B9%88%E5%91%A2%EF%BC%9F"><span class="toc-number">3.2.</span> <span class="toc-text">this指向什么呢？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%84%E5%88%99%E4%B8%80%EF%BC%9A%E9%BB%98%E8%AE%A4%E7%BB%91%E5%AE%9A"><span class="toc-number">3.3.</span> <span class="toc-text">规则一：默认绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%84%E5%88%99%E4%BA%8C%EF%BC%9A%E9%9A%90%E5%BC%8F%E7%BB%91%E5%AE%9A"><span class="toc-number">3.4.</span> <span class="toc-text">规则二：隐式绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%84%E5%88%99%E4%B8%89%EF%BC%9A%E6%98%BE%E7%A4%BA%E7%BB%91%E5%AE%9A"><span class="toc-number">3.5.</span> <span class="toc-text">规则三：显示绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#call%E3%80%81apply%E3%80%81bind"><span class="toc-number">3.5.1.</span> <span class="toc-text">call、apply、bind</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%84%E5%88%99%E5%9B%9B%EF%BC%9Anew-%E7%BB%91%E5%AE%9A"><span class="toc-number">3.6.</span> <span class="toc-text">规则四：new 绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0%E7%9A%84%E7%BB%91%E5%AE%9A%E6%80%9D%E8%80%83"><span class="toc-number">3.7.</span> <span class="toc-text">内置函数的绑定思考</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%84%E5%88%99%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">3.8.</span> <span class="toc-text">规则优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#this%E8%A7%84%E5%88%99%E4%B9%8B%E5%A4%96-%E2%80%93-%E5%BF%BD%E7%95%A5%E6%98%BE%E7%A4%BA%E7%BB%91%E5%AE%9A"><span class="toc-number">3.9.</span> <span class="toc-text">this规则之外 – 忽略显示绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#this%E8%A7%84%E5%88%99%E4%B9%8B%E5%A4%96-%E9%97%B4%E6%8E%A5%E5%87%BD%E6%95%B0%E5%BC%95%E7%94%A8"><span class="toc-number">3.10.</span> <span class="toc-text">this规则之外 - 间接函数引用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0-arrow-function"><span class="toc-number">3.11.</span> <span class="toc-text">箭头函数 arrow function</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#this%E8%A7%84%E5%88%99%E4%B9%8B%E5%A4%96-ES6%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0"><span class="toc-number">3.12.</span> <span class="toc-text">this规则之外 - ES6箭头函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E8%AF%95%E9%A2%98-1"><span class="toc-number">3.13.</span> <span class="toc-text">面试题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JS%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B"><span class="toc-number">4.</span> <span class="toc-text">JS函数式编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0call"><span class="toc-number">4.1.</span> <span class="toc-text">实现call</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0-apply"><span class="toc-number">4.2.</span> <span class="toc-text">实现 apply</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0bind"><span class="toc-number">4.3.</span> <span class="toc-text">实现bind</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86-arguments"><span class="toc-number">4.4.</span> <span class="toc-text">认识 arguments</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#arguments-%E8%BD%AC-array"><span class="toc-number">4.5.</span> <span class="toc-text">arguments 转 array</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E4%B8%AD%E4%B8%8D%E7%BB%91%E5%AE%9A-arguments"><span class="toc-number">4.6.</span> <span class="toc-text">箭头函数中不绑定 arguments</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%90%86%E8%A7%A3JavaScript-%E7%BA%AF%E5%87%BD%E6%95%B0"><span class="toc-number">4.7.</span> <span class="toc-text">理解JavaScript 纯函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%AF%E4%BD%9C%E7%94%A8%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-number">4.8.</span> <span class="toc-text">副作用的理解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%AF%E5%87%BD%E6%95%B0%E6%A1%88%E4%BE%8B"><span class="toc-number">4.9.</span> <span class="toc-text">纯函数案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%AF%E5%87%BD%E6%95%B0%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">4.10.</span> <span class="toc-text">纯函数的优势</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript-%E6%9F%AF%E9%87%8C%E5%8C%96"><span class="toc-number">4.11.</span> <span class="toc-text">JavaScript 柯里化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%AF%E9%87%8C%E5%8C%96-%E8%AE%A9%E5%87%BD%E6%95%B0%E7%9A%84%E8%81%8C%E8%B4%A3%E5%8D%95%E4%B8%80"><span class="toc-number">4.12.</span> <span class="toc-text">柯里化 - 让函数的职责单一</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%AF%E9%87%8C%E5%8C%96-%E9%80%BB%E8%BE%91%E7%9A%84%E5%A4%8D%E7%94%A8"><span class="toc-number">4.13.</span> <span class="toc-text">柯里化 - 逻辑的复用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E6%9F%AF%E9%87%8C%E5%8C%96%E5%87%BD%E6%95%B0"><span class="toc-number">4.14.</span> <span class="toc-text">自动柯里化函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%90%86%E8%A7%A3%E7%BB%84%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">4.15.</span> <span class="toc-text">理解组合函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E7%BB%84%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">4.16.</span> <span class="toc-text">实现组合函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JS%E9%A2%9D%E5%A4%96%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85"><span class="toc-number">5.</span> <span class="toc-text">JS额外知识补充</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#eval%E5%87%BD%E6%95%B0"><span class="toc-number">5.1.</span> <span class="toc-text">eval函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F"><span class="toc-number">5.2.</span> <span class="toc-text">认识严格模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%90%AF%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F"><span class="toc-number">5.3.</span> <span class="toc-text">开启严格模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F%E9%99%90%E5%88%B6"><span class="toc-number">5.4.</span> <span class="toc-text">严格模式限制</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B7%B1%E5%85%A5JS%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1"><span class="toc-number">6.</span> <span class="toc-text">深入JS面向对象</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript-%E7%9A%84%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1"><span class="toc-number">6.1.</span> <span class="toc-text">JavaScript 的面向对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E5%B1%9E%E6%80%A7%E6%93%8D%E4%BD%9C%E7%9A%84%E6%8E%A7%E5%88%B6"><span class="toc-number">6.2.</span> <span class="toc-text">对属性操作的控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Object-defineProperty"><span class="toc-number">6.3.</span> <span class="toc-text">Object.defineProperty</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0%E7%AC%A6%E5%88%86%E7%B1%BB"><span class="toc-number">6.4.</span> <span class="toc-text">属性描述符分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="toc-number">6.5.</span> <span class="toc-text">数据属性描述符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="toc-number">6.6.</span> <span class="toc-text">存储属性描述符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%A4%9A%E4%B8%AA%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="toc-number">6.7.</span> <span class="toc-text">定义多个属性描述符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E6%96%B9%E6%B3%95%E7%9A%84%E8%A1%A5%E5%85%85"><span class="toc-number">6.8.</span> <span class="toc-text">对象方法的补充</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E6%A1%88-%E5%AD%97%E9%9D%A2%E9%87%8F"><span class="toc-number">6.9.</span> <span class="toc-text">创建对象的方案-字面量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E6%A1%88-%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F"><span class="toc-number">6.10.</span> <span class="toc-text">创建对象的方案-工厂模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E6%A1%88-%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">6.11.</span> <span class="toc-text">创建对象的方案-构造函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%8E%9F%E5%9E%8B"><span class="toc-number">6.12.</span> <span class="toc-text">认识对象的原型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E5%8E%9F%E5%9E%8B-prototype"><span class="toc-number">6.13.</span> <span class="toc-text">函数的原型 prototype</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#constructor-%E5%B1%9E%E6%80%A7"><span class="toc-number">6.14.</span> <span class="toc-text">constructor 属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1-%E2%80%93-%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E5%92%8C%E5%8E%9F%E5%9E%8B%E7%BB%84%E5%90%88"><span class="toc-number">6.15.</span> <span class="toc-text">创建对象 – 构造函数和原型组合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript-%E4%B8%AD%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1"><span class="toc-number">6.16.</span> <span class="toc-text">JavaScript 中类和对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%89%B9%E6%80%A7-%E7%BB%A7%E6%89%BF"><span class="toc-number">6.17.</span> <span class="toc-text">面对对象的特性 - 继承</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript-%E5%8E%9F%E5%9E%8B%E9%93%BE"><span class="toc-number">6.18.</span> <span class="toc-text">JavaScript 原型链</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%8E%9F%E5%9E%8B%E9%93%BE%E5%AE%9E%E7%8E%B0%E7%BB%A7%E6%89%BF"><span class="toc-number">6.19.</span> <span class="toc-text">通过原型链实现继承</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%80%9F%E7%94%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%BB%A7%E6%89%BF"><span class="toc-number">6.20.</span> <span class="toc-text">借用构造函数继承</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E5%80%9F%E7%94%A8%E7%BB%A7%E6%89%BF%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">6.21.</span> <span class="toc-text">组合借用继承的问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E5%BC%8F%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">6.22.</span> <span class="toc-text">原型式构造函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%84%E7%94%9F%E5%BC%8F%E7%BB%A7%E6%89%BF%E5%87%BD%E6%95%B0"><span class="toc-number">6.23.</span> <span class="toc-text">寄生式继承函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%84%E7%94%9F%E7%BB%84%E5%90%88%E5%BC%8F%E7%BB%A7%E6%89%BF"><span class="toc-number">6.24.</span> <span class="toc-text">寄生组合式继承</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E6%B3%95%E8%A1%A5%E5%85%85"><span class="toc-number">6.25.</span> <span class="toc-text">对象的方法补充</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB"><span class="toc-number">6.26.</span> <span class="toc-text">原型继承关系</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ES6-%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">7.</span> <span class="toc-text">ES6 相关知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86-class-%E5%AE%9A%E4%B9%89%E7%B1%BB"><span class="toc-number">7.1.</span> <span class="toc-text">认识 class 定义类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">7.2.</span> <span class="toc-text">类的构造函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95"><span class="toc-number">7.3.</span> <span class="toc-text">类的实例方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E8%AE%BF%E9%97%AE%E5%99%A8%E6%96%B9%E6%B3%95"><span class="toc-number">7.4.</span> <span class="toc-text">类的访问器方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="toc-number">7.5.</span> <span class="toc-text">类的静态方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES6%E7%9A%84%E7%BB%A7%E6%89%BF-extends"><span class="toc-number">7.6.</span> <span class="toc-text">ES6的继承 - extends</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF%E5%86%85%E7%BD%AE%E7%B1%BB"><span class="toc-number">7.7.</span> <span class="toc-text">继承内置类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E6%B7%B7%E5%85%A5-mixin"><span class="toc-number">7.8.</span> <span class="toc-text">类的混入 mixin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript-%E7%9A%84%E5%A4%9A%E6%80%81"><span class="toc-number">7.9.</span> <span class="toc-text">JavaScript 的多态</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E9%9D%A2%E9%87%8F%E7%9A%84%E5%A2%9E%E5%BC%BA"><span class="toc-number">7.10.</span> <span class="toc-text">字面量的增强</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E6%9E%84Destructuring"><span class="toc-number">7.11.</span> <span class="toc-text">解构Destructuring</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E6%9E%84%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">7.12.</span> <span class="toc-text">解构的应用场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#let-const-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">7.13.</span> <span class="toc-text">let&#x2F;const 基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#let-const-%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%8F%90%E5%8D%87"><span class="toc-number">7.14.</span> <span class="toc-text">let&#x2F;const 作用域提升</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#var-%E7%9A%84%E5%9D%97%E7%BA%A7%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">7.15.</span> <span class="toc-text">var 的块级作用域</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#let-const-%E7%9A%84%E5%9D%97%E7%BA%A7%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">7.16.</span> <span class="toc-text">let&#x2F;const 的块级作用域</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9D%97%E7%BA%A7%E4%BD%9C%E7%94%A8%E5%9F%9F%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-number">7.17.</span> <span class="toc-text">块级作用域的应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9D%97%E7%BA%A7%E4%BD%9C%E7%94%A8%E5%9F%9F%E7%9A%84%E8%A1%A5%E5%85%85"><span class="toc-number">7.18.</span> <span class="toc-text">块级作用域的补充</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9A%82%E6%97%B6%E6%80%A7%E6%AD%BB%E5%8C%BA"><span class="toc-number">7.19.</span> <span class="toc-text">暂时性死区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#var%E3%80%81let%E3%80%81const%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-number">7.20.</span> <span class="toc-text">var、let、const的选择</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A8%A1%E6%9D%BF%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">7.21.</span> <span class="toc-text">字符串模板基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%87%E7%AD%BE%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BD%BF%E7%94%A8"><span class="toc-number">7.22.</span> <span class="toc-text">标签模板字符串使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0"><span class="toc-number">7.23.</span> <span class="toc-text">函数的默认参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E5%89%A9%E4%BD%99%E5%8F%82%E6%95%B0"><span class="toc-number">7.24.</span> <span class="toc-text">函数的剩余参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E7%9A%84%E8%A1%A5%E5%85%85"><span class="toc-number">7.25.</span> <span class="toc-text">箭头函数的补充</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%95%E5%BC%80%E8%AF%AD%E6%B3%95"><span class="toc-number">7.26.</span> <span class="toc-text">展开语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E7%9A%84%E8%A1%A8%E7%A4%BA"><span class="toc-number">7.27.</span> <span class="toc-text">数值的表示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Symbol-%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">7.28.</span> <span class="toc-text">Symbol 的基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Set%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">7.29.</span> <span class="toc-text">Set的基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WeakSet-%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">7.30.</span> <span class="toc-text">WeakSet 的基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WeakSet-%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">7.31.</span> <span class="toc-text">WeakSet 的应用场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Map-%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">7.32.</span> <span class="toc-text">Map 的基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WeakMap-%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">7.33.</span> <span class="toc-text">WeakMap 的基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WeakMap-%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">7.34.</span> <span class="toc-text">WeakMap 的应用场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ES6-%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9-1"><span class="toc-number">8.</span> <span class="toc-text">ES6+ 相关知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ES7-%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">8.1.</span> <span class="toc-text">ES7 相关知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E6%95%B0-%E4%B9%98%E6%96%B9-exponentiation%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">8.1.1.</span> <span class="toc-text">指数(乘方) exponentiation运算符</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES8-%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">8.2.</span> <span class="toc-text">ES8 相关知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Object-Values"><span class="toc-number">8.2.1.</span> <span class="toc-text">Object Values</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Object-entries"><span class="toc-number">8.2.2.</span> <span class="toc-text">Object entries</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#String-Padding"><span class="toc-number">8.2.3.</span> <span class="toc-text">String Padding</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Trailing-Commas"><span class="toc-number">8.2.4.</span> <span class="toc-text">Trailing Commas</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Object-getOwnPropertyDescriptors"><span class="toc-number">8.2.5.</span> <span class="toc-text">Object.getOwnPropertyDescriptors</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES9-%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">8.3.</span> <span class="toc-text">ES9 相关知识点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES10-%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">8.4.</span> <span class="toc-text">ES10 相关知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flat-flatMap"><span class="toc-number">8.4.1.</span> <span class="toc-text">flat flatMap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Object-fromEntries"><span class="toc-number">8.4.2.</span> <span class="toc-text">Object fromEntries</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#trimStart-%E4%B8%8E-trimEnd"><span class="toc-number">8.4.3.</span> <span class="toc-text">trimStart 与 trimEnd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ES10%E5%85%B6%E5%AE%83%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">8.4.4.</span> <span class="toc-text">ES10其它知识点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES11-%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">8.5.</span> <span class="toc-text">ES11 相关知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BigInt"><span class="toc-number">8.5.1.</span> <span class="toc-text">BigInt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nullish-Coalescing-Operator%EF%BC%88%EF%BC%9F%EF%BC%9F%EF%BC%89"><span class="toc-number">8.5.2.</span> <span class="toc-text">Nullish Coalescing Operator（？？）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Optional-Chaining%EF%BC%88%E5%8F%AF%E9%80%89%E9%93%BE%EF%BC%89"><span class="toc-number">8.5.3.</span> <span class="toc-text">Optional Chaining（可选链）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#globalThis"><span class="toc-number">8.5.4.</span> <span class="toc-text">globalThis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#for%E2%80%A6in-%E6%A0%87%E5%87%86%E5%8C%96"><span class="toc-number">8.5.5.</span> <span class="toc-text">for…in 标准化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ES11-%E5%85%B6%E5%AE%83%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">8.5.6.</span> <span class="toc-text">ES11 其它知识点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES12-%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">8.6.</span> <span class="toc-text">ES12 相关知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FinalizationRegistry"><span class="toc-number">8.6.1.</span> <span class="toc-text">FinalizationRegistry</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WeakRef"><span class="toc-number">8.6.2.</span> <span class="toc-text">WeakRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#logical-assignment-operators"><span class="toc-number">8.6.3.</span> <span class="toc-text">logical assignment operators</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ES12-%E5%85%B6%E5%AE%83%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">8.6.4.</span> <span class="toc-text">ES12 其它知识点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Proxy-Reflect-%E5%93%8D%E5%BA%94%E5%BC%8F"><span class="toc-number">9.</span> <span class="toc-text">Proxy-Reflect-响应式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">9.1.</span> <span class="toc-text">监听对象的操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Proxy-%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">9.2.</span> <span class="toc-text">Proxy 的基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Proxy-%E7%9A%84-set-%E5%92%8C-get-%E6%8D%95%E8%8E%B7%E5%99%A8"><span class="toc-number">9.3.</span> <span class="toc-text">Proxy 的 set 和 get 捕获器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Proxy-%E7%9A%84%E6%89%80%E6%9C%89%E6%8D%95%E8%8E%B7%E5%99%A8"><span class="toc-number">9.4.</span> <span class="toc-text">Proxy 的所有捕获器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reflect-%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">9.5.</span> <span class="toc-text">Reflect 的作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reflect-%E7%9A%84%E5%B8%B8%E8%A7%81%E6%96%B9%E6%B3%95"><span class="toc-number">9.6.</span> <span class="toc-text">Reflect 的常见方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Receiver-%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">9.7.</span> <span class="toc-text">Receiver 的作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reflect%E7%9A%84construct"><span class="toc-number">9.8.</span> <span class="toc-text">Reflect的construct</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%93%8D%E5%BA%94%E5%BC%8F%EF%BC%9F"><span class="toc-number">9.9.</span> <span class="toc-text">什么是响应式？</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Promise"><span class="toc-number">10.</span> <span class="toc-text">Promise</span></a></li></ol></div></div></div><div class="tag-cloud"><div class="tag-cloud-tags"><a href="/tags/JavaScript/" style="font-size: 27px; color: #8cbbd1">JavaScript</a> <a href="/tags/React/" style="font-size: 24px; color: #8dbad0">React</a> <a href="/tags/TypeScript/" style="font-size: 15px; color: #92b6cf">TypeScript</a> <a href="/tags/Vite/" style="font-size: 12px; color: #93b5cf">Vite</a> <a href="/tags/Vue/" style="font-size: 30px; color: #8abcd1">Vue</a> <a href="/tags/Vue3/" style="font-size: 15px; color: #92b6cf">Vue3</a> <a href="/tags/Webpack/" style="font-size: 15px; color: #92b6cf">Webpack</a> <a href="/tags/eggjs/" style="font-size: 18px; color: #90b7d0">eggjs</a> <a href="/tags/serverless/" style="font-size: 18px; color: #90b7d0">serverless</a> <a href="/tags/uniapp/" style="font-size: 21px; color: #8fb9d0">uniapp</a> <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 15px; color: #92b6cf">小程序</a> <a href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" style="font-size: 15px; color: #92b6cf">工程化</a> <a href="/tags/%E6%97%A5%E8%AE%B0/" style="font-size: 12px; color: #93b5cf">日记</a> <a href="/tags/%E6%97%A5%E8%AF%AD/" style="font-size: 12px; color: #93b5cf">日语</a> <a href="/tags/%E6%A6%82%E5%BF%B5/" style="font-size: 21px; color: #8fb9d0">概念</a> <a href="/tags/%E9%83%A8%E7%BD%B2/" style="font-size: 12px; color: #93b5cf">部署</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 15px; color: #92b6cf">面试</a> <a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 15px; color: #92b6cf">项目</a></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://xxcijmz.top/blogs/f3f94af8/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="语轻星子"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="轻语馆"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">CodeWhy-JavaScript高级-学习笔记1</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2022-01-29 22:48:49" itemprop="dateCreated datePublished" datetime="2022-01-29T22:48:49+08:00">2022-01-29</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="修改时间：2022-02-14 14:50:33" itemprop="dateModified" datetime="2022-02-14T14:50:33+08:00">2022-02-14</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="本文字数">37.4k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="阅读时长">154m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/CodeWhy/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">CodeWhy</span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/CodeWhy/JavaScript/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">JavaScript</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/JavaScript/" style="--text-color:#F4DF4F"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">JavaScript</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#5698c3;"><h1 id="深入JavaScript运行原理"><a href="#深入JavaScript运行原理" class="headerlink" title="深入JavaScript运行原理"></a>深入JavaScript运行原理</h1><h2 id="浏览器的工作原理"><a href="#浏览器的工作原理" class="headerlink" title="浏览器的工作原理"></a>浏览器的工作原理</h2><p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/1.jpg" loading="lazy"></p>
<h2 id="认识浏览器的内核"><a href="#认识浏览器的内核" class="headerlink" title="认识浏览器的内核"></a>认识浏览器的内核</h2><ul>
<li><p>我们经常会说：不同的浏览器有不同的内核组成</p>
<ul>
<li><p>Gecko：早期被Netscape和Mozilla Firefox浏览器浏览器使用；</p>
</li>
<li><p>Trident：微软开发，被IE4~IE11浏览器使用，但是Edge浏览器已经转向Blink； </p>
</li>
<li><p>Webkit：苹果基于KHTML开发、开源的，用于Safari，Google Chrome之前也在使用；</p>
</li>
<li><p>Blink：是Webkit的一个分支，Google开发，目前应用于Google Chrome、Edge、Opera等；</p>
</li>
<li><p>等等…</p>
</li>
</ul>
</li>
<li><p>事实上，我们经常说的浏览器内核指的是浏览器的排版引擎： </p>
<ul>
<li><strong>排版引擎</strong>（layout engine），也称为<strong>浏览器引擎</strong>（browser engine）、<strong>页面渲染引擎</strong>（rendering engine） 或<strong>样版引擎</strong>。</li>
</ul>
</li>
</ul>
<h2 id="浏览器渲染过程"><a href="#浏览器渲染过程" class="headerlink" title="浏览器渲染过程"></a>浏览器渲染过程</h2><p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/2.jpg" loading="lazy"></p>
<ul>
<li><p>在这个执行过程中，HTML解析的时候遇到了JavaScript标签，应该怎么办呢？</p>
<ul>
<li>会停止解析HTML，而去加载和执行JavaScript代码；</li>
</ul>
</li>
<li><p>那么，JavaScript代码由谁来执行呢？</p>
<ul>
<li><strong>JavaScript引擎</strong></li>
</ul>
</li>
</ul>
<h2 id="认识JavaScript引擎"><a href="#认识JavaScript引擎" class="headerlink" title="认识JavaScript引擎"></a>认识JavaScript引擎</h2><ul>
<li><p><strong>为什么需要JavaScript引擎呢？</strong></p>
<ul>
<li><p>我们前面说过，高级的编程语言都是需要转成最终的机器指令来执行的；</p>
</li>
<li><p>事实上我们编写的JavaScript无论你交给浏览器或者Node执行，最后都是需要被CPU执行的；</p>
</li>
<li><p>但是CPU只认识自己的指令集，实际上是机器语言，才能被CPU所执行；</p>
</li>
<li><p>所以我们需要JavaScript引擎帮助我们将JavaScript代码翻译成CPU指令来执行；</p>
</li>
</ul>
</li>
<li><p><strong>比较常见的JavaScript引擎有哪些呢？</strong></p>
<ul>
<li><p><strong>SpiderMonkey</strong>：第一款JavaScript引擎，由Brendan Eich开发（也就是JavaScript作者）；</p>
</li>
<li><p><strong>Chakra</strong>：微软开发，用于IT浏览器； </p>
</li>
<li><p><strong>JavaScriptCore</strong>：WebKit中的JavaScript引擎，Apple公司开发；</p>
</li>
<li><p><strong>V8</strong>：Google开发的强大JavaScript引擎，也帮助Chrome从众多浏览器中脱颖而出；</p>
</li>
<li><p>等等…</p>
</li>
</ul>
</li>
</ul>
<h2 id="浏览器内核和JS引擎的关系"><a href="#浏览器内核和JS引擎的关系" class="headerlink" title="浏览器内核和JS引擎的关系"></a>浏览器内核和JS引擎的关系</h2><ul>
<li><p>这里我们先以WebKit为例，WebKit事实上由两部分组成的：</p>
<ul>
<li><p><strong>WebCore：</strong>负责HTML解析、布局、渲染等等相关的工作；</p>
</li>
<li><p><strong>JavaScriptCore：</strong>解析、执行JavaScript代码； </p>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/4.jpg" loading="lazy"></p>
</li>
</ul>
</li>
<li><p>在小程序中编写的JavaScript代码就是被JSCore执行的；</p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/3.jpg" loading="lazy"></p>
<ul>
<li>另外一个强大的JavaScript引擎就是V8引擎。</li>
</ul>
<h2 id="V8引擎的原理"><a href="#V8引擎的原理" class="headerlink" title="V8引擎的原理"></a>V8引擎的原理</h2><ul>
<li><p>我们来看一下官方对V8引擎的定义： </p>
<ul>
<li><p>V8是用C ++编写的Google开源高性能JavaScript和WebAssembly引擎，它用于Chrome和Node.js等。</p>
</li>
<li><p>它实现ECMAScript和WebAssembly，并在Windows 7或更高版本，macOS 10.12+和使用x64，IA-32， ARM或MIPS处理器的Linux系统上运行。</p>
</li>
<li><p>V8可以独立运行，也可以嵌入到任何C ++应用程序中。</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/5.jpg" loading="lazy"></p>
<h2 id="V8引擎的架构"><a href="#V8引擎的架构" class="headerlink" title="V8引擎的架构"></a>V8引擎的架构</h2><ul>
<li><p>V8引擎本身的源码<strong>非常复杂</strong>，大概有超过<strong>100w行C++代码</strong>，通过了解它的架构，我们可以知道它是如何对JavaScript执行的：</p>
</li>
<li><p>Parse模块会将JavaScript代码转换成AST（抽象语法树）（进行词法分析、语法分析），这是因为解释器并不直接认识JavaScript代码；</p>
<ul>
<li><p>如果函数没有被调用，那么是不会被转换成AST的；</p>
</li>
<li><p>Parse的V8官方文档：<a target="_blank" rel="noopener" href="https://v8.dev/blog/scanner">https://v8.dev/blog/scanner</a></p>
</li>
</ul>
</li>
<li><p>Ignition是一个解释器，会将AST转换成ByteCode（字节码），通过字节码可以让不同系统的CPU都能运行。</p>
<ul>
<li><p>同时会收集TurboFan优化所需要的信息（比如函数参数的类型信息，有了类型才能进行真实的运算）；</p>
</li>
<li><p>如果函数只调用一次，Ignition会执行解释执行ByteCode； </p>
</li>
<li><p>Ignition的V8官方文档：<a target="_blank" rel="noopener" href="https://v8.dev/blog/ignition-interpreter">https://v8.dev/blog/ignition-interpreter</a></p>
</li>
</ul>
</li>
<li><p>TurboFan是一个编译器，可以将字节码编译为CPU可以直接执行的机器码；（使得字节码不再都是通过字节码-&gt;汇编指令-&gt;机器码的方式进行转化，提升了性能）</p>
<ul>
<li><p>如果一个函数被多次调用，那么就会被标记为热点函数，那么就会经过TurboFan转换成优化的机器码，提高代码的执行性能； </p>
</li>
<li><p>但是，机器码实际上也会被还原为ByteCode，这是因为如果后续执行函数的过程中，类型发生了变化（比如sum函数原来执行的是number类型，后来执行变成了string类型），之前优化的机器码并不能正确的处理运算，就会逆向的转换成字节码；</p>
</li>
<li><p>TurboFan的V8官方文档：<a target="_blank" rel="noopener" href="https://v8.dev/blog/turbofan-jit">https://v8.dev/blog/turbofan-jit</a></p>
</li>
</ul>
</li>
</ul>
<h2 id="V8引擎的解析图"><a href="#V8引擎的解析图" class="headerlink" title="V8引擎的解析图"></a>V8引擎的解析图</h2><p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/7.jpg" loading="lazy"></p>
<ul>
<li><p><strong>那么我们的JavaScript源码是如何被解析（Parse过程）的呢？</strong></p>
</li>
<li><p>Blink将源码交给V8引擎，Stream获取到源码并且进行编码转换；</p>
</li>
<li><p>Scanner会进行词法分析（lexical analysis），词法分析会将代码转换成tokens； </p>
</li>
<li><p>接下来tokens会被转换成AST树，经过Parser和PreParser： </p>
<ul>
<li><p>Parser就是直接将tokens转成AST树架构；</p>
</li>
<li><p>PreParser称之为预解析，为什么需要预解析呢？</p>
<ul>
<li><p>这是因为并不是所有的JavaScript代码，在一开始时就会被执行。那么对所有的JavaScript代码进行解析，必然会影响网页的运行效率；</p>
</li>
<li><p>所以V8引擎就实现了Lazy Parsing（延迟解析）的方案，它的作用是将不必要的函数进行预解析，也就是只解析暂时需要的内容，而对函数的全量解析是在函数被调用时才会进行；</p>
</li>
<li><p>比如我们在一个函数outer内部定义了另外一个函数inner，那么inner函数就会进行预解析；</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>生成AST树后，会被Ignition转成字节码（bytecode），之后的过程就是代码的执行过程（后续会详细分析）。</p>
</li>
</ul>
<h2 id="JavaScript-代码的执行过程"><a href="#JavaScript-代码的执行过程" class="headerlink" title="JavaScript 代码的执行过程"></a>JavaScript 代码的执行过程</h2><ul>
<li>假如我们有下面一段代码，它在JavaScript中是如何被执行的呢？</li>
</ul>
<img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/9.jpg" style="zoom:67%;" loading="lazy">

<ul>
<li><p>js引擎会在执行代码之前，会在堆内存中创建一个全局对象：Global Object（GO） </p>
<ul>
<li><p>该对象 所有的作用域（scope）都可以访问； </p>
</li>
<li><p>里面会包含Date、Array、String、Number、setTimeout、setInterval等等；</p>
</li>
<li><p>其中还有一个window属性指向自己；</p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/10.jpg" loading="lazy"></p>
</li>
<li><p>js引擎内部有一个<strong>执行上下文栈（Execution Context Stack，简称ECS）</strong>，它是用于执行<strong>代码的调用栈</strong>。 </p>
</li>
<li><p>那么现在它要执行谁呢？执行的是<strong>全局的代码块</strong>： </p>
<ul>
<li><p>全局的代码块为了执行会构建一个 <strong>Global Execution Context（GEC）</strong>； </p>
</li>
<li><p>GEC会 被放入到ECS中 执行；</p>
</li>
</ul>
</li>
<li><p><strong>GEC被放入到ECS中里面包含两部分内容：</strong></p>
<ul>
<li><p><strong>第一部分：</strong>在代码执行前，在parser转成AST的过程中，会将全局定义的变量、函数等加入到GlobalObject中，但是并不会赋值；若有函数，会为函数在对内存中建立对应的存储空间，其中包含父作用域与函数的执行体（代码块） ，然后给 GlobalObject 的函数变量赋值一个这个函数的地址。</p>
<ul>
<li>这个过程也称之为变量的作用域提升（hoisting） </li>
</ul>
</li>
<li><p><strong>第二部分：</strong>在代码执行中，对变量赋值，或者执行其他的函数；</p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/8.jpg" loading="lazy"></p>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/12.jpg" loading="lazy"></p>
</li>
</ul>
<ul>
<li><p>在执行的过程中<strong>执行到一个函数时</strong>，就会根据<strong>函数体</strong>创建一个<strong>函数执行上下文（Functional Execution Context，简称FEC）</strong>，并且压入到<strong>EC Stack</strong>中。 </p>
</li>
<li><p>FEC中包含三部分内容：</p>
<ul>
<li><p>第一部分：在解析函数成为AST树结构时，会创建一个Activation Object（AO）：</p>
<ul>
<li>AO中包含形参、arguments、函数定义和指向函数对象、定义的变量；</li>
</ul>
</li>
<li><p>第二部分：作用域链：由VO（在函数中就是AO对象）和父级VO（在函数编译时就确定了）组成，<code>查找时会一层层查找</code>； </p>
</li>
<li><p>第三部分：this绑定的值：这个我们后续会详细解析；</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/11.jpg" loading="lazy"></p>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/13.jpg" loading="lazy"></p>
<ul>
<li>当函数执行结束后，FEC会出栈，并将 AO 也销毁。</li>
<li>同时，函数中若再有函数，根据编译原理，其会进行预编译，直到执行了 foo 函数（执行函数前AO对象创建），其才会真正被编译。之后执行 bar 函数时，为其创建 AO 对象。当发现其内部使用 name时，会依据作用域链查找name（此处window全局对象中有 name，测试时尽量使用别的变量）。</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/14.jpg" loading="lazy"></p>
<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token string">"Hello Global"</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 会输出 Hello Global,因为函数的作用域是在定义的时候确定的</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token string">"Hello Bar"</span><span class="token punctuation">;</span>
  <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	</code></pre>

<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/15.jpg" loading="lazy"></p>
<p>​                                                                                          </p>
<h2 id="变量环境和环境记录"><a href="#变量环境和环境记录" class="headerlink" title="变量环境和环境记录"></a>变量环境和环境记录</h2><ul>
<li>其实我们上面的讲解都是基于早期ECMA的版本规范： </li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/16.jpg" loading="lazy"></p>
<ul>
<li>在最新的ECMA的版本规范中，对于一些词汇进行了修改：</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/17.jpg" loading="lazy"></p>
<ul>
<li>通过上面的变化我们可以知道，在最新的ECMA标准中，我们前面的变量对象VO已经有另外一个称呼了变量环境VE。</li>
</ul>
<h2 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h2><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  n <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 200</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//undefined</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 200</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">foo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 100</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 200</span>
  <span class="token function">foo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 100</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// undefined</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> b <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 报错</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 100</span></code></pre>



<h1 id="JS的内存管理和闭包"><a href="#JS的内存管理和闭包" class="headerlink" title="JS的内存管理和闭包"></a>JS的内存管理和闭包</h1><h2 id="认识内存管理"><a href="#认识内存管理" class="headerlink" title="认识内存管理"></a>认识内存管理</h2><ul>
<li><p>不管什么样的编程语言，在<strong>代码的执行过程中都是需要给它分配内存</strong>的，不同的是<strong>某些编程语言</strong>需要我们<strong>自己手动的管理内存</strong>，<strong>某些编程语言</strong>可以<strong>自动帮助我们管理内存</strong>： </p>
</li>
<li><p>不管以什么样的方式来管理内存，<strong>内存的管理都会有如下的生命周期</strong>： </p>
<ul>
<li><p>第一步：分配申请你需要的内存（申请）；</p>
</li>
<li><p>第二步：使用分配的内存（存放一些东西，比如对象等）；</p>
</li>
<li><p>第三步：不需要使用时，对其进行释放；</p>
</li>
</ul>
</li>
<li><p><strong>不同的编程语言对于第一步和第三步会有不同的实现：</strong></p>
<ul>
<li><p>手动管理内存：比如C、C++，包括早期的OC，都是需要手动来管理内存的申请和释放的（malloc和free函数）；</p>
</li>
<li><p>自动管理内存：比如Java、JavaScript、Python、Swift、Dart等，它们有自动帮助我们管理内存；</p>
</li>
</ul>
</li>
<li><p>我们可以知道JavaScript通常情况下是不需要手动来管理的。</p>
</li>
</ul>
<h2 id="JS的内存管理"><a href="#JS的内存管理" class="headerlink" title="JS的内存管理"></a>JS的内存管理</h2><ul>
<li><p>但是内存分配方式是一样的吗？</p>
<ul>
<li><p>JS对于<code>基本数据类型内存的分配</code>会在执行时，直接在栈空间进行分配；</p>
</li>
<li><p>JS对于<code>复杂数据类型内存的分配</code>会在堆内存中开辟一块空间，并且将这块空间的指针返回值变量引用；</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/18.jpg" loading="lazy"></p>
<h2 id="JS的垃圾回收"><a href="#JS的垃圾回收" class="headerlink" title="JS的垃圾回收"></a>JS的垃圾回收</h2><ul>
<li><p>因为<strong>内存的大小是有限</strong>的，所以当<strong>内存不再需要的时候</strong>，我们需要<strong>对其进行释放</strong>，以便腾出<strong>更多的内存空间</strong>。 </p>
</li>
<li><p>在<strong>手动管理内存的语言</strong>中，我们需要通过<strong>一些方式自己来释放不再需要的内存，比如free函数</strong>： </p>
<ul>
<li><p>但是这种管理的方式其实非常的低效，影响我们编写逻辑的代码的效率； </p>
</li>
<li><p>并且这种方式对开发者的要求也很高，并且一不小心就会产生内存泄露； </p>
</li>
</ul>
</li>
<li><p>所以大部分<strong>现代的编程语言都是有自己的垃圾回收机制</strong>： </p>
<ul>
<li><p>垃圾回收的英文是Garbage Collection，简称GC； </p>
</li>
<li><p>对于那些不再使用的对象，我们都称之为是垃圾，它需要被回收，以释放更多的内存空间；</p>
</li>
<li><p>而我们的语言运行环境，比如Java的运行环境JVM，JavaScript的运行环境js引擎都会内存 <strong>垃圾回收器</strong>； </p>
</li>
<li><p>垃圾回收器我们也会简称为GC，所以在很多地方你看到GC其实指的是垃圾回收器；</p>
</li>
</ul>
</li>
<li><p>但是这里又出现了另外一个很关键的问题：<strong>GC怎么知道哪些对象是不再使用的呢？</strong></p>
<ul>
<li>这里就要用到GC的算法了</li>
</ul>
</li>
</ul>
<h2 id="常见的GC算法-引用计数"><a href="#常见的GC算法-引用计数" class="headerlink" title="常见的GC算法 - 引用计数"></a>常见的GC算法 - 引用计数</h2><ul>
<li><p><strong>引用计数：</strong></p>
<ul>
<li><p>当一个对象有一个引用指向它时，那么这个对象的引用就+1，当一个对象的引用为0时，这个对象就可以被销毁掉；</p>
</li>
<li><p>这个算法有一个很大的弊端就是会产生循环引用，导致引用计数一直不会清空，最终造成内存泄漏；</p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/19.jpg" loading="lazy"></p>
</li>
</ul>
<p>##常见的GC算法 - 标记清除</p>
<ul>
<li><strong>标记清除：</strong><ul>
<li>这个算法是设置一个根对象（root object），垃圾回收器会定期从这个根开始，找所有从根开始有引用到的对象，对于哪些没有引用到的对象，就认为是不可用的对象；</li>
<li>这个算法可以很好的解决循环引用的问题；</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/20.jpg" loading="lazy"></p>
<ul>
<li>JS引擎比较广泛的采用的就是标记清除算法，当然类似于V8引擎为了进行更好的优化，它在算法的实现细节上也会结合一些其他的算法。</li>
</ul>
<h2 id="JS中函数是一等公民"><a href="#JS中函数是一等公民" class="headerlink" title="JS中函数是一等公民"></a>JS中函数是一等公民</h2><ul>
<li><p>在JavaScript中，函数是非常重要的，并且是一等公民： </p>
<ul>
<li><p>那么就意味着函数的使用是非常灵活的；</p>
</li>
<li><p>函数可以作为另外一个函数的参数，也可以作为另外一个函数的返回值来使用；</p>
</li>
</ul>
</li>
<li><p>自己编写高阶函数</p>
<ul>
<li>高阶函数：把一个函数如果接收另外一个函数作为参数，或者该函数会返回另外一个函数作为返回值的函数，那么这个函数就称之为高阶函数</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2<span class="token punctuation">,</span> calcFn</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>		<span class="token comment">// calc 为高阶函数</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">calcFn</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> num1 <span class="token operator">-</span> num2<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function">mul</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> num1 <span class="token operator">*</span> num2<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">calc</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> add<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">makeAdder</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>		<span class="token comment">// makeAdder 也为高阶函数</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> count <span class="token operator">+</span> num<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> add5 <span class="token operator">=</span> <span class="token function">makeAdder</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add5</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add5</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> add10 <span class="token operator">=</span> <span class="token function">makeAdder</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> add100 <span class="token operator">=</span> <span class="token function">makeAdder</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li>
<li><p>使用内置的高阶函数</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 1.filter：过滤</span>
<span class="token comment">// [10,5,11,100,55]</span>
<span class="token keyword">var</span> newNums <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index<span class="token punctuation">,</span> arr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> item <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 偶数</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNums<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2.map：映射</span>
<span class="token keyword">var</span> newNums2 <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> item <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNums2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3.forEach：迭代</span>
nums<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 4.find/findIndex</span>
<span class="token comment">// es6-12</span>
<span class="token keyword">var</span> item <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> item <span class="token operator">===</span> <span class="token number">11</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> friends <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"kobe"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">40</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"james"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">35</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"curry"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> findFriend <span class="token operator">=</span> friends<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> item<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">"james"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>findFriend<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> friendIndex <span class="token operator">=</span> friends<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> item<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">"james"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>friendIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 5.reduce：累加</span>
<span class="token keyword">var</span> total <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">prevValue<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> prevValue <span class="token operator">+</span> item<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 第二个参数不传默认为0</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<h2 id="JS中闭包的定义"><a href="#JS中闭包的定义" class="headerlink" title="JS中闭包的定义"></a>JS中闭包的定义</h2><ul>
<li><p>这里先来看一下闭包的定义，分成两个：在计算机科学中和在JavaScript中。</p>
</li>
<li><p>在计算机科学中对闭包的定义（维基百科）：</p>
<ul>
<li><p>闭包（英语：Closure），又称<strong>词法闭包</strong>（Lexical Closure）或<strong>函数闭包</strong>（function closures）；</p>
</li>
<li><p>是在支持 <strong>头等函数</strong> 的编程语言中，实现词法绑定（上层作用域在词法解析的时候便已确定）的一种技术；</p>
</li>
<li><p>闭包在实现上是一个结构体，它存储了一个函数和一个关联的环境（相当于一个符号查找表）；</p>
</li>
<li><p>闭包跟函数最大的区别在于，当捕捉闭包的时候，它的 <strong>自由变量</strong> 会在捕捉时被确定，这样即使脱离了捕捉时的上下文，它也能照常运行；（比如下图中，即便bar函数是在 fn() 时才执行，但也能正常执行）</p>
</li>
</ul>
</li>
<li><p>闭包的概念出现于60年代，最早实现闭包的程序是 Scheme，那么我们就可以理解为什么JavaScript中有闭包：</p>
</li>
<li><p>因为JavaScript中有大量的设计是来源于Scheme的；</p>
</li>
<li><p>我们再来看一下MDN对JavaScript闭包的解释：</p>
<ul>
<li><p>一个函数和对其周围状态（<strong>lexical environment，词法环境</strong>）的引用捆绑在一起（或者说函数被引用包围），这样的组合就是<strong>闭包</strong>（<strong>closure</strong>）；</p>
</li>
<li><p>也就是说，闭包让你可以在一个内层函数中访问到其外层函数的作用域；</p>
</li>
<li><p>在 JavaScript 中，每当创建一个函数，闭包就会在函数创建的同时被创建出来；</p>
</li>
</ul>
<p>下面demo函数与name 也可称作闭包：</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"why"</span>
<span class="token keyword">function</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span></code></pre></li>
<li><p>那么我的理解和总结：</p>
<ul>
<li><p>一个普通的函数function，如果它可以访问外层作用域的自由变量，那么这个函数就是一个闭包；</p>
</li>
<li><p>从广义的角度来说：JavaScript中的函数都是闭包；</p>
</li>
<li><p>从狭义的角度来说：JavaScript中一个函数，如果访问了外层作用于的变量，那么它是一个闭包；</p>
</li>
</ul>
</li>
</ul>
<p><img src="/blogs/f3f94af8/21.jpg" loading="lazy"></p>
<h2 id="闭包的访问过程"><a href="#闭包的访问过程" class="headerlink" title="闭包的访问过程"></a>闭包的访问过程</h2><ul>
<li>如果我们编写了如下的代码，它一定是形成了闭包的（add10 在堆内存中存储的函数对象中的 scope 指向了 makeAdder 的AO对象，这使得只要add10 不被销毁，makeAdder 的AO对象就会一直存在）：</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/22.jpg" loading="lazy"></p>
<ul>
<li><p>那么函数继续执行呢？ </p>
<ul>
<li><p>这个时候makeAdder函数执行完毕，正常情况下我们的AO对象会被释放；</p>
</li>
<li><p>但是因为在0xb00的函数中有作用域引用指向了这个AO对象，所以它不会被释放掉；</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/23.jpg" loading="lazy"></p>
<h2 id="闭包的内存泄漏"><a href="#闭包的内存泄漏" class="headerlink" title="闭包的内存泄漏"></a>闭包的内存泄漏</h2><ul>
<li><p>那么我们为什么经常会说闭包是有内存泄露的呢？ </p>
<ul>
<li><p>在上面的案例中，如果后续我们不再使用add10函数了，那么该函数对象应该要被销毁掉，并且其引用着的父 作用域AO也应该被销毁掉；</p>
</li>
<li><p>但是目前因为在全局作用域下add10变量对0xb00的函数对象有引用，而0xb00的作用域中AO（0x200）有引用，所以最终会造成这些内存都是无法被释放的；</p>
</li>
<li><p>所以我们经常说的闭包会造成内存泄露，其实就是刚才的引用链中的所有对象都是无法释放的；</p>
</li>
</ul>
</li>
<li><p>那么，怎么解决这个问题呢？ </p>
<ul>
<li><p>因为当将add10设置为null时，就不再对函数对象0xb00有引用，那么对应的AO对象0x200也就不可达了；</p>
</li>
<li><p>在GC的下一次检测中，它们就会被销毁掉；</p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/24.jpg" loading="lazy"></p>
</li>
</ul>
<h2 id="内存泄漏测试"><a href="#内存泄漏测试" class="headerlink" title="内存泄漏测试"></a>内存泄漏测试</h2><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/25.jpg" style="zoom: 200%;" loading="lazy">

<ul>
<li>图中我们向 arrFns 中不断的添加数据，使得内存逐渐攀升。之后在 10s 后，我们将数据不断从数组中移除，但浏览器不会一个一个移除，而是会等待一段时间后统一移除，这就使得内存曲线在上升后，保持一段时间再突然下降。</li>
</ul>
<h2 id="AO不使用的问题"><a href="#AO不使用的问题" class="headerlink" title="AO不使用的问题"></a>AO不使用的问题</h2><ul>
<li><p>我们来研究一个问题：AO对象不会被销毁时，是否里面的所有属性都不会被释放？</p>
<ul>
<li><p>下面这段代码中name属于闭包的父作用域里面的变量；</p>
</li>
<li><p>我们知道形成闭包之后count一定不会被销毁掉，那么name是否会被销毁掉呢？ </p>
</li>
<li><p>这里我打上了断点，我们可以在浏览器上看看结果；</p>
</li>
</ul>
</li>
</ul>
<p> <img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/26.jpg" loading="lazy"></p>
<h1 id="JS函数中的-this-指向"><a href="#JS函数中的-this-指向" class="headerlink" title="JS函数中的 this 指向"></a>JS函数中的 this 指向</h1><h2 id="为什么需要this"><a href="#为什么需要this" class="headerlink" title="为什么需要this?"></a>为什么需要this?</h2><ul>
<li><p>在常见的编程语言中，几乎都有this这个关键字（Objective-C中使用的是self），但是JavaScript中的this和常见的面向对象语言中的this不太一样：</p>
<ul>
<li><p>常见面向对象的编程语言中，比如Java、C++、Swift、Dart等等一系列语言中，this通常只会出现在类的方法中。</p>
</li>
<li><p>也就是你需要有一个类，类中的方法（特别是实例方法）中，this代表的是当前调用对象。</p>
</li>
<li><p>但是JavaScript中的this更加灵活，无论是它出现的位置还是它代表的含义。</p>
</li>
</ul>
</li>
<li><p>我们来看一下编写一个obj的对象，有this和没有this的区别</p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/27.jpg" loading="lazy"></p>
<ul>
<li>若后期对象名改变，若使用了this，我们不需要对代码体做任何修改，而若没使用this，我们就需要将代码体中的所有 obj 改为修改后的对象名。可见使用 this 可以更方便我们书写代码。</li>
</ul>
<h2 id="this指向什么呢？"><a href="#this指向什么呢？" class="headerlink" title="this指向什么呢？"></a>this指向什么呢？</h2><ul>
<li><p>我们先说一个最简单的，this在全局作用于下指向什么？</p>
</li>
<li><p>这个问题非常容易回答，在浏览器中测试就是指向window。在node中为空对象-&gt;{}  （因为node中会将文件看做一个模块，加载模块并编译，然后将所有代码放到一个函数中，然后通过 apply({}) 执行这个函数）</p>
</li>
<li><p>但是，开发中很少直接在全局作用于下去使用this，通常都是在<strong>函数中使用</strong>。 </p>
<ul>
<li><p>所有的函数在被调用时，都会创建一个执行上下文：</p>
</li>
<li><p>这个上下文中记录着函数的调用栈、AO对象等；</p>
</li>
<li><p>this也是其中的一条记录；</p>
</li>
</ul>
</li>
<li><p>我们先来看一个让人困惑的问题：</p>
<ul>
<li>定义一个函数，我们采用三种不同的方式对它进行调用，它产生了三种不同的结果</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// this指向什么, 跟函数所处的位置是没有关系的</span>
<span class="token comment">// 跟函数被调用的方式是有关系</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 1.直接调用这个函数</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		

<span class="token comment">// 2.创建一个对象, 对象中的函数指向foo</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">'why'</span><span class="token punctuation">,</span>
  foo<span class="token operator">:</span> foo
<span class="token punctuation">&#125;</span>

obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		

<span class="token comment">// 3.apply调用</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span></code></pre></li>
<li><p>这个的案例可以给我们什么样的启示呢？</p>
<ul>
<li><p>1.函数在调用时，JavaScript会默认给this绑定一个值；</p>
</li>
<li><p>2.this的绑定和定义的位置（编写的位置）没有关系；</p>
</li>
<li><p>3.this的绑定和调用方式以及调用的位置有关系；</p>
</li>
<li><p>4.this是在运行时被绑定的；</p>
</li>
</ul>
</li>
<li><p>那么this到底是怎么样的绑定规则呢？</p>
<ul>
<li><p>绑定一：默认绑定；</p>
</li>
<li><p>绑定二：隐式绑定；</p>
</li>
<li><p>绑定三：显示绑定；</p>
</li>
<li><p>绑定四：new绑定；</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/28.jpg" loading="lazy"></p>
<h2 id="规则一：默认绑定"><a href="#规则一：默认绑定" class="headerlink" title="规则一：默认绑定"></a>规则一：默认绑定</h2><ul>
<li><p>什么情况下使用默认绑定呢？独立函数调用。</p>
<ul>
<li>独立的函数调用我们可以理解成函数没有被绑定到某个对象上进行调用；</li>
</ul>
</li>
<li><p>我们通过几个案例来看一下，常见的默认绑定</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 默认绑定: 独立函数调用</span>
<span class="token comment">// 1.案例一:</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Window</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2.案例二:</span>
<span class="token keyword">function</span> <span class="token function">foo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Window</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Window</span>
  <span class="token function">foo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">foo3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Window</span>
  <span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3.案例三:</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> bar <span class="token operator">=</span> obj<span class="token punctuation">.</span>foo<span class="token punctuation">;</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>

<span class="token comment">// 4.案例四:</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  foo<span class="token operator">:</span> foo<span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> bar <span class="token operator">=</span> obj<span class="token punctuation">.</span>foo<span class="token punctuation">;</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>

<span class="token comment">// 5.案例五:</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> bar<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  eating<span class="token operator">:</span> fn<span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 隐式绑定 &#123;name: 'why', eating: ƒ&#125;</span></code></pre>

<h2 id="规则二：隐式绑定"><a href="#规则二：隐式绑定" class="headerlink" title="规则二：隐式绑定"></a>规则二：隐式绑定</h2><ul>
<li><p>另外一种比较常见的调用方式是通过某个对象进行调用的：</p>
<ul>
<li>也就是它的调用位置中，是通过某个对象发起的函数调用。</li>
</ul>
</li>
<li><p>我们通过几个案例来看一下，常见的默认绑定</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 隐式绑定: object.fn()</span>
<span class="token comment">// object对象会被js引擎绑定到fn函数中的this里面</span>
<span class="token comment">// 1.案例一:</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  foo<span class="token operator">:</span> foo<span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obj对象</span>

<span class="token comment">// 2.案例二:</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">eating</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在吃东西"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">running</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在跑步"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
obj<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// var fn = obj.eating;</span>
<span class="token comment">// fn();  // 默认绑定为Window，这种方式获取不到 this.name</span>

<span class="token comment">// 3.案例三:</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"obj1"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obj2</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"obj2"</span><span class="token punctuation">,</span>
  bar<span class="token operator">:</span> obj1<span class="token punctuation">.</span>foo<span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

obj2<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<h2 id="规则三：显示绑定"><a href="#规则三：显示绑定" class="headerlink" title="规则三：显示绑定"></a>规则三：显示绑定</h2><ul>
<li><p>隐式绑定有一个前提条件：</p>
<ul>
<li><p>必须在调用的对象内部有一个对函数的引用（比如一个属性）；</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"obj"</span><span class="token punctuation">,</span>
  foo<span class="token operator">:</span> foo<span class="token punctuation">,</span> <span class="token comment">// 若不想以这种添加属性的方式通过 obj.foo 使得 foo 中的this执行obj，便可使用 call 或 apply 函数。</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre></li>
<li><p>如果没有这样的引用，在进行调用时，会报找不到该函数的错误；</p>
</li>
<li><p>正是通过这个引用，间接的将this绑定到了这个对象上；</p>
</li>
</ul>
</li>
<li><p>如果我们不希望在 <strong>对象内部</strong> 包含这个函数的引用，同时又希望在这个对象上进行强制调用，该怎么做呢？</p>
<ul>
<li><p>JavaScript所有的函数都可以使用call和apply方法（这个和Prototype有关）。</p>
<ul>
<li><p>它们两个的区别这里不再展开；</p>
</li>
<li><p>其实非常简单，第一个参数是相同的，后面的参数，apply为数组，call为参数列表；</p>
</li>
</ul>
</li>
<li><p>这两个函数的第一个参数都要求是一个对象，这个对象的作用是什么呢？就是给this准备的。</p>
</li>
<li><p>在调用这个函数时，会将this绑定到这个传入的对象上。</p>
</li>
</ul>
</li>
<li><p>因为上面的过程，我们明确的绑定了this指向的对象，所以称之为 <strong>显示绑定</strong>。</p>
</li>
</ul>
<h3 id="call、apply、bind"><a href="#call、apply、bind" class="headerlink" title="call、apply、bind"></a>call、apply、bind</h3><ul>
<li><p><strong>通过call或者apply绑定this对象</strong></p>
<ul>
<li>显示绑定后，this就会明确的指向绑定的对象</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 1.foo直接调用和call/apply调用的不同在于this绑定的不同</span>
<span class="token comment">// foo直接调用指向的是全局对象(window)</span>
<span class="token comment">// foo()</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"obj"</span><span class="token punctuation">,</span>
  <span class="token comment">// foo: foo, // 若不想以这种添加属性的方式通过 obj.foo 使得 foo 中的this执行obj，便可使用 call 或 apply 函数。</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// call/apply是可以指定this的绑定对象</span>
<span class="token comment">// foo.call(obj)</span>
<span class="token comment">// foo.apply(obj)</span>
<span class="token comment">// foo.apply("aaaa")</span>

<span class="token comment">// 2.call和apply有什么区别?   call 从第二个常参数起，都是调用call那个函数的参数，</span>
<span class="token comment">// 而apply 只有两个参数，第二个参数为一个数组，数组中每一项对应调用apply 那个函数的参数。</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2<span class="token punctuation">,</span> num3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num1 <span class="token operator">+</span> num2 <span class="token operator">+</span> num3<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">sum</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">"call"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sum</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">"apply"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3.call和apply在执行函数时,是可以明确的绑定this, 这个绑定规则称之为显示绑定</span></code></pre></li>
<li><p><strong>如果我们希望一个函数总是显示的绑定到一个对象上，便可以使用 bind。</strong></p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// foo.call("aaa")</span>
<span class="token comment">// foo.call("aaa")</span>
<span class="token comment">// foo.call("aaa")</span>
<span class="token comment">// foo.call("aaa")</span>

<span class="token comment">// bind 调用后返回一个新的函数，在堆内存中开辟一个新的空间</span>
<span class="token keyword">var</span> newFoo <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">newFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">newFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">newFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">newFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">newFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">newFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<ul>
<li>可以看到，当我们要将一个函数的 this 始终绑定某一个值，可以使用bind，然后调用其生成的新的函数。这种调用方式明显比 call 来的方便。</li>
</ul>
</li>
</ul>
<h2 id="规则四：new-绑定"><a href="#规则四：new-绑定" class="headerlink" title="规则四：new 绑定"></a>规则四：new 绑定</h2><ul>
<li><p>JavaScript中的函数可以当做一个类的构造函数来使用，也就是使用new关键字。</p>
</li>
<li><p>使用new关键字来调用函数是，会执行如下的操作：</p>
<ol>
<li><p>创建一个全新的对象；</p>
</li>
<li><p>这个新对象会被执行prototype连接；</p>
</li>
<li><p>这个新对象会绑定到函数调用的this上（this的绑定在这个步骤完成）；</p>
</li>
<li><p>如果函数没有返回其他对象，表达式会返回这个新对象；</p>
</li>
</ol>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 我们通过一个new关键字调用一个函数时(构造器), 这个时候this是在调用这个构造器时创建出来的对象</span>
<span class="token comment">// this = 创建出来的对象</span>
<span class="token comment">// 这个绑定过程就是new 绑定</span>

<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> p1<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"kobe"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>name<span class="token punctuation">,</span> p2<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">obj<span class="token punctuation">.</span>foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// foo&#123;&#125;</span></code></pre>



<h2 id="内置函数的绑定思考"><a href="#内置函数的绑定思考" class="headerlink" title="内置函数的绑定思考"></a>内置函数的绑定思考</h2><ul>
<li><p>有些时候，我们会调用一些JavaScript的内置函数，或者一些第三方库中的内置函数。</p>
<ul>
<li><p>这些内置函数会要求我们传入另外一个函数；</p>
</li>
<li><p>我们自己并不会显示的调用这些函数，而且JavaScript内部或者第三方库内部会帮助我们执行；</p>
</li>
<li><p>这些函数中的this又是如何绑定的呢？</p>
</li>
</ul>
</li>
<li><p><strong>setTimeout、数组的forEach、div的点击</strong></p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 1.setTimeout</span>
<span class="token keyword">function</span> <span class="token function">hySetTimeout</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> duration</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">hySetTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2.监听点击</span>
<span class="token keyword">const</span> boxDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".box"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
boxDiv<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 元素对象</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

boxDiv<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 元素对象</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
boxDiv<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 元素对象</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
boxDiv<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 元素对象</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3.数组.forEach/map/filter/find</span>
<span class="token keyword">var</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">,</span> <span class="token string">"nba"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
names<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
names<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;"abc"&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
names<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;"cba"&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/29.jpg" loading="lazy"></p>
<h2 id="规则优先级"><a href="#规则优先级" class="headerlink" title="规则优先级"></a>规则优先级</h2><ul>
<li><p>如果一个函数调用位置应用了多条规则，优先级谁更高呢？</p>
</li>
<li><p><strong>1.默认规则的优先级最低</strong></p>
</li>
<li><p>毫无疑问，默认规则的优先级是最低的，因为存在其他规则时，就会通过其他规则的方式来绑定this</p>
</li>
<li><p><strong>2.显示绑定优先级高于隐式绑定</strong></p>
<ul>
<li>代码测试</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"obj"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// obj.foo()</span>

<span class="token comment">// 1.call/apply的显示绑定高于隐式绑定</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;"abc"&#125;</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;"abc"&#125;</span>

<span class="token comment">// 2.bind的优先级高于隐式绑定</span>
<span class="token keyword">var</span> bar <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">"cba"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;"cba"&#125;</span>

<span class="token comment">// 3.更明显的比较</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"obj"</span><span class="token punctuation">,</span>
  foo<span class="token operator">:</span> <span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;"aaa"&#125;</span>
</code></pre></li>
<li><p><strong>3.new绑定优先级高于隐式绑定</strong></p>
<ul>
<li>代码测试</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"obj"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// foo&#123;&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// new的优先级高于隐式绑定</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">obj<span class="token punctuation">.</span>foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li>
<li><p><strong>4.new绑定优先级高于bind</strong></p>
<ul>
<li><p>new绑定和call、apply是不允许同时使用的，所以不存在谁的优先级更高</p>
</li>
<li><p>new绑定可以和bind一起使用，new绑定优先级更高</p>
</li>
<li><p>代码测试</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 结论: new关键字不能和apply/call一起来使用(因为apply、call会直接执行函数，new同样会执行函数)，因此此处只能比较其与 bind 的优先级</span>

<span class="token comment">// new的优先级高于bind</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> bar <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// foo&#123;&#125; -> 可见 new绑定的优先级高于 bind（new 回去找原函数，并返回一个原函数的对象）</span></code></pre>

<ul>
<li>补充：如果 bind 和 call/apply一起使用，bind的优先级更高</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">"def"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;'abc'&#125; -> 可见 bind的优先级高于call</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">"def"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;'abc'&#125; -> 可见 bind的优先级高于apply</span></code></pre>



<h2 id="this规则之外-–-忽略显示绑定"><a href="#this规则之外-–-忽略显示绑定" class="headerlink" title="this规则之外 – 忽略显示绑定"></a>this规则之外 – 忽略显示绑定</h2><ul>
<li><p>我们讲到的规则已经足以应付平时的开发，但是总有一些语法，超出了我们的规则之外。（神话故事和动漫中也总是有类似这样的人物）</p>
</li>
<li><p>如果在显示绑定中，我们传入一个null或者undefined，那么这个显示绑定会被忽略，使用默认规则：</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;"abc"&#125;</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;&#125;</span>

<span class="token comment">// apply/call/bind: 当传入null/undefined时, 自动将this绑定成全局对象</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// window</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// window</span>

<span class="token keyword">var</span> bar <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// window</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li>
</ul>
<h2 id="this规则之外-间接函数引用"><a href="#this规则之外-间接函数引用" class="headerlink" title="this规则之外 - 间接函数引用"></a>this规则之外 - 间接函数引用</h2><ul>
<li><p>另外一种情况，创建一个函数的 间接引用，这种情况使用默认绑定规则。</p>
<ul>
<li><p>赋值(obj2.foo = obj1.foo)的结果是foo函数；</p>
</li>
<li><p>foo函数被直接调用，那么是默认绑定；</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/30.jpg" loading="lazy"></p>
<h2 id="箭头函数-arrow-function"><a href="#箭头函数-arrow-function" class="headerlink" title="箭头函数 arrow function"></a>箭头函数 arrow function</h2><ul>
<li><p>箭头函数是ES6之后增加的一种编写函数的方法，并且它比函数表达式要更加简洁： </p>
<ul>
<li><p>箭头函数不会绑定this、arguments属性； </p>
</li>
<li><p>箭头函数不能作为构造函数来使用（不能和new一起来使用，会抛出错误）；</p>
</li>
</ul>
</li>
<li><p>箭头函数如何编写呢？</p>
<ul>
<li><p><em>(): 函数的参数</em> </p>
</li>
<li><p><em>{}: 函数的执行体</em></p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/31.jpg" loading="lazy"></p>
</li>
</ul>
<ul>
<li><p>箭头函数的编写优化</p>
<ul>
<li><p>优化一: 如果只有一个参数()可以省略 </p>
</li>
<li><p>优化二: 如果函数执行体中只有一行代码, 那么可以省略大括号</p>
<ul>
<li>并且这行代码的返回值会作为整个函数的返回值</li>
</ul>
</li>
<li><p>优化三: 如果函数执行体只有返回一个对象, 那么需要给这个对象加上()</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 1.编写箭头函数</span>
<span class="token comment">// 1> (): 参数</span>
<span class="token comment">// 2> =>: 箭头</span>
<span class="token comment">// 3> &#123;&#125;: 函数的执行体</span>
<span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2<span class="token punctuation">,</span> num3</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">,</span> num3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> num1 <span class="token operator">+</span> num2 <span class="token operator">+</span> num3<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 高阶函数在使用时, 也可以传入箭头函数</span>
<span class="token keyword">var</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
nums<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index<span class="token punctuation">,</span> arr</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 箭头函数有一些常见的简写:</span>
<span class="token comment">// 简写一: 如果参数只有一个, ()可以省略</span>
nums<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 简写二: 如果函数执行体只有一行代码, 那么&#123;&#125;也可以省略</span>
<span class="token comment">// 强调: 并且它会默认将这行代码的执行结果作为返回值</span>
nums<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> newNums <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> item <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNums<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// filter/map/reduce</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> nums
  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> item <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> item <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">preValue<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token operator">=></span> preValue <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 简写三: 如果一个箭头函数, 只有一行代码, 并且返回一个对象, 这个时候如何编写简写</span>
<span class="token comment">// var bar = () => &#123;</span>
<span class="token comment">//   return &#123; name: "why", age: 18 &#125;</span>
<span class="token comment">// &#125;</span>

<span class="token comment">// 注意：此处需要加 () ，否则会将 &#123;&#125; 中的内容看做函数执行体</span>
<span class="token keyword">var</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="this规则之外-ES6箭头函数"><a href="#this规则之外-ES6箭头函数" class="headerlink" title="this规则之外 - ES6箭头函数"></a>this规则之外 - ES6箭头函数</h2><ul>
<li>箭头函数不使用this的四种标准规则（也就是不绑定this），而是根据外层作用域来决定this。</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"why"</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span> foo<span class="token operator">:</span> foo <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span></code></pre>



<ul>
<li><p>我们来看一个模拟网络请求的案例：</p>
<ul>
<li><p>这里我使用setTimeout来模拟网络请求，请求到数据后如何可以存放到data中呢？</p>
</li>
<li><p>我们需要拿到obj对象，设置data； </p>
</li>
<li><p>但是直接拿到的this是window，我们需要在外层定义：var _this = this</p>
</li>
<li><p>在setTimeout的回调函数中使用_this就代表了obj对象</p>
</li>
</ul>
</li>
<li><p>在ES6之前是我们最常用的方式，从ES6开始，我们会使用箭头函数：</p>
<ul>
<li><p>为什么在setTimeout的回调函数中可以直接使用this呢？</p>
</li>
<li><p>因为箭头函数并不绑定this对象，那么this引用就会从上层作用于中找到对应的this</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getData</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 发送网络请求, 将结果放到上面data属性中</span>
    <span class="token comment">// 由于 setTimeout 中的 this 是window，所以此处无法直接通过 this.data 获取到 data</span>
    <span class="token comment">// 在箭头函数之前的解决方案</span>
    <span class="token comment">// var _this = this</span>
    <span class="token comment">// setTimeout(function() &#123;</span>
    <span class="token comment">//   var result = ["abc", "cba", "nba"]</span>
    <span class="token comment">//   _this.data = result</span>
    <span class="token comment">// &#125;, 2000);</span>
      
    <span class="token comment">// 箭头函数之后</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">,</span> <span class="token string">"nba"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<ul>
<li>思考：如果getData也是一个箭头函数，那么setTimeout中的回调函数中的this指向谁呢？<ul>
<li>window，因为obj 是一个对象，没有上下文的概念，所以getData 会获取到 GO 中的 this。</li>
</ul>
</li>
</ul>
<h2 id="面试题-1"><a href="#面试题-1" class="headerlink" title="面试题"></a>面试题</h2><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"window"</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"person"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sayName</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> sss <span class="token operator">=</span> person<span class="token punctuation">.</span>sayName<span class="token punctuation">;</span>
  <span class="token function">sss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window: 独立函数调用</span>
  person<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// person: 隐式调用</span>
  <span class="token punctuation">(</span>person<span class="token punctuation">.</span>sayName<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// person: 隐式调用</span>
  <span class="token punctuation">(</span>b <span class="token operator">=</span> person<span class="token punctuation">.</span>sayName<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window: 赋值表达式(独立函数调用)</span>
<span class="token punctuation">&#125;</span>

<span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'window'</span>

<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">'person1'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo1</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo2</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo3</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo4</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">'person2'</span> <span class="token punctuation">&#125;</span>

<span class="token comment">// person1.foo1(); // person1(隐式绑定)</span>
<span class="token comment">// person1.foo1.call(person2); // person2(显示绑定优先级大于隐式绑定)</span>

<span class="token comment">// person1.foo2(); // window(不绑定作用域,上层作用域是全局)</span>
<span class="token comment">// person1.foo2.call(person2); // window</span>

<span class="token comment">// person1.foo3()(); // window(独立函数调用)</span>
<span class="token comment">// person1.foo3.call(person2)(); // window(独立函数调用)</span>
<span class="token comment">// person1.foo3().call(person2); // person2(最终调用返回函数式, 使用的是显示绑定)</span>

<span class="token comment">// person1.foo4()(); // person1(箭头函数不绑定this, 上层作用域this是person1)</span>
<span class="token comment">// person1.foo4.call(person2)(); // person2(上层作用域被显示的绑定了一个person2)</span>
<span class="token comment">// person1.foo4().call(person2); // person1(上层找到person1)</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'window'</span>

<span class="token keyword">function</span> <span class="token function">Person</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">foo1</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">foo2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">foo3</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">foo4</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'person1'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'person2'</span><span class="token punctuation">)</span>

person1<span class="token punctuation">.</span><span class="token function">foo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// person1</span>
person1<span class="token punctuation">.</span><span class="token function">foo1</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span> <span class="token comment">// person2(显示高于隐式绑定)</span>

person1<span class="token punctuation">.</span><span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// person1 (上层作用域中的this是person1)</span>
person1<span class="token punctuation">.</span><span class="token function">foo2</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span> <span class="token comment">// person1 (上层作用域中的this是person1)</span>

person1<span class="token punctuation">.</span><span class="token function">foo3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// window(独立函数调用)</span>
person1<span class="token punctuation">.</span><span class="token function">foo3</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// window</span>
person1<span class="token punctuation">.</span><span class="token function">foo3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span> <span class="token comment">// person2</span>

person1<span class="token punctuation">.</span><span class="token function">foo4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// person1</span>
person1<span class="token punctuation">.</span><span class="token function">foo4</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// person2</span>
person1<span class="token punctuation">.</span><span class="token function">foo4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span> <span class="token comment">// person1</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'window'</span>

<span class="token keyword">function</span> <span class="token function">Person</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    name<span class="token operator">:</span> <span class="token string">'obj'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">foo1</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">foo2</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'person1'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'person2'</span><span class="token punctuation">)</span>

person1<span class="token punctuation">.</span>obj<span class="token punctuation">.</span><span class="token function">foo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// window</span>
person1<span class="token punctuation">.</span>obj<span class="token punctuation">.</span><span class="token function">foo1</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// window</span>
person1<span class="token punctuation">.</span>obj<span class="token punctuation">.</span><span class="token function">foo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span> <span class="token comment">// person2</span>

person1<span class="token punctuation">.</span>obj<span class="token punctuation">.</span><span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// obj</span>
person1<span class="token punctuation">.</span>obj<span class="token punctuation">.</span><span class="token function">foo2</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// person2</span>
person1<span class="token punctuation">.</span>obj<span class="token punctuation">.</span><span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span> <span class="token comment">// obj</span></code></pre>

<h1 id="JS函数式编程"><a href="#JS函数式编程" class="headerlink" title="JS函数式编程"></a>JS函数式编程</h1><h2 id="实现call"><a href="#实现call" class="headerlink" title="实现call"></a>实现call</h2><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 给所有的函数添加一个hycall的方法</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">hycall</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">thisArg<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 在这里可以去执行调用的那个函数(foo)</span>
  <span class="token comment">// 问题: 得可以获取到是哪一个函数执行了hycall</span>
  <span class="token comment">// 1.获取需要被执行的函数</span>
  <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">this</span>

  <span class="token comment">// 2.对thisArg转成对象类型(防止它传入的是非对象类型)</span>
  thisArg <span class="token operator">=</span> <span class="token punctuation">(</span>thisArg <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> thisArg <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">Object</span><span class="token punctuation">(</span>thisArg<span class="token punctuation">)</span><span class="token operator">:</span> window

  <span class="token comment">// 3.调用需要被执行的函数</span>
  thisArg<span class="token punctuation">.</span>fn <span class="token operator">=</span> fn
  <span class="token keyword">var</span> result <span class="token operator">=</span> thisArg<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
  <span class="token keyword">delete</span> thisArg<span class="token punctuation">.</span>fn

  <span class="token comment">// 4.将最终的结果返回出去</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"foo函数被执行"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"sum函数被执行"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
foo<span class="token punctuation">.</span><span class="token function">hycall</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> sum<span class="token punctuation">.</span><span class="token function">hycall</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hycall的调用:"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="实现-apply"><a href="#实现-apply" class="headerlink" title="实现 apply"></a>实现 apply</h2><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">hyapply</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">thisArg<span class="token punctuation">,</span> argArray</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 1.获取到要执行的函数</span>
  <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">this</span>

  <span class="token comment">// 2.处理绑定的thisArg</span>
  thisArg <span class="token operator">=</span> <span class="token punctuation">(</span>thisArg <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> thisArg <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">Object</span><span class="token punctuation">(</span>thisArg<span class="token punctuation">)</span><span class="token operator">:</span> window

  <span class="token comment">// 3.执行函数</span>
  thisArg<span class="token punctuation">.</span>fn <span class="token operator">=</span> fn
  <span class="token keyword">var</span> result

  <span class="token comment">// 为了避免 argArray 没有值，所以需要进行判断：</span>
  
  <span class="token comment">// if (!argArray) &#123; // argArray是没有值(没有传参数)</span>
  <span class="token comment">//   result = thisArg.fn()</span>
  <span class="token comment">// &#125; else &#123; // 有传参数</span>
  <span class="token comment">//   result = thisArg.fn(...argArray)</span>
  <span class="token comment">// &#125;</span>

  <span class="token comment">// argArray = argArray ? argArray: []</span>
  argArray <span class="token operator">=</span> argArray <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  result <span class="token operator">=</span> thisArg<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>argArray<span class="token punctuation">)</span>

  <span class="token keyword">delete</span> thisArg<span class="token punctuation">.</span>fn

  <span class="token comment">// 4.返回结果</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"sum被调用"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> num
<span class="token punctuation">&#125;</span>
<span class="token comment">// 自己实现的调用</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> sum<span class="token punctuation">.</span><span class="token function">hyapply</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token keyword">var</span> result2 <span class="token operator">=</span> foo<span class="token punctuation">.</span><span class="token function">hyapply</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result2<span class="token punctuation">)</span></code></pre>

<h2 id="实现bind"><a href="#实现bind" class="headerlink" title="实现bind"></a>实现bind</h2><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">hybind</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">thisArg<span class="token punctuation">,</span> <span class="token operator">...</span>argArray</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 1.获取到真实需要调用的函数</span>
  <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">this</span>

  <span class="token comment">// 2.绑定this</span>
  thisArg <span class="token operator">=</span> <span class="token punctuation">(</span>thisArg <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> thisArg <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">Object</span><span class="token punctuation">(</span>thisArg<span class="token punctuation">)</span><span class="token operator">:</span> window

  <span class="token keyword">function</span> <span class="token function">proxyFn</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 3.将函数放到thisArg中进行调用</span>
    thisArg<span class="token punctuation">.</span>fn <span class="token operator">=</span> fn
    <span class="token comment">// 特殊: 对两个传入的参数进行合并</span>
    <span class="token keyword">var</span> finalArgs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>argArray<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">]</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> thisArg<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>finalArgs<span class="token punctuation">)</span>
    <span class="token keyword">delete</span> thisArg<span class="token punctuation">.</span>fn

    <span class="token comment">// 4.返回结果</span>
    <span class="token keyword">return</span> result
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">return</span> proxyFn 
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"foo被执行"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token number">20</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2<span class="token punctuation">,</span> num3<span class="token punctuation">,</span> num4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">,</span> num3<span class="token punctuation">,</span> num4<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// 使用自己定义的bind</span>
<span class="token keyword">var</span> bar <span class="token operator">=</span> foo<span class="token punctuation">.</span><span class="token function">hybind</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token keyword">var</span> newSum <span class="token operator">=</span> sum<span class="token punctuation">.</span><span class="token function">hybind</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">newSum</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span></code></pre>

<h2 id="认识-arguments"><a href="#认识-arguments" class="headerlink" title="认识 arguments"></a>认识 arguments</h2><ul>
<li><p><strong>arguments</strong> 是一个 对应于 <strong>传递给函数的参数</strong> 的 <strong>类数组(array-like)对象</strong>。 </p>
</li>
<li><p>array-like意味着它不是一个数组类型，而是一个对象类型：</p>
<ul>
<li><p>但是它却拥有数组的一些特性，比如说length，比如可以通过index索引来访问；</p>
</li>
<li><p>但是它却没有数组的一些方法，比如forEach、map等；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2<span class="token punctuation">,</span> num3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 类数组对象中(长的像是一个数组, 本质上是一个对象): arguments（会放到AO中）</span>
  <span class="token comment">// console.log(arguments)</span>

  <span class="token comment">// 常见的对arguments的操作是三个</span>
  <span class="token comment">// 1.获取参数的长度</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 2.根据索引值获取某一个参数</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 3.callee获取当前arguments所在的函数</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>callee<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// arguments.callee()</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="arguments-转-array"><a href="#arguments-转-array" class="headerlink" title="arguments 转 array"></a>arguments 转 array</h2><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// arguments转成array类型</span>
  <span class="token comment">// 1.自己遍历arguments中所有的元素</span>
  <span class="token keyword">var</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    newArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
  <span class="token comment">// 2.Array.prototype.slice将arguments转成array</span>
  <span class="token comment">// 之所以 slice 后面要跟call ，是因为 slice 中的需要使用到this，并要求 this 是一个可遍历的对象</span>
  <span class="token keyword">var</span> newArr2 <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr2<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> newArr3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr3<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 3.ES6的语法</span>
  <span class="token keyword">var</span> newArr4 <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr4<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> newArr5 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<ul>
<li>补充，Array 中的 slice 实现</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 额外补充的知识点: Array中的slice实现</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">hyslice</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">start<span class="token punctuation">,</span> end</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  start <span class="token operator">=</span> start <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>
  end <span class="token operator">=</span> end <span class="token operator">||</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">var</span> newArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> start<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> end<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    newArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> newArray<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> newArray <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hyslice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"aaaa"</span><span class="token punctuation">,</span> <span class="token string">"bbb"</span><span class="token punctuation">,</span> <span class="token string">"cccc"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"aaa"</span><span class="token punctuation">,</span> <span class="token string">"bbb"</span><span class="token punctuation">,</span> <span class="token string">"ccc"</span><span class="token punctuation">,</span> <span class="token string">"ddd"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
names<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<h2 id="箭头函数中不绑定-arguments"><a href="#箭头函数中不绑定-arguments" class="headerlink" title="箭头函数中不绑定 arguments"></a>箭头函数中不绑定 arguments</h2><ul>
<li>箭头函数是不绑定arguments的，所以我们在箭头函数中使用arguments会去上层作用域查找：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 1.案例一:</span>
<span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在浏览器环境下会报错，因为 window 对象中没有 arguments。而在 node 环境下有值，因为 node 中会使用 call(&#123;&#125;,xxx)调用整个文件。其后面的 xxx 会作为 arguments。</span>

<span class="token comment">// 2.案例二:</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token punctuation">[</span>Arguments<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span> <span class="token string">'0'</span><span class="token operator">:</span> <span class="token number">123</span> <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> bar<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<ul>
<li>在 es5之后，一般会使用 args 来代替arguments 来获取参数。同时其在箭头函数中仍然可以正常使用。</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 30,40,50</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<h2 id="理解JavaScript-纯函数"><a href="#理解JavaScript-纯函数" class="headerlink" title="理解JavaScript 纯函数"></a>理解JavaScript 纯函数</h2><ul>
<li><p><strong>函数式编程</strong>中有一个非常重要的概念叫<strong>纯函数</strong>，JavaScript符合<strong>函数式编程的范式</strong>，所以也<strong>有纯函数的概念</strong>； </p>
<ul>
<li><p>在<strong>react开发中纯函数是被多次提及</strong>的；</p>
</li>
<li><p>比如<strong>react中组件就被要求像是一个纯函数</strong>（为什么是像，因为还有class组件），<strong>redux中有一个reducer的概念</strong>，也是要求必须是一个纯函数；</p>
</li>
<li><p>所以<strong>掌握纯函数对于理解很多框架的设计</strong>是非常有帮助的；</p>
</li>
</ul>
</li>
<li><p><strong>纯函数的维基百科定义：</strong></p>
<ul>
<li><p>在程序设计中，若一个函数符合以下条件，那么这个函数被称为纯函数：</p>
</li>
<li><p>此函数在相同的输入值时，需产生相同的输出，下面的函数就不是纯函数。 </p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"abc"</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> name
<span class="token punctuation">&#125;</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span>
name <span class="token operator">=</span> <span class="token string">"why"</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span></code></pre>

<ul>
<li><p>函数和输出和输入值以外的其他隐藏信息或状态无关，也和由I/O设备产生的外部输出无关。</p>
</li>
<li><p>该函数不能有语义上可观察的函数副作用，诸如“触发事件”，使输出设备输出，或更改输出值以外物件的内容等，下面的函数就因为修改了name，所以不是纯函数：</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"abc"</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    name <span class="token operator">=</span> <span class="token string">"why"</span>
<span class="token punctuation">&#125;</span></code></pre></li>
<li><p><strong>当然上面的定义会过于的晦涩，所以我简单总结一下：</strong></p>
<ul>
<li><p>确定的输入，一定会产生确定的输出； </p>
</li>
<li><p>函数在执行过程中，不能产生副作用；</p>
</li>
</ul>
</li>
</ul>
<h2 id="副作用的理解"><a href="#副作用的理解" class="headerlink" title="副作用的理解"></a>副作用的理解</h2><ul>
<li><p><strong>那么这里又有一个概念，叫做副作用</strong>，什么又是<strong>副作用</strong>呢？</p>
<ul>
<li><p><strong>副作用（side effect）</strong>其实本身是医学的一个概念，比如我们经常说吃什么药本来是为了治病，可能会产生一些其他的副作用；</p>
</li>
<li><p>在计算机科学中，也引用了副作用的概念，表示在执行一个函数时，除了返回函数值之外，还对调用函数产生了附加的影响，比如修改了全局变量，修改参数或者改变外部的存储； </p>
</li>
</ul>
</li>
<li><p><strong>纯函数在执行的过程中就是不能产生这样的副作用：</strong></p>
<ul>
<li>副作用往往是产生bug的 “温床”。</li>
</ul>
</li>
</ul>
<h2 id="纯函数案例"><a href="#纯函数案例" class="headerlink" title="纯函数案例"></a>纯函数案例</h2><ul>
<li><p><strong>我们来看一个对数组操作的两个函数：</strong></p>
<ul>
<li><p>slice：slice截取数组时不会对原数组进行任何操作,而是生成一个新的数组；</p>
</li>
<li><p>splice：splice截取数组, 会返回一个新的数组, 也会对原数组进行修改；</p>
</li>
<li><p>slice就是一个纯函数，不会修改传入的参数；而splice会修改参数，所以不是纯函数。</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">,</span> <span class="token string">"nba"</span><span class="token punctuation">,</span> <span class="token string">"dna"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// slice只要给它传入一个start/end, 那么对于同一个数组来说, 它会给我们返回确定的值</span>
<span class="token comment">// slice函数本身它是不会修改原来的数组</span>
<span class="token comment">// slice -> this</span>
<span class="token comment">// slice函数本身就是一个纯函数</span>
<span class="token keyword">var</span> newNames1 <span class="token operator">=</span> names<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNames1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ["abc", "cba", "nba", "dna"]</span>
<span class="token comment">// splice在执行时, 有修改掉调用的数组对象本身, 修改的这个操作就是产生的副作用</span>
<span class="token comment">// splice不是一个纯函数</span>
<span class="token keyword">var</span> newNames2 <span class="token operator">=</span> names<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNames2<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// foo函数是否是一个纯函数? 是</span>
<span class="token comment">// 1.相同的输入一定产生相同的输出</span>
<span class="token comment">// 2.在执行的过程中不会产生任何的副作用</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> num1 <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> num2 <span class="token operator">*</span> num2<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// bar不是一个纯函数, 因为它修改了外界的变量</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"bar其他的代码执行"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 即使没有下行的修改 name 的操作，但是此处进行了输出，从某种程度上而言其也并非纯函数。</span>
  name <span class="token operator">=</span> <span class="token string">"cba"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// baz也不是一个纯函数, 因为我们修改了传入的参数</span>
<span class="token keyword">function</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  info<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token function">baz</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// test是否是一个纯函数? 是一个纯函数</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
    <span class="token operator">...</span>info<span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">test</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">test</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">test</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">test</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// add 不是一个纯函数，因为其依赖了外部的全局变量</span>
<span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> foo <span class="token operator">+</span> num<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
foo <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="纯函数的优势"><a href="#纯函数的优势" class="headerlink" title="纯函数的优势"></a>纯函数的优势</h2><ul>
<li><p><strong>为什么纯函数在函数式编程中非常重要呢？</strong></p>
<ul>
<li><p>因为你可以安心的编写和安心的使用； </p>
</li>
<li><p>你在<strong>写的时候</strong>保证了函数的纯度，只是单纯实现自己的业务逻辑即可，不需要关心传入的内容是如何获得的或者依赖其他的外部变量是否已经发生了修改；</p>
</li>
<li><p>你在<strong>用的时候</strong>，你确定你的输入内容不会被任意篡改，并且自己确定的输入，一定会有确定的输出； </p>
</li>
</ul>
</li>
<li><p>React中就要求我们无论是<strong>函数还是class声明一个组件</strong>，这个组件都必须<strong>像纯函数一样</strong>，<strong>保护它们的props不被修改：</strong></p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/32.jpg" loading="lazy"></p>
<h2 id="JavaScript-柯里化"><a href="#JavaScript-柯里化" class="headerlink" title="JavaScript 柯里化"></a>JavaScript 柯里化</h2><ul>
<li><p><strong>柯里化</strong>也是属于<strong>函数式编程</strong>里面一个非常重要的概念。</p>
</li>
<li><p><strong>我们先来看一下维基百科的解释：</strong></p>
<ul>
<li><p>在计算机科学中，<strong>柯里化</strong>（英语：Currying），又译为<strong>卡瑞化</strong>或<strong>加里化</strong>； </p>
</li>
<li><p>是把接收多个参数的函数，变成接受一个单一参数（最初函数的第一个参数）的函数，并且返回接受余下的参数，而且返回结果的新函数的技术； </p>
</li>
<li><p>柯里化声称 “如果你固定某些参数，你将得到接受余下参数的一个函数”； </p>
</li>
</ul>
</li>
<li><p><strong>维基百科的解释非常的抽象，我们这里做一个总结：</strong></p>
<ul>
<li><p>只传递给函数一部分参数来调用它，让它返回一个函数去处理剩余的参数； </p>
</li>
<li><p>这个过程就称之为柯里化；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 除了 sum1 外，其余的函数由于没有引用指向它，所以会自动释放。</span>
<span class="token keyword">function</span> <span class="token function">sum1</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">y</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">z</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> result1 <span class="token operator">=</span> <span class="token function">sum1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result1<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 简化柯里化的代码</span>
<span class="token keyword">var</span> <span class="token function-variable function">sum2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token parameter">y</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token parameter">z</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 等价于：</span>
<span class="token keyword">var</span> <span class="token function-variable function">sum3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">y</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">z</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum3</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<h2 id="柯里化-让函数的职责单一"><a href="#柯里化-让函数的职责单一" class="headerlink" title="柯里化 - 让函数的职责单一"></a>柯里化 - 让函数的职责单一</h2><ul>
<li><p><strong>那么为什么需要有柯里化呢？</strong></p>
<ul>
<li><p>在函数式编程中，我们其实往往希望一个函数处理的问题尽可能的单一，而不是将一大堆的处理过程交给一个函数来处理； </p>
</li>
<li><p>那么我们是否就可以将每次传入的参数在单一的函数中进行处理，处理完后在下一个函数中再使用处理后的结果； </p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  x <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
  y <span class="token operator">=</span> y <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
  z <span class="token operator">=</span> z <span class="token operator">*</span> z<span class="token punctuation">;</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// 目前每个逻辑只有一行代码，而若将来每个逻辑都有10几行，那么都放到一个函数中，就会变得难以阅读</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 因此我们可以按照 单一职责原则，来将每一个逻辑放入单独的函数中进行处理</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  x <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">y</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    y <span class="token operator">=</span> y <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">z</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      z <span class="token operator">=</span> z <span class="token operator">*</span> z<span class="token punctuation">;</span>

      <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>



<h2 id="柯里化-逻辑的复用"><a href="#柯里化-逻辑的复用" class="headerlink" title="柯里化 - 逻辑的复用"></a>柯里化 - 逻辑的复用</h2><ul>
<li><p>另外一个使用柯里化的场景是可以帮助我们可以<strong>复用参数逻辑</strong>： </p>
<ul>
<li><p>makeAdder函数要求我们传入一个count，通过柯里化，我们可以获取到第一次传入返回的函数； </p>
</li>
<li><p>在之后使用返回的函数时，我们不需要再继续传入count了；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> m <span class="token operator">+</span> n<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 假如在程序中,我们经常需要把5和另外一个数字进行相加</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">555</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用柯里化后，我们便可以将获取返回的函数，之后调用这个函数只需要传递一个参数即可。</span>
<span class="token comment">// 相当于对 count = count * count; 这一部分逻辑进行了复用。</span>
<span class="token keyword">function</span> <span class="token function">makeAdder</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  count <span class="token operator">=</span> count <span class="token operator">*</span> count<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> count <span class="token operator">+</span> num<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// var result = makeAdder(5)(10)</span>
<span class="token comment">// console.log(result)</span>
<span class="token keyword">var</span> adder5 <span class="token operator">=</span> <span class="token function">makeAdder</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">adder5</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">adder5</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">adder5</span><span class="token punctuation">(</span><span class="token number">1100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">adder5</span><span class="token punctuation">(</span><span class="token number">555</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<ul>
<li><p>这里我们在演示一个案例，需求是打印一些日志： </p>
<ul>
<li>日志包括时间、类型、信息； </li>
</ul>
</li>
<li><p>普通函数与柯里化的实现方案如下：</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token parameter">date<span class="token punctuation">,</span> type<span class="token punctuation">,</span> message</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>date<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>date<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">][</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>type<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">]: [</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>message<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"DEBUG"</span><span class="token punctuation">,</span> <span class="token string">"查找到轮播图的bug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"DEBUG"</span><span class="token punctuation">,</span> <span class="token string">"查询菜单的bug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"DEBUG"</span><span class="token punctuation">,</span> <span class="token string">"查询数据的bug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 柯里化的优化</span>
<span class="token keyword">var</span> <span class="token function-variable function">log</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">date</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>date<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>date<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">][</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>type<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">]: [</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>message<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 如果我现在打印的都是当前时间</span>
<span class="token keyword">var</span> nowLog <span class="token operator">=</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">nowLog</span><span class="token punctuation">(</span><span class="token string">"DEBUG"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"查找到轮播图的bug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">nowLog</span><span class="token punctuation">(</span><span class="token string">"FETURE"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"新增了添加用户的功能"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> nowAndDebugLog <span class="token operator">=</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"DEBUG"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">nowAndDebugLog</span><span class="token punctuation">(</span><span class="token string">"查找到轮播图的bug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">nowAndDebugLog</span><span class="token punctuation">(</span><span class="token string">"查找到轮播图的bug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">nowAndDebugLog</span><span class="token punctuation">(</span><span class="token string">"查找到轮播图的bug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">nowAndDebugLog</span><span class="token punctuation">(</span><span class="token string">"查找到轮播图的bug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> nowAndFetureLog <span class="token operator">=</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"FETURE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">nowAndFetureLog</span><span class="token punctuation">(</span><span class="token string">"添加新功能~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="自动柯里化函数"><a href="#自动柯里化函数" class="headerlink" title="自动柯里化函数"></a>自动柯里化函数</h2><ul>
<li>实现自动柯里化函数，将一个普通函数，变化为柯里化函数：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 柯里化函数的实现hyCurrying</span>
<span class="token keyword">function</span> <span class="token function">hyCurrying</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">curried</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 判断当前已经接收的参数的个数, 可以参数本身需要接受的参数是否已经一致了</span>
    <span class="token comment">// 1.当已经传入的参数 大于等于 需要的参数时, 就执行函数</span>
    <span class="token comment">// fn.length 可以获取到函数的参数个数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">>=</span> fn<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token comment">// fn(...args)</span>
      <span class="token comment">// fn.call(this, ...args)</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
      <span class="token comment">// 没有达到个数时, 需要返回一个新的函数, 继续来接收的参数</span>
      <span class="token keyword">function</span> <span class="token function">curried2</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 接收到参数后, 需要递归调用curried来检查函数的个数是否达到</span>
        <span class="token keyword">return</span> <span class="token function">curried</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>args2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">return</span> curried2<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> curried<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">add1</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> curryAdd <span class="token operator">=</span> <span class="token function">hyCurrying</span><span class="token punctuation">(</span>add1<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">curryAdd</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">curryAdd</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">curryAdd</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>


<h2 id="理解组合函数"><a href="#理解组合函数" class="headerlink" title="理解组合函数"></a>理解组合函数</h2><ul>
<li><p><strong>组合（Compose）函数</strong>是在JavaScript开发过程中一种对<strong>函数的使用技巧、模式</strong>： </p>
<ul>
<li><p>比如我们现在需要对某一个数据进行函数的调用，执行两个函数fn1和fn2，这两个函数是依次执行的；</p>
</li>
<li><p>那么如果每次我们都需要进行两个函数的调用，操作上就会显得重复； </p>
</li>
<li><p>那么是否可以将这两个函数组合起来，自动依次调用呢？</p>
</li>
<li><p>这个过程就是对函数的组合，我们称之为 组合函数（Compose Function）；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> num <span class="token operator">*</span> <span class="token number">2</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> num <span class="token operator">**</span> <span class="token number">2</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token function">double</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token comment">// 实现最简单的组合函数</span>
<span class="token keyword">function</span> <span class="token function">composeFn</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">n</span><span class="token punctuation">(</span><span class="token function">m</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> newFn <span class="token operator">=</span> <span class="token function">composeFn</span><span class="token punctuation">(</span>double<span class="token punctuation">,</span> square<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">newFn</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<h2 id="实现组合函数"><a href="#实现组合函数" class="headerlink" title="实现组合函数"></a>实现组合函数</h2><ul>
<li><p>刚才我们实现的compose函数比较简单，我们需要考虑更加复杂的情况：比如传入了更多的函数，在调用</p>
<p>compose函数时，传入了更多的参数：</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">hyCompose</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>fns</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> length <span class="token operator">=</span> fns<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> fns<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string">"function"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">"Expected arguments are functions"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">function</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> length <span class="token operator">?</span> fns<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token operator">:</span> args<span class="token punctuation">;</span> <span class="token comment">// result 会返回一个执行结果(单个数据)或由参数组成的数组(fns为空的情况下)</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">++</span>index <span class="token operator">&lt;</span> length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      result <span class="token operator">=</span> fns<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> compose<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> m <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> n <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> newFn <span class="token operator">=</span> <span class="token function">hyCompose</span><span class="token punctuation">(</span>double<span class="token punctuation">,</span> square<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">newFn</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> newFn2 <span class="token operator">=</span> <span class="token function">hyCompose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">newFn2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [10]</span></code></pre>



<h1 id="JS额外知识补充"><a href="#JS额外知识补充" class="headerlink" title="JS额外知识补充"></a>JS额外知识补充</h1><ul>
<li><strong>with语句</strong> 扩展一个语句的作用域链。</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token string">"use strict"</span><span class="token punctuation">;</span> <span class="token comment">// 严格模式下使用 with 语句会报错</span>

<span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token string">"Hello World"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token string">"obj message"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// with语句: 可以形成自己的作用域</span>
    <span class="token keyword">with</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<ul>
<li>不建议使用with语句，因为它可能是混淆错误和兼容性问题的根源。同时严格模式下使用 with 语句会报错。</li>
</ul>
<h2 id="eval函数"><a href="#eval函数" class="headerlink" title="eval函数"></a>eval函数</h2><ul>
<li>eval是一个特殊的函数，它可以将传入的字符串当做JavaScript代码来运行。</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> jsString <span class="token operator">=</span> <span class="token string">'var message = "Hello World"; console.log(message);'</span>

<span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token string">"Hello World"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>

<span class="token function">eval</span><span class="token punctuation">(</span>jsString<span class="token punctuation">)</span></code></pre>

<ul>
<li><p>在 webpack 中可以设置 devtool:”eval”，转换时会将代码转为字符串的形式，转换时性能会更高。但是这种代码一般是临时代码，最终打包不会存在这样的代码。</p>
</li>
<li><p>不建议在开发中使用eval： </p>
<ul>
<li><p>eval代码的可读性非常的差（代码的可读性是高质量代码的重要原则）；</p>
</li>
<li><p>eval是一个字符串，那么有可能在执行的过程中被刻意篡改，那么可能会造成被攻击的风险；</p>
</li>
<li><p>eval的执行必须经过JS解释器，不能被JS引擎优化；</p>
</li>
</ul>
</li>
</ul>
<h2 id="认识严格模式"><a href="#认识严格模式" class="headerlink" title="认识严格模式"></a>认识严格模式</h2><ul>
<li><p>在ECMAScript5标准中，JavaScript提出了<strong>严格模式的概念（Strict Mode）</strong>： </p>
<ul>
<li><p>严格模式很好理解，是一种具有限制性的JavaScript模式，从而使代码隐式的脱离了 ”懒散（sloppy）模式“； </p>
</li>
<li><p>支持严格模式的浏览器在检测到代码中有严格模式时，会以更加严格的方式对代码进行检测和执行； </p>
</li>
</ul>
</li>
<li><p>严格模式对正常的JavaScript语义进行了一些限制：</p>
<ul>
<li>严格模式通过 抛出错误 来消除一些原有的 静默（silent）错误：.</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token number">123.</span>name <span class="token operator">=</span> <span class="token string">"abc"</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">"name"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>writable<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"why"</span></code></pre>

<ul>
<li><p>严格模式让JS引擎在执行代码时可以进行更多的优化（不需要对一些特殊的语法进行处理）；</p>
</li>
<li><p>严格模式禁用了在ECMAScript未来版本中可能会定义的一些语法；</p>
</li>
</ul>
</li>
</ul>
<h2 id="开启严格模式"><a href="#开启严格模式" class="headerlink" title="开启严格模式"></a>开启严格模式</h2><ul>
<li><p>那么如何开启严格模式呢？严格模式支持粒度化的迁移：</p>
<ul>
<li><p>可以支持在js文件中开启严格模式；</p>
</li>
<li><p>也支持对某一个函数开启严格模式；</p>
</li>
</ul>
</li>
<li><p>严格模式通过在文件或者函数开头使用 use strict 来开启。</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token string">"use strict"</span><span class="token punctuation">;</span>

<span class="token comment">// message = "Hello World" // 严格模式下报错</span>
<span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token string">"Hello World"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 静默错误</span>
<span class="token comment">// true.foo = "abc"</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token string">"use strict"</span><span class="token punctuation">;</span>

  <span class="token boolean">true</span><span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="严格模式限制"><a href="#严格模式限制" class="headerlink" title="严格模式限制"></a>严格模式限制</h2><ul>
<li><strong>1. 无法意外的创建全局变量</strong></li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript">message <span class="token operator">=</span> <span class="token string">"Hello World"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  age <span class="token operator">=</span> <span class="token number">20</span>       <span class="token comment">// 此种定义方式会认为是全局变量</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span></code></pre>

<ul>
<li><strong>2. 严格模式会引起静默错误(silently fail,注:不报错也没有任何效果)的赋值操作抛出异常</strong></li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token boolean">true</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>
<span class="token number">NaN</span> <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span></code></pre>

<ul>
<li><strong>3. 严格模式下不可视图试图删除不可删除的属性</strong></li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  configurable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否可配置（设置后不可使用delete删除）</span>
  writable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否可修改</span>
  value<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 可以读</span>
obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"kobe"</span><span class="token punctuation">;</span> <span class="token comment">// 但是不可写</span>

<span class="token keyword">delete</span> obj<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// 不可以删除</span></code></pre>

<ul>
<li><strong>4.严格模式不允许函数参数有相同的名称</strong></li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span></code></pre>

<ul>
<li><strong>5. 不允许0的八进制语法</strong></li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">0123</span><span class="token punctuation">;</span></code></pre>

<ul>
<li><p><strong>6. 在严格模式下，不允许使用with</strong></p>
</li>
<li><p><strong>7. 在严格模式下，eval不再为上层引用变量</strong></p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> jsString <span class="token operator">=</span>
  <span class="token string">'"use strict"; var message = "Hello World"; console.log(message);'</span><span class="token punctuation">;</span>	<span class="token comment">// 此处我们也可以在eval 字符串中使用严格模式</span>
<span class="token function">eval</span><span class="token punctuation">(</span>jsString<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 严格模式下会报 message 没有定义</span></code></pre>

<ul>
<li><strong>8. 严格模式下，this绑定不会默认转成对象</strong></li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token string">"use strict"</span><span class="token punctuation">;</span>

<span class="token comment">// 在严格模式下, 自执行函数(默认绑定)会指向undefined</span>
<span class="token comment">// 之前编写的代码中, 自执行函数我们是没有使用过this直接去引用window</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  foo<span class="token operator">:</span> foo<span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>

obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> bar <span class="token operator">=</span> obj<span class="token punctuation">.</span>foo<span class="token punctuation">;</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>

<span class="token comment">// setTimeout的this</span>
<span class="token comment">// fn.apply(this = window)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 严格模式下，setTimeout 中的 this依然是 window。</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h1 id="深入JS面向对象"><a href="#深入JS面向对象" class="headerlink" title="深入JS面向对象"></a>深入JS面向对象</h1><ul>
<li><p>对象是JavaScript中一个非常重要的概念，这是因为对象可以<strong>将多个相关联的数据封装</strong>到一起，更好的<strong>描述一个事物</strong>： </p>
<ul>
<li><p>比如我们可以描述一辆车：Car，具有颜色（color）、速度（speed）、品牌（brand）、价格（price），行驶（travel）等等；</p>
</li>
<li><p>比如我们可以描述一个人：Person，具有姓名（name）、年龄（age）、身高（height），吃东西（eat）、跑步（run）等等；</p>
</li>
</ul>
</li>
<li><p>用对象来描述事物，更有利于我们将现实的事物，抽离成代码中某个数据结构： </p>
<ul>
<li><p>所以有一些编程语言就是纯面向对象的编程语言，比Java； </p>
</li>
<li><p>你在实现任何现实抽象时都需要先创建一个类，根据类再去创建对象；</p>
</li>
</ul>
</li>
</ul>
<h2 id="JavaScript-的面向对象"><a href="#JavaScript-的面向对象" class="headerlink" title="JavaScript 的面向对象"></a>JavaScript 的面向对象</h2><ul>
<li><p>JavaScript其实支持多种编程范式的，包括<strong>函数式编程和面向对象编程</strong>： </p>
<ul>
<li><p>JavaScript中的对象被设计成一组属性的无序集合，像是一个哈希表，有key和value组成；</p>
</li>
<li><p>key是一个标识符名称，value可以是任意类型，也可以是其他对象或者函数类型； </p>
</li>
<li><p>如果值是一个函数，那么我们可以称之为是对象的方法； </p>
</li>
</ul>
</li>
<li><p><strong>如何创建一个对象呢？</strong></p>
</li>
<li><p>早期使用创建对象的方式最多的是使用Object类，并且使用new关键字来创建一个对象：</p>
<ul>
<li>这是因为早期很多JavaScript开发者是从Java过来的，它们也更习惯于Java中通过new的方式创建一个对象；</li>
</ul>
</li>
<li><p>后来很多开发者为了方便起见，都是直接通过字面量的形式来创建对象： </p>
<ul>
<li>这种形式看起来更加的简洁，并且对象和属性之间的内聚性也更强，所以这种方式后来就流行了起来；</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 创建一个对象, 对某一个人进行抽象(描述)</span>
<span class="token comment">// 1.创建方式一: 通过new Object()创建</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"why"</span>
obj<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">18</span>
obj<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">1.88</span>
obj<span class="token punctuation">.</span><span class="token function-variable function">running</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在跑步~"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 2.创建方式二: 字面量形式</span>
<span class="token keyword">var</span> info <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"kobe"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">1.98</span><span class="token punctuation">,</span>
  <span class="token function-variable function">eating</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在吃东西~"</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>



<h2 id="对属性操作的控制"><a href="#对属性操作的控制" class="headerlink" title="对属性操作的控制"></a>对属性操作的控制</h2><ul>
<li><p>在前面我们的属性都是直接定义在对象内部，或者直接添加到对象内部的：</p>
<ul>
<li>但是这样来做的时候我们就不能对这个属性进行一些限制：比如这个属性是否是可以通过delete删除的？这个属性是否在for-in遍历的时候被遍历出来呢？</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/33.jpg" loading="lazy"></p>
</li>
<li><p>如果我们想要对一个属性进行比较精准的操作控制，那么我们就可以使用属性描述符。 </p>
<ul>
<li><p>通过属性描述符可以精准的添加或修改对象的属性； </p>
</li>
<li><p>属性描述符需要使用 Object.defineProperty 来对属性进行添加或者修改；</p>
</li>
</ul>
</li>
</ul>
<h2 id="Object-defineProperty"><a href="#Object-defineProperty" class="headerlink" title="Object.defineProperty"></a>Object.defineProperty</h2><ul>
<li><p><strong>Object.defineProperty()</strong> 方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性，并返回此对象。</p>
</li>
<li><p>可接收三个参数：</p>
<ul>
<li><p>obj要定义属性的对象；</p>
</li>
<li><p>prop要定义或修改的属性的名称或 Symbol； </p>
</li>
<li><p>descriptor要定义或修改的属性描述符；</p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/34.jpg" loading="lazy"></p>
</li>
<li><p>返回值：</p>
<ul>
<li>被传递给函数的对象。</li>
</ul>
</li>
</ul>
<h2 id="属性描述符分类"><a href="#属性描述符分类" class="headerlink" title="属性描述符分类"></a>属性描述符分类</h2><ul>
<li><p>属性描述符的类型有两种：</p>
<ul>
<li><p>数据属性（Data Properties）描述符（Descriptor）；</p>
</li>
<li><p>存取属性（Accessor访问器 Properties）描述符（Descriptor）；</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/35.jpg" loading="lazy"></p>
<h2 id="数据属性描述符"><a href="#数据属性描述符" class="headerlink" title="数据属性描述符"></a>数据属性描述符</h2><ul>
<li><p><strong>数据数据描述符有如下四个特性：</strong></p>
</li>
<li><p>[[Configurable]]：表示属性是否可以通过delete删除属性，是否可以修改它的特性，或者是否可以将它修改为存取属性描述符；</p>
<ul>
<li><p>当我们直接在一个对象上定义某个属性时，这个属性的[[Configurable]]为true； </p>
</li>
<li><p>当我们通过属性描述符定义一个属性时，这个属性的[[Configurable]]默认为false； </p>
</li>
</ul>
</li>
<li><p>[[Enumerable]]：表示属性是否可以通过for-in或者Object.keys()返回该属性；</p>
<ul>
<li><p>当我们直接在一个对象上定义某个属性时，这个属性的[[Enumerable]]为true； </p>
</li>
<li><p>当我们通过属性描述符定义一个属性时，这个属性的[[Enumerable]]默认为false； </p>
</li>
</ul>
</li>
<li><p>[[Writable]]：表示是否可以修改属性的值；</p>
<ul>
<li><p>当我们直接在一个对象上定义某个属性时，这个属性的[[Writable]]为true； </p>
</li>
<li><p>当我们通过属性描述符定义一个属性时，这个属性的[[Writable]]默认为false； </p>
</li>
</ul>
</li>
<li><p>[[value]]：属性的value值，读取属性时会返回该值，修改属性时，会对其进行修改；</p>
<ul>
<li>默认情况下这个值是undefined；</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// name和age虽然没有使用属性描述符来定义, 但是它们也是具备对应的特性的</span>
<span class="token comment">// value: 赋值的value</span>
<span class="token comment">// configurable: true</span>
<span class="token comment">// enumerable: true</span>
<span class="token comment">// writable: true</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 数据属性描述符</span>
<span class="token comment">// 用了属性描述符, 那么会有默认的特性</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">"address"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 很多配置</span>
  value<span class="token operator">:</span> <span class="token string">"北京市"</span><span class="token punctuation">,</span> <span class="token comment">// 默认值undefined</span>
  <span class="token comment">// 该特殊不可删除/也不可以重新定义属性描述符</span>
  configurable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 默认值false</span>
  <span class="token comment">// // 该特殊是配置对应的属性(address)是否是可以枚举</span>
  enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 默认值false</span>
  <span class="token comment">// // 该特性是属性是否是可以赋值(写入值)</span>
  writable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 默认值false</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 测试configurable的作用</span>
<span class="token keyword">delete</span> obj<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
<span class="token keyword">delete</span> obj<span class="token punctuation">.</span>address<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 北京市  （当configurable为false，没有被删掉，依然可以正常获取）</span>

<span class="token comment">// 若 configurable 为 false，则再对 address 进行赋值会报错</span>
<span class="token comment">// Object.defineProperty(obj, "address", &#123;</span>
<span class="token comment">//   value: "广州市",</span>
<span class="token comment">//   configurable: true,</span>
<span class="token comment">// &#125;);</span>

<span class="token comment">// 测试enumerable的作用</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// enumerable 为true时，可以输出 address &#123; age: 18, address: '北京市' &#125;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// enumerable 为true时，可以遍历 address</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'age', 'address' ]</span>

<span class="token comment">// 测试Writable的作用</span>
obj<span class="token punctuation">.</span>address <span class="token operator">=</span> <span class="token string">"上海市"</span><span class="token punctuation">;</span> <span class="token comment">// writable 为 false 时，修改不会生效</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 北京市</span></code></pre>

<blockquote>
<p>注意：浏览器会显示 enumerable 为 false 的属性，但是只是为了方便我们调试，并不代表其可以遍历。</p>
</blockquote>
<h2 id="存储属性描述符"><a href="#存储属性描述符" class="headerlink" title="存储属性描述符"></a>存储属性描述符</h2><ul>
<li><p><strong>数据数据描述符有如下四个特性：</strong></p>
</li>
<li><p>[[Configurable]]：表示属性是否可以通过delete删除属性，是否可以修改它的特性，或者是否可以将它修改为存取属性描述符；</p>
<ul>
<li><p>和数据属性描述符是一致的；</p>
</li>
<li><p>当我们直接在一个对象上定义某个属性时，这个属性的[[Configurable]]为true； </p>
</li>
<li><p>当我们通过属性描述符定义一个属性时，这个属性的[[Configurable]]默认为false； </p>
</li>
</ul>
</li>
<li><p>[[Enumerable]]：表示属性是否可以通过for-in或者Object.keys()返回该属性；</p>
<ul>
<li><p>和数据属性描述符是一致的；</p>
</li>
<li><p>当我们直接在一个对象上定义某个属性时，这个属性的[[Enumerable]]为true； </p>
</li>
<li><p>当我们通过属性描述符定义一个属性时，这个属性的[[Enumerable]]默认为false； </p>
</li>
</ul>
</li>
<li><p>[[get]]：获取属性时会执行的函数。默认为undefined</p>
</li>
<li><p>[[set]]：设置属性时会执行的函数。默认为undefined</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  _address<span class="token operator">:</span> <span class="token string">"北京市"</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 存取属性描述符</span>
<span class="token comment">// 1.隐藏某一个私有属性被希望直接被外界使用和赋值</span>
<span class="token comment">// 2.如果我们希望截获某一个属性它访问和设置值的过程时, 也会使用存储属性描述符</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">"address"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_address
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_address <span class="token operator">=</span> value
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>address<span class="token punctuation">)</span>

obj<span class="token punctuation">.</span>address <span class="token operator">=</span> <span class="token string">"上海市"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>address<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"获取了一次address的值"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"设置了addres的值"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span></code></pre>



<h2 id="定义多个属性描述符"><a href="#定义多个属性描述符" class="headerlink" title="定义多个属性描述符"></a>定义多个属性描述符</h2><ul>
<li><strong>Object.defineProperties()</strong> 方法直接在一个对象上定义 <strong>多个</strong> 新的属性或修改现有属性，并且返回该对象。</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 私有属性(js里面是没有严格意义的私有属性)</span>
  _age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">"why"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_age
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_age <span class="token operator">=</span> value
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

obj<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">19</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>age<span class="token punctuation">)</span></code></pre>

<ul>
<li>此处使用 defineProperties 来定义 age，其中的 configurable与 enumerable 都为 true 的情况下，可以将其改写成如下形式：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 私有属性(js里面是没有严格意义的私有属性)</span>
  _age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  <span class="token keyword">set</span> <span class="token function">age</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_age <span class="token operator">=</span> value
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token keyword">get</span> <span class="token function">age</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_age
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>



<h2 id="对象方法的补充"><a href="#对象方法的补充" class="headerlink" title="对象方法的补充"></a>对象方法的补充</h2><ul>
<li><p>获取对象的属性描述符：</p>
<ul>
<li><p>getOwnPropertyDescriptor</p>
</li>
<li><p>getOwnPropertyDescriptors</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 私有属性(js里面是没有严格意义的私有属性)</span>
  _age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  <span class="token function-variable function">_eating</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_age<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_age <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 获取某一个特性属性的属性描述符</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123; value: 'why', writable: true, enumerable: true, configurable: true &#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
&#123;
  get: [Function: get],
  set: [Function: set],
  enumerable: true,
  configurable: true
&#125;
*/</span>

<span class="token comment">// 获取对象的所有属性描述符</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
&#123;
  _age: &#123; value: 18, writable: true, enumerable: true, configurable: true &#125;,
  _eating: &#123;
    value: [Function: _eating],
    writable: true,
    enumerable: true,
    configurable: true
  &#125;,
  name: &#123;
    value: 'why',
    writable: true,
    enumerable: true,
    configurable: true
  &#125;,
  age: &#123;
    get: [Function: get],
    set: [Function: set],
    enumerable: true,
    configurable: true
  &#125;
&#125;
*/</span></code></pre>

<ul>
<li><p>禁止对象扩展新属性：<em>preventExtensions</em></p>
<ul>
<li>给一个对象添加新的属性会失败（在严格模式下会报错）；</li>
</ul>
</li>
<li><p>密封对象，不允许配置和删除属性：<em>seal</em></p>
<ul>
<li><p>实际是调用<em>preventExtensions</em></p>
</li>
<li><p>并且将现有属性的<em>configurable:false</em></p>
</li>
</ul>
</li>
<li><p>冻结对象，不允许修改现有属性： <em>freeze</em> </p>
<ul>
<li><p>实际上是调用<em>seal</em></p>
</li>
<li><p>并且将现有属性的<em>writable: false</em></p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 1.禁止对象继续添加新的属性</span>
Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">1.88</span><span class="token punctuation">;</span> <span class="token comment">// 添加失败</span>
obj<span class="token punctuation">.</span>address <span class="token operator">=</span> <span class="token string">"广州市"</span><span class="token punctuation">;</span> <span class="token comment">// 添加失败</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2.禁止对象配置/删除里面的属性</span>
<span class="token comment">// for (var key in obj) &#123;</span>
<span class="token comment">//   Object.defineProperty(obj, key, &#123;</span>
<span class="token comment">//     configurable: false,</span>
<span class="token comment">//     enumerable: true,</span>
<span class="token comment">//     writable: true,</span>
<span class="token comment">//     value: obj[key]</span>
<span class="token comment">//   &#125;)</span>
<span class="token comment">// &#125;</span>

Object<span class="token punctuation">.</span><span class="token function">seal</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">delete</span> obj<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3.让属性不可以修改(writable: false)</span>
Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"kobe"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "why"</span></code></pre>



<h2 id="创建对象的方案-字面量"><a href="#创建对象的方案-字面量" class="headerlink" title="创建对象的方案-字面量"></a>创建对象的方案-字面量</h2><ul>
<li><p>如果我们现在希望创建一系列的对象：比如Person对象</p>
<ul>
<li><p>包括张三、李四、王五、李雷等等，他们的信息各不相同； </p>
</li>
<li><p>那么采用什么方式来创建比较好呢？</p>
</li>
</ul>
</li>
<li><p>目前我们已经学习了两种方式：</p>
<ul>
<li><p>new Object方式；</p>
</li>
<li><p>字面量创建的方式；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">1.88</span><span class="token punctuation">,</span>
  address<span class="token operator">:</span> <span class="token string">"广州市"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">eating</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在吃东西~"</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">running</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在跑步~"</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"李四"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">1.98</span><span class="token punctuation">,</span>
  address<span class="token operator">:</span> <span class="token string">"北京市"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">eating</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在吃东西~"</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">running</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在跑步~"</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"王五"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">1.78</span><span class="token punctuation">,</span>
  address<span class="token operator">:</span> <span class="token string">"上海市"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">eating</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在吃东西~"</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">running</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在跑步~"</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<ul>
<li>这种方式有一个很大的弊端：创建同样的对象时，需要编写重复的代码；</li>
</ul>
<h2 id="创建对象的方案-工厂模式"><a href="#创建对象的方案-工厂模式" class="headerlink" title="创建对象的方案-工厂模式"></a>创建对象的方案-工厂模式</h2><ul>
<li><p>我们可以想到的一种创建对象的方式：工厂模式</p>
<ul>
<li><p>工厂模式其实是一种常见的设计模式；</p>
</li>
<li><p>通常我们会有一个工厂方法，通过该工厂方法我们可以产生想要的对象；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 工厂模式: 工厂函数</span>
<span class="token keyword">function</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> height<span class="token punctuation">,</span> address</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  p<span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  p<span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  p<span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>
  p<span class="token punctuation">.</span>address <span class="token operator">=</span> address<span class="token punctuation">;</span>

  p<span class="token punctuation">.</span><span class="token function-variable function">eating</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在吃东西~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  p<span class="token punctuation">.</span><span class="token function-variable function">running</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在跑步~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> p<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">1.88</span><span class="token punctuation">,</span> <span class="token string">"广州市"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1.98</span><span class="token punctuation">,</span> <span class="token string">"上海市"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">1.78</span><span class="token punctuation">,</span> <span class="token string">"北京市"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 工厂模式的缺点(获取不到对象最真实的类型)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Object&#123;...&#125; 、 Object&#123;...&#125; 、 Object&#123;...&#125;     而我们期望获得的，是类似：Person&#123;...&#125;</span></code></pre>



<h2 id="创建对象的方案-构造函数"><a href="#创建对象的方案-构造函数" class="headerlink" title="创建对象的方案-构造函数"></a>创建对象的方案-构造函数</h2><ul>
<li><p>工厂方法创建对象有一个比较大的问题：我们在打印对象时，对象的类型都是Object类型</p>
<ul>
<li><p>但是从某些角度来说，这些对象应该有一个他们共同的类型；</p>
</li>
<li><p>下面我们来看一下另外一种模式：构造函数的方式；</p>
</li>
</ul>
</li>
<li><p>我们先理解什么是构造函数？</p>
<ul>
<li><p>构造函数也称之为构造器（constructor），通常是我们在创建对象时会调用的函数；</p>
</li>
<li><p>在其他面向的编程语言里面，构造函数是存在于类中的一个方法，称之为构造方法；</p>
</li>
<li><p>但是JavaScript中的构造函数有点不太一样；</p>
</li>
</ul>
</li>
<li><p>JavaScript中的构造函数是怎么样的？</p>
<ul>
<li><p>构造函数也是一个普通的函数，从表现形式来说，和千千万万个普通的函数没有任何区别； </p>
</li>
<li><p>那么如果这么一个普通的函数被使用new操作符来调用了，那么这个函数就称之为是一个构造函数；</p>
</li>
</ul>
</li>
<li><p>那么被new调用有什么特殊的呢？</p>
</li>
<li><p>如果一个函数被使用new操作符调用了，那么它会执行如下操作：</p>
<ol>
<li><p>在内存中创建一个新的对象（空对象）；</p>
</li>
<li><p>这个对象内部的[[prototype]]属性会被赋值为该构造函数的prototype属性；（后面详细讲）；</p>
</li>
<li><p>构造函数内部的this，会指向创建出来的新对象；</p>
</li>
<li><p>执行函数的内部代码（函数体代码）；</p>
</li>
<li><p>如果构造函数没有返回非空对象，则返回创建出来的新对象；</p>
</li>
</ol>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"foo~, 函数体代码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// foo就是一个普通的函数</span>
<span class="token comment">// foo()</span>

<span class="token comment">// 换一种方式来调用foo函数: 通过new关键字去调用一个函数, 那么这个函数就是一个构造函数了</span>
<span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<ul>
<li>下面这个构造函数可以确保我们的对象是有Person的类型的（实际是constructor的属性，这个我们后续再探讨）：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 规范: 构造函数的首字母一般是大写</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> height<span class="token punctuation">,</span> address</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
  <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height
  <span class="token keyword">this</span><span class="token punctuation">.</span>address <span class="token operator">=</span> address

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">eating</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在吃东西~"</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">running</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在跑步"</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">1.88</span><span class="token punctuation">,</span> <span class="token string">"广州市"</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1.98</span><span class="token punctuation">,</span> <span class="token string">"北京市"</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span>		<span class="token comment">// Person&#123;...&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span>
p1<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
p2<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<ul>
<li>但是构造函数就没有缺点了吗？ <ul>
<li>构造函数也是有缺点的，它在于我们需要为每个对象的函数去创建一个函数对象实例；为了解决这个问题，我们便可以使用原型。</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/36.jpg" loading="lazy"></p>
<h2 id="认识对象的原型"><a href="#认识对象的原型" class="headerlink" title="认识对象的原型"></a>认识对象的原型</h2><ul>
<li><p>JavaScript当中每个对象都有一个特殊的内置属性 [[prototype]]，这个特殊的对象可以指向另外一个对象。</p>
</li>
<li><p>那么这个对象有什么用呢？</p>
<ul>
<li><p>当我们通过引用对象的属性key来获取一个value时，它会触发 [[Get]]的操作；</p>
</li>
<li><p>这个操作会首先检查该属性是否有对应的属性，如果有的话就使用它；</p>
</li>
<li><p>如果对象中没有改属性，那么会访问对象[[prototype]]内置属性指向的对象上的属性；</p>
</li>
</ul>
</li>
<li><p>那么如果通过字面量直接创建一个对象，这个对象也会有这样的属性吗？如果有，应该如何获取这个属性呢？</p>
<ul>
<li>答案是有的，只要是对象都会有这样的一个内置属性；</li>
</ul>
</li>
<li><p>获取的方式有两种：</p>
<ul>
<li><p>方式一：通过对象的 <strong>proto</strong> 属性可以获取到（但是这个是早期浏览器自己添加的，存在一定的兼容性问题）；</p>
</li>
<li><p>方式二：通过 Object.getPrototypeOf 方法可以获取到；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 我们每个对象中都有一个 [[prototype]], 这个属性可以称之为对象的原型(隐式原型)</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"why"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">// [[prototype]]</span>
<span class="token keyword">var</span> info <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">// [[prototype]]</span>

<span class="token comment">// 1.解释原型的概念和看一下原型</span>
<span class="token comment">// 早期的ECMA是没有规范如何去查看 [[prototype]]</span>

<span class="token comment">// 浏览器给对象中提供了一个属性, 可以让我们查看一下这个原型对象(浏览器提供，有些浏览器有，有些浏览器没有)</span>
<span class="token comment">// __proto__</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;&#125;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span> __proto__<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// ES5之后提供的Object.getPrototypeOf</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;&#125;</span>

obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 18</span></code></pre>



<h2 id="函数的原型-prototype"><a href="#函数的原型-prototype" class="headerlink" title="函数的原型 prototype"></a>函数的原型 <strong>prototype</strong></h2><ul>
<li><p>这里我们又要引入一个新的概念：所有的函数都有一个prototype的属性：</p>
</li>
<li><p>你可能会问题，是不是因为函数是一个对象，所以它有prototype的属性呢？</p>
<ul>
<li><p>不是的，<code>因为它是一个函数，才有了这个特殊的属性</code>；</p>
</li>
<li><p>而不是因为它是一个对象，所以有这个特殊的属性；</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/37.jpg" loading="lazy"></p>
<ul>
<li><p>我们前面讲过new关键字的步骤如下： </p>
<ol>
<li><p>在内存中创建一个新的对象（空对象）；</p>
</li>
<li><p>这个对象内部的[[prototype]]属性会被赋值为该构造函数的prototype属性；</p>
</li>
</ol>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

<span class="token comment">// 函数也是一个对象</span>
<span class="token comment">// console.log(foo.__proto__) //&#123;&#125; 函数作为对象来说, 它也是有[[prototype]] 隐式原型</span>

<span class="token comment">// 函数它因为是一个函数, 所以它还会多出来一个显示原型属性: prototype</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ECMA标准定义的，没有兼容性问题</span>

<span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> f2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> foo<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true    new 关键字调用的第二步</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f2<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> foo<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre>

<ul>
<li>那么也就意味着我们通过Person构造函数创建出来的所有对象的[[prototype]]属性都指向Person.prototype：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 都是为true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>

<span class="token comment">// p1.name = "why"</span>
<span class="token comment">// p1.__proto__.name = "kobe"</span>
<span class="token comment">// Person.prototype.name = "james"</span>
p2<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"curry"</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// curry</span></code></pre>

<h2 id="constructor-属性"><a href="#constructor-属性" class="headerlink" title="constructor 属性"></a>constructor 属性</h2><ul>
<li>事实上原型对象上面是有一个属性的：constructor<ul>
<li>默认情况下原型上都会添加一个属性叫做constructor，这个constructor指向当前的函数对象；</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/38.jpg" loading="lazy"></p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

<span class="token comment">// 1.constructor属性</span>
<span class="token comment">// foo.prototype这个对象中有一个constructor属性(ECMA标准)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;&#125;  直接打印看不到，因为 constructor 的 enumerable 为false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
&#123;
  constructor: &#123;
    value: [Function: foo],
    writable: true,
    enumerable: false,
    configurable: true
  &#125;
&#125;
*/</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [Function: foo]  可见 constructor属性指向了 foo 函数</span>

<span class="token comment">// 2.我们也可以添加自己的属性，但是很明显这总书写方式较为麻烦</span>
foo<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"why"</span><span class="token punctuation">;</span>
foo<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
foo<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
foo<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eating</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> f1<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3.直接修改整个prototype对象（避免修改属性过多，操作麻烦的情况）</span>
foo<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// constructor: foo,    // 此种情况下添加的 constructor 的enumerable 的值为true。不符合要求</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">1.88</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> f1<span class="token punctuation">.</span>age<span class="token punctuation">,</span> f1<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 真实开发中我们可以通过Object.defineProperty方式添加constructor</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">"constructor"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  value<span class="token operator">:</span> foo<span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="创建对象-–-构造函数和原型组合"><a href="#创建对象-–-构造函数和原型组合" class="headerlink" title="创建对象 – 构造函数和原型组合"></a>创建对象 – 构造函数和原型组合</h2><ul>
<li><p>我们在上一个构造函数的方式创建对象时，有一个弊端：会创建出重复的函数，比如running、eating这些函数</p>
<ul>
<li><p>那么有没有办法让所有的对象去共享这些函数呢? </p>
</li>
<li><p>可以，将这些函数放到Person.prototype的对象上即可；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> height<span class="token punctuation">,</span> address</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 不能把下面这些属性放到原型中，因为通过 Person.prototype.name = name 在第二次创建对象时，会产生覆盖</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>address <span class="token operator">=</span> address<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eating</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在吃东西~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">running</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"在跑步~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">1.88</span><span class="token punctuation">,</span> <span class="token string">"北京市"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"kobe"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1.98</span><span class="token punctuation">,</span> <span class="token string">"洛杉矶市"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

p1<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p2<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="JavaScript-中类和对象"><a href="#JavaScript-中类和对象" class="headerlink" title="JavaScript 中类和对象"></a>JavaScript 中类和对象</h2><ul>
<li><p>当我们编写如下代码的时候，我们会如何来称呼这个Person呢？</p>
<ul>
<li><p>在JS中Person应该被称之为是一个构造函数；</p>
</li>
<li><p>从很多面向对象语言过来的开发者，也习惯称之为类，因为类可以帮助我们创建出来对象p1、p2； </p>
</li>
<li><p>如果从面向对象的编程范式角度来看，Person确实是可以称之为类的；</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/39.jpg" loading="lazy"></p>
<h2 id="面对对象的特性-继承"><a href="#面对对象的特性-继承" class="headerlink" title="面对对象的特性 - 继承"></a>面对对象的特性 - 继承</h2><ul>
<li><p>面向对象有三大特性：封装、继承、多态 </p>
<ul>
<li><p>封装：我们前面将属性和方法封装到一个类中，可以称之为封装的过程；（编写类的过程称之为是一个封装的过程） </p>
</li>
<li><p>继承：继承是面向对象中非常重要的，不仅仅可以减少重复代码的数量，也是多态前提（纯面向对象中）；</p>
</li>
<li><p>多态：不同的对象在执行时表现出不同的形态； </p>
</li>
</ul>
</li>
<li><p><strong>那么这里我们核心讲继承。</strong> </p>
</li>
<li><p>那么继承是做什么呢？ </p>
<ul>
<li>继承可以帮助我们将重复的代码和逻辑抽取到父类中，子类只需要直接继承过来使用即可。</li>
</ul>
</li>
<li><p>那么JavaScript当中如何实现继承呢？</p>
<ul>
<li><p>不着急，我们先来看一下JavaScript原型链的机制； </p>
</li>
<li><p>再利用原型链的机制实现一下继承；</p>
</li>
</ul>
</li>
</ul>
<h2 id="JavaScript-原型链"><a href="#JavaScript-原型链" class="headerlink" title="JavaScript 原型链"></a>JavaScript 原型链</h2><ul>
<li><p>在真正实现继承之前，我们先来理解一个非常重要的概念：原型链。 </p>
<ul>
<li>我们知道，从一个对象上获取属性，如果在当前对象中没有获取到就会去它的原型上面获取：</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/40.jpg" loading="lazy"></p>
</li>
</ul>
<ul>
<li><p>那么什么地方是原型链的尽头呢？比如第三个对象是否也是有原型__proto__属性呢？ </p>
</li>
<li><p>我们会发现它打印的是 [Object: null prototype] {}</p>
<ul>
<li><p>事实上这个原型就是我们最顶层的原型了</p>
</li>
<li><p>从Object直接创建出来的对象的原型都是 [Object: null prototype] {}。 </p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [Object: null prototype] &#123;&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [Object: null prototype] &#123;&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre>

<ul>
<li><p>那么我们可能会问题： [Object: null prototype] {} 原型有什么特殊吗？</p>
<ul>
<li><p>特殊一：该对象有原型属性，但是它的原型属性已经指向的是null，也就是已经是顶层原型了；</p>
</li>
<li><p>特殊二：该对象上有很多默认的属性和方法；</p>
</li>
</ul>
</li>
</ul>
<p><img src="/blogs/f3f94af8/41.jpg" loading="lazy"></p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [Object: null prototype] &#123;&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [Function: Object]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// null</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
&#123;
  constructor: &#123;
    value: [Function: Object],
    writable: true,
    enumerable: false,
    configurable: true
  &#125;,
  __defineGetter__: &#123;
    value: [Function: __defineGetter__],
    writable: true,
    enumerable: false,
    configurable: true
  &#125;,
  __defineSetter__: &#123;
    value: [Function: __defineSetter__],
    writable: true,
    enumerable: false,
    configurable: true
  &#125;,
  hasOwnProperty: &#123;
    value: [Function: hasOwnProperty],
    writable: true,
    enumerable: false,
    configurable: true
  &#125;,
  __lookupGetter__: &#123;
    value: [Function: __lookupGetter__],
    writable: true,
    enumerable: false,
    configurable: true
  &#125;,
  __lookupSetter__: &#123;
    value: [Function: __lookupSetter__],
    writable: true,
    enumerable: false,
    configurable: true
  &#125;,
  isPrototypeOf: &#123;
    value: [Function: isPrototypeOf],
    writable: true,
    enumerable: false,
    configurable: true
  &#125;,
  propertyIsEnumerable: &#123;
    value: [Function: propertyIsEnumerable],
    writable: true,
    enumerable: false,
    configurable: true
  &#125;,
  toString: &#123;
    value: [Function: toString],
    writable: true,
    enumerable: false,
    configurable: true
  &#125;,
  valueOf: &#123;
    value: [Function: valueOf],
    writable: true,
    enumerable: false,
    configurable: true
  &#125;,
  ['__proto__']: &#123;
    get: [Function: get __proto__],
    set: [Function: set __proto__],
    enumerable: false,
    configurable: true
  &#125;,
  toLocaleString: &#123;
    value: [Function: toLocaleString],
    writable: true,
    enumerable: false,
    configurable: true
  &#125;
&#125;
*/</span></code></pre>

<h2 id="通过原型链实现继承"><a href="#通过原型链实现继承" class="headerlink" title="通过原型链实现继承"></a>通过原型链实现继承</h2><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 父类: 公共属性和方法</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"why"</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>friends <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eating</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" eating~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 子类: 特有属性和方法</span>
<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>sno <span class="token operator">=</span> <span class="token number">111</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 注意：需要先改变 Student.prototype 的指向，然后在为其添加属性。若颠倒的话，就相当于是先给 Student.prototype 原先指向的对象赋值，然后在修改其指向。这样调用 stu.studying 会报错</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> p<span class="token punctuation">;</span>

<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">studying</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" studying~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// why</span>
stu<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// why eating~</span></code></pre>

<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/42.jpg" loading="lazy"></p>
<ul>
<li><p>但是目前有一个很大的弊端：某些属性其实是保存在p对象上的；</p>
<ul>
<li><p>第一，我们通过直接打印对象是看不到这个属性的；</p>
</li>
<li><p>第二，这个属性会被多个对象共享，如果这个对象是一个引用类型，那么就会造成问题；</p>
</li>
<li><p>第三，不能给Person传递参数，因为这个对象是一次性创建的（没办法定制化）；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"why"</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>friends <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eating</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" eating~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>sno <span class="token operator">=</span> <span class="token number">111</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> p<span class="token punctuation">;</span>

<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">studying</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" studying~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 原型链实现继承的弊端:</span>
<span class="token comment">// 1.第一个弊端: 打印stu对象, 继承的属性是看不到的</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Person &#123; sno: 111 &#125;</span>

<span class="token comment">// 2.第二个弊端: 创建出来两个stu的对象</span>
<span class="token keyword">var</span> stu1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> stu2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 直接修改对象上的属性, 是给本对象添加了一个新属性(不是修改了原型的 name属性)</span>
stu1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"kobe"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu2<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// why</span>

<span class="token comment">// 获取引用, 修改引用中的值, 会相互影响</span>
stu1<span class="token punctuation">.</span>friends<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"kobe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu1<span class="token punctuation">.</span>friends<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'kobe' ]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu2<span class="token punctuation">.</span>friends<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'kobe' ]</span>

<span class="token comment">// 3.第三个弊端: 在前面实现类的过程中都没有传递参数（因为有些属性是在父类中定义的，无法直接传递参数）</span>
<span class="token keyword">var</span> stu3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"lilei"</span><span class="token punctuation">,</span> <span class="token number">112</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<h2 id="借用构造函数继承"><a href="#借用构造函数继承" class="headerlink" title="借用构造函数继承"></a>借用构造函数继承</h2><ul>
<li><p>为了解决原型链继承中存在的问题，开发人员提供了一种新的技术: constructor stealing(有很多名称: 借用构造函数或者称之为经典继承或者称之为伪造对象)： </p>
<ul>
<li>steal是偷窃、剽窃的意思，但是这里可以翻译成借用；</li>
</ul>
</li>
<li><p>借用继承的做法非常简单：在子类型构造函数的内部调用父类型构造函数. </p>
<ul>
<li><p>因为函数可以在任意的时刻被调用；</p>
</li>
<li><p>因此通过apply()和call()方法也可以在新创建的对象上执行构造函数；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> friends</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
  <span class="token keyword">this</span><span class="token punctuation">.</span>friends <span class="token operator">=</span> friends
<span class="token punctuation">&#125;</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eating</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" eating~"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> friends<span class="token punctuation">,</span> sno</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">Person</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> friends<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>sno <span class="token operator">=</span> <span class="token number">111</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> p

<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">studying</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" studying~"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> stu1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"kobe"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">)</span></code></pre>

<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/43.jpg" loading="lazy"></p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 原型链实现继承已经解决的弊端</span>
<span class="token comment">// 1.第一个弊端: 打印stu对象, 继承的属性是看不到的</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Person &#123; name: 'why', age: 18, friends: [ 'kobe' ], sno: 111 &#125;</span>

<span class="token comment">// 2.第二个弊端: 创建出来两个stu的对象</span>
<span class="token comment">// 3.第三个弊端: 在前面实现类的过程中都没有传递参数</span>
<span class="token keyword">var</span> stu1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"lilei"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> stu2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"kobe"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"james"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">112</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stu1<span class="token punctuation">.</span>friends<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"lucy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu1<span class="token punctuation">.</span>friends<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'lilei', 'lucy' ]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu2<span class="token punctuation">.</span>friends<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'james' ]</span></code></pre>

<blockquote>
<p>强调: 借用构造函数也是有弊端:</p>
<p><em>1.第一个弊端: Person函数至少被调用了两次</em></p>
<p><em>2.第二个弊端: stu的原型对象上会多出一些属性, 但是这些属性是没有存在的必要</em></p>
</blockquote>
<h2 id="组合借用继承的问题"><a href="#组合借用继承的问题" class="headerlink" title="组合借用继承的问题"></a>组合借用继承的问题</h2><ul>
<li><p>组合继承是JavaScript最常用的继承模式之一：</p>
<ul>
<li><p>如果你理解到这里, 点到为止, 那么组合来实现继承只能说问题不大；</p>
</li>
<li><p>但是它依然不是很完美，但是基本已经没有问题了；</p>
</li>
</ul>
</li>
<li><p>组合继承存在什么问题呢? </p>
<ul>
<li><p>组合继承最大的问题就是无论在什么情况下，都会调用两次父类构造函数。</p>
<ul>
<li><p>一次在创建子类原型的时候；</p>
</li>
<li><p>另一次在子类构造函数内部(也就是每次创建子类实例的时候)； </p>
</li>
</ul>
</li>
<li><p>另外，如果你仔细按照我的流程走了上面的每一个步骤，你会发现：所有的子类实例事实上会拥有两份父类的属性</p>
<ul>
<li><p>一份在当前的实例自己里面(也就是person本身的)，另一份在子类对应的原型对象中(也就是person.__proto__里面)； </p>
</li>
<li><p>当然，这两份属性我们无需担心访问出现问题，因为默认一定是访问实例本身这一部分的；</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="原型式构造函数"><a href="#原型式构造函数" class="headerlink" title="原型式构造函数"></a>原型式构造函数</h2><ul>
<li><p>原型式继承的渊源</p>
<ul>
<li><p>这种模式要从道格拉斯·克罗克福德（Douglas Crockford，著名的前端大师，JSON的创立者）在2006年写的一篇文章说起: Prototypal Inheritance in JavaScript(在JS中使用原型式继承) </p>
</li>
<li><p>在这篇文章中，它介绍了一种继承方法，而且这种继承方法不是通过构造函数来实现的. </p>
</li>
<li><p>为了理解这种方式，我们先再次回顾一下JavaScript想实现继承的目的：重复利用另外一个对象的属性和方法.</p>
</li>
</ul>
</li>
<li><p>最终的目的：student对象的原型指向了person对象；</p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/44.jpg" loading="lazy"></p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> info <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 原型式继承函数</span>
<span class="token keyword">function</span> <span class="token function">createObject1</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> newObj <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>newObj<span class="token punctuation">,</span> o<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> newObj<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">createObject2</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  <span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o<span class="token punctuation">;</span>
  <span class="token keyword">var</span> newObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// newObj.__proto__ = o</span>
  <span class="token keyword">return</span> newObj<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// var info = createObject2(obj)</span>
<span class="token keyword">var</span> info <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123; name: 'why', age: 18 &#125;</span></code></pre>

<ul>
<li>原型式继承一般都是对象的继承（上面实例的 info 便是一个对象），而不是函数。</li>
</ul>
<h2 id="寄生式继承函数"><a href="#寄生式继承函数" class="headerlink" title="寄生式继承函数"></a>寄生式继承函数</h2><ul>
<li><p>寄生式(Parasitic)继承</p>
<ul>
<li><p>寄生式(Parasitic)继承是与原型式继承紧密相关的一种思想, 并且同样由道格拉斯·克罗克福德(Douglas Crockford)提出和推广的；</p>
</li>
<li><p>寄生式继承的思路是结合原型类继承和工厂模式的一种方式；</p>
</li>
<li><p>即创建一个封装继承过程的函数, 该函数在内部以某种方式来增强对象，最后再将这个对象返回；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> personObj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">running</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"running"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">createStudent</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> stu <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>personObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  stu<span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  stu<span class="token punctuation">.</span><span class="token function-variable function">studying</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"studying~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> stu<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> stuObj <span class="token operator">=</span> <span class="token function">createStudent</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> stuObj1 <span class="token operator">=</span> <span class="token function">createStudent</span><span class="token punctuation">(</span><span class="token string">"kobe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> stuObj2 <span class="token operator">=</span> <span class="token function">createStudent</span><span class="token punctuation">(</span><span class="token string">"james"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stuObj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123; name: 'why', studying: [Function (anonymous)] &#125;</span>
</code></pre>



<h2 id="寄生组合式继承"><a href="#寄生组合式继承" class="headerlink" title="寄生组合式继承"></a>寄生组合式继承</h2><ul>
<li><p>现在我们来回顾一下之前提出的比较理想的组合继承</p>
<ul>
<li><p>组合继承是比较理想的继承方式, 但是存在两个问题: </p>
</li>
<li><p>问题一: 构造函数会被调用两次: 一次在创建子类型原型对象的时候, 一次在创建子类型实例的时候. </p>
</li>
<li><p>问题二: 父类型中的属性会有两份: 一份在原型对象中, 一份在子类型实例中. </p>
</li>
</ul>
</li>
<li><p>事实上, 我们现在可以利用寄生式继承将这两个问题给解决掉. </p>
<ul>
<li><p>你需要先明确一点: 当我们在子类型的构造函数中调用父类型.call(this, 参数)这个函数的时候, 就会将父类型中的属性和方法复制一份到了子类型中. 所以父类型本身里面的内容, 我们不再需要. </p>
</li>
<li><p>而这个时候, 我们还需要获取到一份父类型的原型对象中的属性和方法. </p>
</li>
<li><p>所以，我们可以通过 原型式构造函数 ，将 子类型的原型对象(SubType.prototype)的 <code>__proto__</code> 指向一个新的类型(Fn)的 <code>prototype</code>，再将这个新的类型的  <code>prototype</code>  指向父类型的原型对象(SuperType.protoType)。</p>
</li>
</ul>
</li>
<li><p><strong>能不能直接让子类型的原型对象 = 父类型的原型对象呢?</strong> </p>
<ul>
<li><p>不要这么做, 因为这么做意味着以后修改了子类型原型对象的某个引用类型的时候, 父类型原生对象的引用类型也会被修改. </p>
</li>
<li><p>我们使用前面的寄生式思想就可以了.</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">createObject</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  <span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o<span class="token punctuation">;</span>
  <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> fn<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">inheritPrototype</span><span class="token punctuation">(</span><span class="token parameter">SubType<span class="token punctuation">,</span> SuperType</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// SubType.prototype = createObject(SuperType.prototype);</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">"constructor"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> SubType<span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> friends</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>friends <span class="token operator">=</span> friends<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">running</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"running~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eating</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"eating~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> friends<span class="token punctuation">,</span> sno<span class="token punctuation">,</span> score</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">Person</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> friends<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>sno <span class="token operator">=</span> sno<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>score <span class="token operator">=</span> score<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">inheritPrototype</span><span class="token punctuation">(</span>Student<span class="token punctuation">,</span> Person<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">studying</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"studying~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"kobe"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Student &#123;...&#125;  -> 前面之所以对象名为 Student，是因为在inheritPrototype 中定义了 constructor，浏览器会根据其来输出对象名。</span>
stu<span class="token punctuation">.</span><span class="token function">studying</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// studying~</span>
stu<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// running~</span>
stu<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// eating~</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Student</span></code></pre>

<h2 id="对象的方法补充"><a href="#对象的方法补充" class="headerlink" title="对象的方法补充"></a>对象的方法补充</h2><ul>
<li><p><strong>hasOwnProperty</strong></p>
<ul>
<li>对象是否有某一个属于自己的属性（不是在原型上的属性）</li>
</ul>
</li>
<li><p><strong>in/for in 操作符</strong></p>
<ul>
<li>判断某个属性是否在某个对象或者对象的原型上</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> info <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  address<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    value<span class="token operator">:</span> <span class="token string">"北京市"</span><span class="token punctuation">,</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// hasOwnProperty方法判断</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">"address"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

<span class="token comment">// in 操作符: 不管在当前对象还是原型中返回的都是true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"address"</span> <span class="token keyword">in</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"name"</span> <span class="token keyword">in</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token comment">// // for in: 不管在当前对象还是原型中都会遍历</span>
<span class="token comment">// for (var key in info) &#123;</span>
<span class="token comment">//   console.log(key)</span>
<span class="token comment">// &#125;</span></code></pre>



<ul>
<li><strong>instanceof</strong><ul>
<li>用于检测构造函数的pototype，是否出现在某个实例对象的原型链上 </li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">createObject</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  <span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">inheritPrototype</span><span class="token punctuation">(</span><span class="token parameter">SubType<span class="token punctuation">,</span> SuperType</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token function">createObject</span><span class="token punctuation">(</span><span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">"constructor"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> SubType
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span>

<span class="token function">inheritPrototype</span><span class="token punctuation">(</span>Student<span class="token punctuation">,</span> Person<span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span>

<span class="token keyword">var</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu <span class="token keyword">instanceof</span> <span class="token class-name">Student</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span> <span class="token comment">// true</span></code></pre>

<ul>
<li><strong>isPrototypeOf</strong><ul>
<li>用于检测某个对象，是否出现在某个实例对象的原型链上</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> info <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>

<span class="token comment">// console.log(info instanceof obj)   // Type Error</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">)</span>	<span class="token comment">// true</span></code></pre>



<h2 id="原型继承关系"><a href="#原型继承关系" class="headerlink" title="原型继承关系"></a>原型继承关系</h2><ul>
<li>我们知道，所有函数的 prototype （函数的原型对象）若没有经过特殊处理，其内部的 <code>__proto__</code> 都会指向 Object 函数的 原型对象。这是因为 函数的原型对象 本质上是一个对象（内部包含一个 constructor 属性，指向函数），而平时我们无论是通过字面量的方式还是通过 new Object 的方式，创造出来的对象的 <code>—__proto__</code> 都是指向Object 函数的原型对象。</li>
</ul>
<ul>
<li>同时需要注意，函数也有 <code>__proto__</code> 属性，函数的这个属性指向的是内置函数 Function 的原型对象。因为所有的函数都可以看做是通过 new Function 创建出来的。包括内置函数 Function 与 Object。所以 <code>Function.__proto__</code> 与 <code>Function.prototype</code> 是相等的。</li>
</ul>
<ul>
<li>然后，Function 的原型对象的 <code>__proto__</code> 仍然指向 Object 的原型对象，因为其本质上还是对象。</li>
</ul>
<ul>
<li>最后需要注意的一点是： <code>Object</code> 的原型对象的 <code>__proto__</code> 是指向 null 的。</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/45.jpg" loading="lazy"></p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 对象里面是有一个__proto__对象: 隐式原型对象</span>

<span class="token comment">// Foo是一个函数, 那么它会有一个显示原型对象: Foo.prototype。同时，所有的函数可以看做由 new Function 进行定义的。</span>
<span class="token comment">// Foo.prototype来自哪里?</span>
<span class="token comment">// 答案: 一旦创建了一个函数, Foo.prototype = &#123; constructor: Foo &#125;</span>

<span class="token comment">// Foo是一个对象, 那么它会有一个隐式原型对象: Foo.__proto__</span>
<span class="token comment">// Foo.__proto__来自哪里?</span>
<span class="token comment">// 答案: new Function()  Foo.__proto__ = Function.prototype</span>
<span class="token comment">// Function.prototype = &#123; constructor: Function &#125;</span>

<span class="token comment">// var Foo = new Function()</span>
<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype <span class="token operator">===</span> Foo<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [Function: Foo]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Foo<span class="token punctuation">.</span><span class="token class-name">__proto__</span><span class="token punctuation">.</span>constructor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [Function: Function]</span>

<span class="token keyword">var</span> foo1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h1 id="ES6-相关知识点"><a href="#ES6-相关知识点" class="headerlink" title="ES6 相关知识点"></a>ES6 相关知识点</h1><h2 id="认识-class-定义类"><a href="#认识-class-定义类" class="headerlink" title="认识 class 定义类"></a>认识 class 定义类</h2><ul>
<li><p>我们会发现，按照前面的构造函数形式创建 <strong>类</strong>，不仅仅和编写普通的函数过于相似，而且代码并不容易理解。</p>
<ul>
<li><p>在ES6（ECMAScript2015）新的标准中使用了class关键字来直接定义类；</p>
</li>
<li><p>但是类本质上依然是前面所讲的构造函数、原型链的语法糖而已；</p>
</li>
<li><p>所以学好了前面的构造函数、原型链更有利于我们理解类的概念和继承关系；</p>
</li>
</ul>
</li>
<li><p>那么，如何使用class来定义一个类呢？</p>
<ul>
<li><p>可以使用两种方式来声明类：类声明和类表达式；</p>
</li>
<li><p>同时会发现它和我们的构造函数的特性其实是一致的；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 类的声明(用的更多)</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

<span class="token comment">// 类的表达式</span>
<span class="token comment">// var Animal = class &#123;</span>
<span class="token comment">// &#125;</span>

<span class="token comment">// 研究一下类的特性</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [Object: null prototype] &#123;&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [class Person]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Person<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// function</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre>



<h2 id="类的构造函数"><a href="#类的构造函数" class="headerlink" title="类的构造函数"></a>类的构造函数</h2><ul>
<li><p>如果我们希望在创建对象的时候给类传递一些参数，这个时候应该如何做呢？</p>
<ul>
<li><p>每个类都可以有一个自己的构造函数（方法），这个方法的名称是固定的constructor； </p>
</li>
<li><p>当我们通过new操作符，操作一个类的时候会调用这个类的构造函数constructor； </p>
</li>
<li><p>每个类只能有一个构造函数，如果包含多个构造函数，那么会抛出异常；</p>
</li>
</ul>
</li>
<li><p>当我们通过new关键字操作类的时候，会调用这个constructor函数，并且执行如下操作：</p>
<ol>
<li><p>在内存中创建一个新的对象（空对象）；</p>
</li>
<li><p>这个对象内部的[[prototype]]属性会被赋值为该类的prototype属性；</p>
</li>
<li><p>构造函数内部的this，会指向创建出来的新对象；</p>
</li>
<li><p>执行构造函数的内部代码（函数体代码）；</p>
</li>
<li><p>如果构造函数没有返回非空对象，则返回创建出来的新对象；</p>
</li>
</ol>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 类的声明</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 类的构造方法</span>
  <span class="token comment">// 注意: 一个类只能有一个构造函数</span>
  <span class="token comment">// 1.在内存中创建一个对象 moni = &#123;&#125;</span>
  <span class="token comment">// 2.将类的原型prototype赋值给创建出来的对象 moni.__proto__ = Person.prototype</span>
  <span class="token comment">// 3.将对象赋值给函数的this: new绑定 this = moni</span>
  <span class="token comment">// 4.执行函数体中的代码</span>
  <span class="token comment">// 5.自动返回创建出来的对象</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"kobe"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span></code></pre>

<h2 id="类的实例方法"><a href="#类的实例方法" class="headerlink" title="类的实例方法"></a>类的实例方法</h2><ul>
<li><p>在上面我们定义的属性都是直接放到了this上，也就意味着它是放到了创建出来的新对象中：</p>
<ul>
<li><p>在前面我们说过对于实例的方法，我们是希望放到原型上的，这样可以被多个实例来共享；</p>
</li>
<li><p>这个时候我们可以直接在类中定义；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
    <span class="token keyword">this</span><span class="token punctuation">.</span>_address <span class="token operator">=</span> <span class="token string">"广州市"</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">// 普通的实例方法</span>
  <span class="token comment">// 创建出来的对象进行访问</span>
  <span class="token comment">// var p = new Person()</span>
  <span class="token comment">// p.eating()</span>
  <span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" eating~"</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" running~"</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<h2 id="类的访问器方法"><a href="#类的访问器方法" class="headerlink" title="类的访问器方法"></a>类的访问器方法</h2><ul>
<li>我们之前讲对象的属性描述符时有讲过对象可以添加setter和getter函数的，那么类也是可以的：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 类的访问器方法</span>
  <span class="token keyword">get</span> <span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"拦截访问操作"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_address<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">set</span> <span class="token function">address</span><span class="token punctuation">(</span><span class="token parameter">newAddress</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"拦截设置操作"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_address <span class="token operator">=</span> newAddress<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
p<span class="token punctuation">.</span>address <span class="token operator">=</span> <span class="token string">"北京市"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 北京市</span></code></pre>

<h2 id="类的静态方法"><a href="#类的静态方法" class="headerlink" title="类的静态方法"></a>类的静态方法</h2><ul>
<li>静态方法通常用于定义直接使用类来执行的方法，不需要有类的实例，使用static关键字来定义：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 类的静态方法(类方法)</span>
  <span class="token comment">// Person.createPerson()</span>
  <span class="token keyword">static</span> <span class="token function">randomPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> nameIndex <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> names<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> names<span class="token punctuation">[</span>nameIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> age <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<blockquote>
<p>注意：静态方法实际上是被定义到 Person 类对象（及ES5中的构造函数）中，而实例方法是被定义到了 Person 的原型对象中。 若想要验证，可以使用 <em>Object.getOwnPropertyDescriptors（Person）</em> 与 <em>Object.getOwnPropertyDescriptors（Person.prototype）</em> 进行查看。</p>
</blockquote>
<h2 id="ES6的继承-extends"><a href="#ES6的继承-extends" class="headerlink" title="ES6的继承 - extends"></a>ES6的继承 - extends</h2><ul>
<li>前面我们花了很大的篇幅讨论了在ES5中实现继承的方案，虽然最终实现了相对满意的继承机制，但是过程却依然是非常繁琐的。<ul>
<li>在ES6中新增了使用extends关键字，可以方便的帮助我们实现继承：</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" running~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" eating~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">personMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"处理逻辑1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"处理逻辑2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"处理逻辑3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">static</span> <span class="token function">staticMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"PersonStaticMethod"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// Student称之为子类(派生类)</span>
<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// JS引擎在解析子类的时候就有要求, 如果我们有实现继承</span>
  <span class="token comment">// 那么子类的构造方法中, 在使用this之前或 return 结果之前必须调用父类的 构造方法</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> sno</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sno <span class="token operator">=</span> sno<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">studying</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" studying~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">// 类对父类的方法的重写</span>
  <span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"student "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" running"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">// 重写personMethod方法</span>
  <span class="token function">personMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 复用父类中的处理逻辑</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">personMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"处理逻辑4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"处理逻辑5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"处理逻辑6"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">// 重写静态方法</span>
  <span class="token keyword">static</span> <span class="token function">staticMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// super在不同地方调用含义不同，上面的 personMethod 中的 super 表示父类的实例，此处静态方法中的 super 表示父类这个类</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">staticMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"StudentStaticMethod"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 包含 name, age, sno 属性</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 包含 studying 和 running 以及一些默认参数</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 包含 running 和 eating 以及一些默认参数</span>

stu<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stu<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

stu<span class="token punctuation">.</span><span class="token function">personMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Student<span class="token punctuation">.</span><span class="token function">staticMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 包含 staticMethod</span></code></pre>

<ul>
<li><p>我们会发现在上面的代码中我使用了一个super关键字，这个super关键字有不同的使用方式：</p>
<ul>
<li>注意：在子（派生）类的构造函数中使用this或者返回默认对象之前，必须先通过super调用父类的构造函数！ </li>
</ul>
</li>
<li><p>super的使用位置有三个：子类的构造函数、实例方法、静态方法；在不同位置使用时，表示的含义不同。</p>
</li>
</ul>
<h2 id="继承内置类"><a href="#继承内置类" class="headerlink" title="继承内置类"></a>继承内置类</h2><ul>
<li>我们也可以让我们的类继承自内置类，比如Array：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">HYArray</span> <span class="token keyword">extends</span> <span class="token class-name">Array</span> <span class="token punctuation">&#123;</span>
  <span class="token function">firstItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">lastItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HYArray</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">firstItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">lastItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<ul>
<li>继承内置类后，我们便可在内置类的基础上扩展更多的方法。</li>
</ul>
<h2 id="类的混入-mixin"><a href="#类的混入-mixin" class="headerlink" title="类的混入 mixin"></a>类的混入 mixin</h2><ul>
<li><p>JavaScript的类只支持单继承：也就是只能有一个父类</p>
<ul>
<li><p>那么在开发中我们我们需要在一个类中添加更多相似的功能时，应该如何来做呢？</p>
</li>
<li><p>这个时候我们可以使用混入（mixin）；</p>
</li>
<li><p>实际上就是多层继承。</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">mixinRunner</span><span class="token punctuation">(</span><span class="token parameter">BaseClass</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">class</span> <span class="token class-name">NewClass</span> <span class="token keyword">extends</span> <span class="token class-name">BaseClass</span> <span class="token punctuation">&#123;</span>
    <span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"running~"</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> NewClass
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">mixinEater</span><span class="token punctuation">(</span><span class="token parameter">BaseClass</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> BaseClass <span class="token punctuation">&#123;</span>
    <span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"eating~"</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 在JS中类只能有一个父类: 单继承</span>
<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> NewStudent <span class="token operator">=</span> <span class="token function">mixinEater</span><span class="token punctuation">(</span><span class="token function">mixinRunner</span><span class="token punctuation">(</span>Student<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> ns <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NewStudent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ns<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ns<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<ul>
<li>在 React 的高阶组件中，可用到相似的写法：<ul>
<li>通过 connect(mapStateToProps，mapDispachToProp)(WrappedComponent) 来返回一个 传递了 state 和 dispatch 组件。</li>
<li>实际上便是通过函数包裹类的方式，为类添加了更多的属性或方法。</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/46.jpg" loading="lazy"></p>
<h2 id="JavaScript-的多态"><a href="#JavaScript-的多态" class="headerlink" title="JavaScript 的多态"></a>JavaScript 的多态</h2><ul>
<li><p>面向对象的三大特性：封装、继承、多态。</p>
<ul>
<li>前面两个我们都已经详细解析过了，接下来我们讨论一下JavaScript的多态。</li>
</ul>
</li>
<li><p>JavaScript有多态吗？</p>
<ul>
<li><p>维基百科对多态的定义：<strong>多态</strong>（英语：polymorphism）指为不同数据类型的实体提供统一的接口，或使用一个单一的符号来表示多个不同的类型。</p>
</li>
<li><p>非常的抽象，个人的总结：<code>不同的数据类型进行同一个操作，表现出不同的行为，就是多态的体现</code>。</p>
</li>
</ul>
</li>
<li><p>那么从上面的定义来看，JavaScript是一定存在多态的。</p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/47.jpg" loading="lazy"></p>
<ul>
<li>传统面向对象的多态（TS实现）</li>
</ul>
<pre class="language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// 传统的面向对象多态是有三个前提:</span>
<span class="token comment">// 1> 必须有继承(是多态的前提)</span>
<span class="token comment">// 2> 必须有重写(子类重写父类的方法)</span>
<span class="token comment">// 3> 必须有父类引用指向子类对象    var shape:Shape = new Rectangle()</span>

<span class="token comment">// Shape形状</span>
<span class="token keyword">class</span> <span class="token class-name">Shape</span> <span class="token punctuation">&#123;</span>
  <span class="token function">getArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token keyword">extends</span> <span class="token class-name">Shape</span> <span class="token punctuation">&#123;</span>
  <span class="token function">getArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token keyword">extends</span> <span class="token class-name">Shape</span> <span class="token punctuation">&#123;</span>
  <span class="token function">getArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token number">200</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 多态: 当对不同的数据类型执行同一个操作时, 如果表现出来的行为(形态)不一样, 那么就是多态的体现.</span>
<span class="token keyword">function</span> <span class="token function">calcArea</span><span class="token punctuation">(</span>shape<span class="token operator">:</span> Shape<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>shape<span class="token punctuation">.</span><span class="token function">getArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">calcArea</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">calcArea</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<ul>
<li>JavaScript 多态</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 多态: 当对不同的数据类型执行同一个操作时, 如果表现出来的行为(形态)不一样, 那么就是多态的体现.</span>
<span class="token keyword">function</span> <span class="token function">calcArea</span><span class="token punctuation">(</span><span class="token parameter">foo</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span><span class="token function">getArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getArea</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token number">1000</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
  <span class="token function">getArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token number">100</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">calcArea</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span>
<span class="token function">calcArea</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> m <span class="token operator">+</span> n
<span class="token punctuation">&#125;</span>

<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">)</span></code></pre>



<h2 id="字面量的增强"><a href="#字面量的增强" class="headerlink" title="字面量的增强"></a>字面量的增强</h2><ul>
<li><p>ES6中对 <strong>对象字面量</strong> 进行了增强，称之为 Enhanced object literals（增强对象字面量）。</p>
</li>
<li><p>字面量的增强主要包括下面几部分：</p>
<ul>
<li><p>属性的简写：<strong>Property Shorthand</strong></p>
</li>
<li><p>方法的简写：<strong>Method Shorthand</strong></p>
</li>
<li><p>计算属性名：<strong>Computed Property Names</strong></p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"why"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 1.property shorthand(属性的简写)</span>
  name<span class="token punctuation">,</span>
  age<span class="token punctuation">,</span>

  <span class="token comment">// 2.method shorthand(方法的简写)   这种简写方式可以出现在 对象或类中，不能出现在全局环境中。</span>
  <span class="token comment">// 传统写法</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token comment">// 字面量增强写法</span>
  <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token comment">// 箭头函数写法</span>
  <span class="token function-variable function">baz</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>

  <span class="token comment">// 3.computed property name(计算属性名)</span>
  <span class="token punctuation">[</span>name <span class="token operator">+</span> <span class="token number">123</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">"hehehehe"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span><span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ES6 之前便可以通过此种方式在字面量外为其添加属性</span>
obj<span class="token punctuation">[</span>name <span class="token operator">+</span> <span class="token number">123</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"hahaha"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="解构Destructuring"><a href="#解构Destructuring" class="headerlink" title="解构Destructuring"></a>解构Destructuring</h2><ul>
<li><p>ES6中新增了一个从数组或对象中方便获取数据的方法，称之为解构Destructuring。 </p>
</li>
<li><p>我们可以划分为：数组的解构和对象的解构。</p>
</li>
<li><p>数组的解构：</p>
<ul>
<li><p>基本解构过程</p>
</li>
<li><p>顺序解构</p>
</li>
<li><p>解构出数组</p>
</li>
<li><p>默认值</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">,</span> <span class="token string">"nba"</span><span class="token punctuation">]</span>
<span class="token comment">// 传统写法</span>
<span class="token comment">// var item1 = names[0]</span>
<span class="token comment">// var item2 = names[1]</span>
<span class="token comment">// var item3 = names[2]</span>

<span class="token comment">// 对数组的解构: []</span>
<span class="token keyword">var</span> <span class="token punctuation">[</span>item1<span class="token punctuation">,</span> item2<span class="token punctuation">,</span> item3<span class="token punctuation">]</span> <span class="token operator">=</span> names
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item1<span class="token punctuation">,</span> item2<span class="token punctuation">,</span> item3<span class="token punctuation">)</span>

<span class="token comment">// 解构后面的元素</span>
<span class="token keyword">var</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> itemz<span class="token punctuation">]</span> <span class="token operator">=</span> names
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>itemz<span class="token punctuation">)</span>

<span class="token comment">// 解构出一个元素,后面的元素放到一个新数组中</span>
<span class="token keyword">var</span> <span class="token punctuation">[</span>itemx<span class="token punctuation">,</span> <span class="token operator">...</span>newNames<span class="token punctuation">]</span> <span class="token operator">=</span> names
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>itemx<span class="token punctuation">,</span> newNames<span class="token punctuation">)</span>

<span class="token comment">// 解构的默认值</span>
<span class="token keyword">var</span> <span class="token punctuation">[</span>itema<span class="token punctuation">,</span> itemb<span class="token punctuation">,</span> itemc<span class="token punctuation">,</span> itemd <span class="token operator">=</span> <span class="token string">"aaa"</span><span class="token punctuation">]</span> <span class="token operator">=</span> names
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>itemd<span class="token punctuation">)</span></code></pre>

<ul>
<li><p>对象的解构：</p>
<ul>
<li><p>基本解构过程</p>
</li>
<li><p>任意顺序</p>
</li>
<li><p>重命名</p>
</li>
<li><p>默认值</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">1.88</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 对象的解构: &#123;&#125;</span>
<span class="token keyword">var</span> <span class="token punctuation">&#123;</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> height <span class="token punctuation">&#125;</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span> <span class="token comment">// 对顺序没有要求</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// why 18 1.88</span>

<span class="token keyword">var</span> <span class="token punctuation">&#123;</span> age <span class="token punctuation">&#125;</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 18</span>

<span class="token comment">// 重命名</span>
<span class="token keyword">var</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> newName <span class="token punctuation">&#125;</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// why</span>

<span class="token comment">// 默认值</span>
<span class="token keyword">var</span> <span class="token punctuation">&#123;</span> address<span class="token operator">:</span> newAddress <span class="token operator">=</span> <span class="token string">"广州市"</span> <span class="token punctuation">&#125;</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newAddress<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 广州市</span>

<span class="token comment">// 函数对象形式参数传统获取</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>name<span class="token punctuation">,</span> info<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// why 18</span>

<span class="token comment">// 函数对象形式参数解构后获取</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> name<span class="token punctuation">,</span> age <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">bar</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// why 18</span></code></pre>

<h2 id="解构的应用场景"><a href="#解构的应用场景" class="headerlink" title="解构的应用场景"></a>解构的应用场景</h2><ul>
<li><p>解构目前在开发中使用是非常多的：</p>
<ul>
<li><p>比如在开发中拿到一个变量时，自动对其进行解构使用；</p>
</li>
<li><p>比如对函数的参数进行解构；</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/48.jpg" loading="lazy"></p>
<h2 id="let-const-基本使用"><a href="#let-const-基本使用" class="headerlink" title="let/const 基本使用"></a>let/const 基本使用</h2><ul>
<li><p>在ES5中我们声明变量都是使用的var关键字，从ES6开始新增了两个关键字可以声明变量：let、const</p>
<ul>
<li><p>let、const在其他编程语言中都是有的，所以也并不是新鲜的关键字；</p>
</li>
<li><p>但是let、const确确实实给JavaScript带来一些不一样的东西；</p>
</li>
</ul>
</li>
<li><p>let关键字：</p>
<ul>
<li>从直观的角度来说，let和var是没有太大的区别的，都是用于声明一个变量 </li>
</ul>
</li>
<li><p>const关键字：</p>
<ul>
<li><p>const关键字是constant的单词的缩写，表示常量、衡量的意思； </p>
</li>
<li><p>它表示保存的数据一旦被赋值，就不能被修改； </p>
</li>
<li><p>但是如果赋值的是引用类型，那么可以通过引用找到对应的对象，修改对象的内容； </p>
</li>
</ul>
</li>
<li><p>注意：另外let、const不允许重复声明变量；</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token string">"foo"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token string">"bar"</span><span class="token punctuation">;</span>

<span class="token comment">// const constant(常量/衡量)</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>
<span class="token comment">// name = "cba";   // 报错</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 注意事项一: const本质上是传递的值不可以修改</span>
<span class="token comment">// 但是如果传递的是一个引用类型(内存地址), 可以通过引用找到对应的对象, 去修改对象内部的属性, 这个是可以的</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  foo<span class="token operator">:</span> <span class="token string">"foo"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// obj = &#123;&#125;</span>
obj<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">"aaa"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// aaa</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 注意事项二: 通过let/const定义的变量名是不可以重复定义</span>
<span class="token comment">// var foo = "abc"</span>
<span class="token comment">// var foo = "cba"	// 可以正常定义</span>
<span class="token comment">// console.log(foo);  // cba</span>

<span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>
<span class="token comment">// SyntaxError: Identifier 'foo' has already been declared</span>
<span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token string">"cba"</span><span class="token punctuation">;</span></code></pre>



<h2 id="let-const-作用域提升"><a href="#let-const-作用域提升" class="headerlink" title="let/const 作用域提升"></a>let/const 作用域提升</h2><ul>
<li><p>let、const和var的另一个重要区别是作用域提升： </p>
<ul>
<li><p>我们知道var声明的变量是会进行作用域提升的；</p>
</li>
<li><p>但是如果我们使用let声明的变量，在声明之前访问会报错； </p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/49.jpg" loading="lazy"></p>
<ul>
<li><p>那么是不是意味着foo变量只有在代码执行阶段才会创建的呢？</p>
<ul>
<li><p>事实上并不是这样的，我们可以看一下ECMA262对let和const的描述； </p>
</li>
<li><p><strong>这些变量会被创建在包含他们的词法环境被实例化时，但是是不可以访问它们的，直到词法绑定被求值；</strong></p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/50.jpg" loading="lazy"></p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// console.log(foo)</span>
<span class="token comment">// var foo = "foo"</span>

<span class="token comment">// Reference(引用)Error: Cannot access 'foo' before initialization(初始化)</span>
<span class="token comment">// let/const他们是没有作用域提升</span>
<span class="token comment">// foo被创建出来了, 但是不能被访问</span>
<span class="token comment">// 作用域提升: 能提前被访问</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span>
<span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token string">"foo"</span></code></pre>



<ul>
<li><p>从上面我们可以看出，在执行上下文的词法环境创建出来的时候，变量事实上已经被创建了，只是这个变量是不能被访问的。</p>
<ul>
<li>那么变量已经有了，但是不能被访问，是不是一种作用域的提升呢？</li>
</ul>
</li>
<li><p>事实上维基百科并没有对作用域提升有严格的概念解释，那么我们自己从字面量上理解；</p>
<ul>
<li><p><strong>作用域提升：</strong>在声明变量的作用域中，如果这个变量可以在声明之前被访问，那么我们可以称之为作用域提升； </p>
</li>
<li><p>在这里，它虽然被创建出来了，但是不能被访问，我认为<code>不能称之为作用域提升</code>； </p>
</li>
</ul>
</li>
<li><p>所以我的观点是let、const没有进行作用域提升，但是会在解析阶段被创建出来。</p>
</li>
</ul>
<ul>
<li><p>我们知道，在全局通过var来声明一个变量，事实上会在window上添加一个属性：</p>
<ul>
<li>但是let、const是不会给window上添加任何属性的。</li>
</ul>
</li>
<li><p>那么我们可能会想这个变量是保存在哪里呢？</p>
</li>
<li><p>我们先回顾一下最新的ECMA标准中对执行上下文的描述</p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/51.jpg" loading="lazy"></p>
<ul>
<li><p>也就是说我们声明的变量和环境记录是被添加到变量环境中的：</p>
<ul>
<li><p>但是标准有没有规定这个对象是window对象或者其他对象呢？</p>
</li>
<li><p>其实并没有，JS引擎在解析的时候，其实会有自己的实现；</p>
</li>
<li><p>比如v8中其实是通过VariableMap的一个hashmap来实现它们的存储的。</p>
</li>
<li><p>那么window对象呢？而<code>window对象是早期的GO对象</code>，在最新的实现中其实是浏览器添加的全局对象，并且一直保持了window和var之间值的相等性（而并没有 let 和 const）；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 早期的 VO 在全局执行上下文中，实际上就是 GO 对象，就是 window</span>
<span class="token comment">// window对象是早期的GO对象，在最新的实现中其实是浏览器添加的全局对象，并且一直保持了window和var之间值的相等性。但是两者已经不是同一个对象了。</span>
<span class="token comment">// var foo = "foo"</span>
<span class="token comment">// var message = "Hello World"</span>

<span class="token comment">// console.log(window.foo)</span>
<span class="token comment">// console.log(window.message)</span>

<span class="token comment">// window.message = "哈哈哈"</span>
<span class="token comment">// console.log(message)</span>

<span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token string">"foo"</span><span class="token punctuation">;</span></code></pre>

<h2 id="var-的块级作用域"><a href="#var-的块级作用域" class="headerlink" title="var 的块级作用域"></a>var 的块级作用域</h2><ul>
<li>在我们前面的学习中，JavaScript只会形成两个作用域：全局作用域和函数作用域。 </li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/52.jpg" loading="lazy"></p>
<ul>
<li>ES5中放到一个代码块中定义的变量，外面是可以访问的：</li>
</ul>
<p><img src="/blogs/f3f94af8/53.jpg" loading="lazy"></p>
<h2 id="let-const-的块级作用域"><a href="#let-const-的块级作用域" class="headerlink" title="let/const 的块级作用域"></a>let/const 的块级作用域</h2><ul>
<li><p>在ES6中新增了块级作用域，并且通过let、const、function、class声明的标识符是具备块级作用域的限制的：</p>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/54.jpg" loading="lazy"></p>
</li>
<li><p>但是我们会发现函数拥有块级作用域，但是外面依然是可以访问的：</p>
<ul>
<li>这是因为引擎会对函数的声明进行特殊的处理，允许像var那样进行提升；</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// if语句的代码就是块级作用域</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token string">"foo"</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token string">"bar"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// foo</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bar<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError: bar is not defined</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// switch语句的代码也是块级作用域</span>
<span class="token keyword">var</span> color <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">;</span>

<span class="token keyword">switch</span> <span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">case</span> <span class="token string">"red"</span><span class="token operator">:</span>
    <span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token string">"foo"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token string">"bar"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// foo</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bar<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError: bar is not defined</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// for语句的代码也是块级作用域</span>
<span class="token comment">// for (var i = 0; i &lt; 10; i++) &#123;</span>
<span class="token comment">//   console.log("Hello World" + i);</span>
<span class="token comment">// &#125;</span>

<span class="token comment">// console.log(i); // 10</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError: i is not defined</span></code></pre>

<h2 id="块级作用域的应用"><a href="#块级作用域的应用" class="headerlink" title="块级作用域的应用"></a>块级作用域的应用</h2><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> btns <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"button"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// for (var i = 0; i &lt; btns.length; i++) &#123;</span>
<span class="token comment">//   btns[i].onclick = function () &#123;</span>
<span class="token comment">//     console.log("第" + i + "个按钮被点击"); // 此种写法会导致无论点击哪个按钮最终 i 都是 btns.length -1</span>
<span class="token comment">//   &#125;;</span>
<span class="token comment">// &#125;</span>

<span class="token comment">// 解决方案1：</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> btns<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    btns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"第"</span> <span class="token operator">+</span> n <span class="token operator">+</span> <span class="token string">"个按钮被点击"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>

<span class="token comment">// 解决方案2：</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> btns<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  btns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"第"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">"个按钮被点击"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// i is not defined</span></code></pre>

<h2 id="块级作用域的补充"><a href="#块级作用域的补充" class="headerlink" title="块级作用域的补充"></a>块级作用域的补充</h2><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">,</span> <span class="token string">"nba"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 不可以使用const 来声明i,因为 此处的 for 循环会修改 i 的值（i++）后，再赋值给对应的块级作用域，而 const 是不能修改值的</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> names<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>names<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// &#123;</span>
<span class="token comment">//   let i = 0</span>
<span class="token comment">//   console.log(names[i])</span>
<span class="token comment">// &#125;</span>

<span class="token comment">// &#123;</span>
<span class="token comment">//   let i = 1</span>
<span class="token comment">//   console.log(names[i])</span>
<span class="token comment">// &#125;</span>

<span class="token comment">// &#123;</span>
<span class="token comment">//   let i = 2</span>
<span class="token comment">//   console.log(names[i])</span>
<span class="token comment">// &#125;</span>

<span class="token comment">// for...of: ES6新增的遍历数组(对象)</span>
<span class="token comment">// 此处可以使用 const , 因为此处的 item 是直接赋值给 块级作用域中的(相当于每个块级作用域定义一个 const)。而没有经过修改。</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> names<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// &#123;</span>
<span class="token comment">//   const item = "abc"</span>
<span class="token comment">//   console.log(item)</span>
<span class="token comment">// &#125;</span>

<span class="token comment">// &#123;</span>
<span class="token comment">//   const item = "cba"</span>
<span class="token comment">//   console.log(item)</span>
<span class="token comment">// &#125;</span></code></pre>



<h2 id="暂时性死区"><a href="#暂时性死区" class="headerlink" title="暂时性死区"></a>暂时性死区</h2><ul>
<li><p>在ES6中，我们还有一个概念称之为暂时性死区：</p>
<ul>
<li><p>它表达的意思是在一个代码中，使用let、const声明的变量，在声明之前，变量都是不可以访问的；</p>
</li>
<li><p>我们将这种现象称之为 temporal dead zone（暂时性死区，TDZ）；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token string">"foo"</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError: Cannot access 'foo' before initialization</span>

  <span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError: Cannot access 'foo' before initialization</span>

  <span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="var、let、const的选择"><a href="#var、let、const的选择" class="headerlink" title="var、let、const的选择"></a>var、let、const的选择</h2><ul>
<li><p>在开发中，我们到底应该选择使用哪一种方式来定义我们的变量呢？</p>
</li>
<li><p>对于var的使用：</p>
<ul>
<li><p>我们需要明白一个事实，var所表现出来的特殊性：比如作用域提升、window全局对象、没有块级作用域等都是一些历史遗留问题；</p>
</li>
<li><p>其实是JavaScript在设计之初的一种语言缺陷；</p>
</li>
<li><p>当然目前市场上也在利用这种缺陷出一系列的面试题，来考察大家对JavaScript语言本身以及底层的理解；</p>
</li>
<li><p>但是在实际工作中，我们可以使用最新的规范来编写，也就是不再使用var来定义变量了；</p>
</li>
</ul>
</li>
<li><p>对于let、const： </p>
<ul>
<li><p>对于let和const来说，是目前开发中推荐使用的；</p>
</li>
<li><p>我们会优先推荐使用const，这样可以保证数据的安全性不会被随意的篡改；</p>
</li>
<li><p>只有当我们明确知道一个变量后续会需要被重新赋值时，这个时候再使用let； </p>
</li>
<li><p>这种在很多其他语言里面也都是一种约定俗成的规范，尽量我们也遵守这种规范；</p>
</li>
</ul>
</li>
</ul>
<h2 id="字符串模板基本使用"><a href="#字符串模板基本使用" class="headerlink" title="字符串模板基本使用"></a>字符串模板基本使用</h2><ul>
<li><p>在ES6之前，如果我们想要将字符串和一些动态的变量（标识符）拼接到一起，是非常麻烦和丑陋的（ugly）。 </p>
</li>
<li><p>ES6允许我们使用字符串模板来嵌入JS的变量或者表达式来进行拼接： </p>
<ul>
<li><p>首先，我们会使用 <strong>``</strong> 符号来编写字符串，称之为模板字符串； </p>
</li>
<li><p>其次，在模板字符串中，我们可以通过 <strong>${expression}</strong> 来嵌入动态的内容；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// ES6之前拼接字符串和其他标识符</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">"why"</span>
<span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">18</span>
<span class="token keyword">const</span> height <span class="token operator">=</span> <span class="token number">1.88</span>

<span class="token comment">// console.log("my name is " + name + ", age is " + age + ", height is " + height)</span>

<span class="token comment">// ES6提供模板字符串 ``</span>
<span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">, age is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>age<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">, height is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>height<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>

<span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">age double is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>age <span class="token operator">*</span> <span class="token number">2</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">doubleAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> age <span class="token operator">*</span> <span class="token number">2</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> info2 <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">double age is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token function">doubleAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info2<span class="token punctuation">)</span></code></pre>



<h2 id="标签模板字符串使用"><a href="#标签模板字符串使用" class="headerlink" title="标签模板字符串使用"></a>标签模板字符串使用</h2><ul>
<li><p>模板字符串还有另外一种用法：标签模板字符串（Tagged Template Literals）。</p>
</li>
<li><p>我们一起来看一个普通的JavaScript的函数：</p>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/55.jpg" loading="lazy"></p>
<ul>
<li><p>如果我们使用标签模板字符串，并且在调用的时候插入其他的变量：</p>
<ul>
<li><p>可以看到模板字符串被拆分了；</p>
</li>
<li><p>其中第一个参数是数组，是被模块字符串拆分的字符串组合；</p>
</li>
<li><p>后面的元素是一个个模块字符串传入的内容；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 第一个参数依然是模块字符串中整个字符串, 只是被切成多块,放到了一个数组中</span>
<span class="token comment">// 第二个参数是模块字符串中, 第一个 $&#123;&#125;</span>
<span class="token comment">// 第三个参数是模块字符串中, 第二个 $&#123;&#125;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> x</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> x<span class="token punctuation">,</span> <span class="token string">"---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">"why"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
foo<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">Wo</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>age<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">rld</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span> <span class="token comment">// [ 'Hello', 'Wo', 'rld' ] why 18 ---------</span></code></pre>



<ul>
<li>React 中的 Style-Component 库便使用到了 标签模板字符串：</li>
</ul>
<p><img src="/blogs/f3f94af8/56.jpg" loading="lazy"></p>
<h2 id="函数的默认参数"><a href="#函数的默认参数" class="headerlink" title="函数的默认参数"></a>函数的默认参数</h2><ul>
<li><p>在ES6之前，我们编写的函数参数是没有默认值的，所以我们在编写函数时，如果有下面的需求： </p>
<ul>
<li><p>传入了参数，那么使用传入的参数；</p>
</li>
<li><p>没有传入参数，那么使用一个默认值；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// ES5以及之前给参数默认值</span>
<span class="token comment">/**
 * 缺点:
 *  1.写起来很麻烦, 并且代码的阅读性是比较差
 *  2.这种写法是有bug(传 0 或 ""等  时会有问题)
 */</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  m <span class="token operator">=</span> m <span class="token operator">||</span> <span class="token string">"aaa"</span><span class="token punctuation">;</span>
  n <span class="token operator">=</span> n <span class="token operator">||</span> <span class="token string">"bbb"</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<ul>
<li>而在ES6中，我们允许给函数一个默认值：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 1.ES6可以给函数参数提供默认值</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>m <span class="token operator">=</span> <span class="token string">"aaa"</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token string">"bbb"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2.对象参数和默认值以及解构</span>
<span class="token keyword">function</span> <span class="token function">printInfo</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> name<span class="token punctuation">,</span> age <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">printInfo</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"kobe"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">40</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 另外一种写法</span>
<span class="token keyword">function</span> <span class="token function">printInfo1</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> name <span class="token operator">=</span> <span class="token string">"why"</span><span class="token punctuation">,</span> age <span class="token operator">=</span> <span class="token number">18</span> <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">printInfo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3.有默认值的形参最好放到最后，如果默认值放在前面的话，使用默认值时需要传递 undefined。</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">30</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">bar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// bar(undefined, 10, 20);    --> function bar(z = 30, x, y)</span>

<span class="token comment">// 4.有默认值的函数的length属性</span>
<span class="token keyword">function</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>baz<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span></code></pre>

<ul>
<li><p>默认值也可以和解构一起来使用：</p>
</li>
<li><p>另外参数的默认值我们通常会将其放到最后（在很多语言中，如果不放到最后其实会报错的）： </p>
<ul>
<li>但是JavaScript允许不将其放到最后，但是意味着还是会按照顺序来匹配； </li>
</ul>
</li>
<li><p>另外默认值会改变函数的length的个数，默认值以及后面的参数都不计算在length之内了。</p>
</li>
</ul>
<h2 id="函数的剩余参数"><a href="#函数的剩余参数" class="headerlink" title="函数的剩余参数"></a>函数的剩余参数</h2><ul>
<li><p>ES6中引用了rest parameter，可以将不定数量的参数放入到一个数组中：</p>
<ul>
<li>如果最后一个参数是 … 为前缀的，那么它会将剩余的参数放到该参数中，并且作为一个数组； </li>
</ul>
</li>
<li><p><strong>那么剩余参数和arguments有什么区别呢？</strong></p>
<ul>
<li><p>剩余参数只包含那些没有对应形参的实参，而 arguments 对象包含了传给函数的所有实参； </p>
</li>
<li><p>arguments对象不是一个真正的数组，而rest参数是一个真正的数组，可以进行数组的所有操作；</p>
</li>
<li><p>arguments是早期的ECMAScript中为了方便去获取所有的参数提供的一个数据结构，而rest参数是ES6中提供 并且希望以此来替代arguments的； </p>
</li>
<li><p>剩余参数必须放到最后一个位置，否则会报错。</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// function foo( ...args,m, n) &#123; // 报错： Rest parameter must be last formal parameter</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="箭头函数的补充"><a href="#箭头函数的补充" class="headerlink" title="箭头函数的补充"></a>箭头函数的补充</h2><ul>
<li>在前面我们已经学习了箭头函数的用法，这里进行一些补充： <ul>
<li>箭头函数是没有显式原型的，所以不能作为构造函数，使用new来创建对象；</li>
</ul>
</li>
</ul>
<p><img src="https://pic-1308164762.cos.ap-shanghai.myqcloud.com/CodeWhy-JavaScript%E9%AB%98%E7%BA%A7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/57.jpg" loading="lazy"></p>
<h2 id="展开语法"><a href="#展开语法" class="headerlink" title="展开语法"></a>展开语法</h2><ul>
<li><p>**展开语法(Spread syntax)**： </p>
<ul>
<li><p>可以在函数调用/数组构造时，将数组表达式或者string在语法层面展开；</p>
</li>
<li><p>还可以在构造字面量对象时, 将对象表达式按key-value的方式展开；</p>
</li>
</ul>
</li>
<li><p>展开语法的场景： </p>
<ul>
<li><p>在函数调用时使用；</p>
</li>
<li><p>在数组构造时使用；</p>
</li>
<li><p>在构建对象字面量时，也可以使用展开运算符，这个是在ES2018（ES9）中添加的新特性；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">,</span> <span class="token string">"nba"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">"why"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 1.函数调用时</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// foo.apply(null, names)</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token operator">...</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// abc cba nba</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token operator">...</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// w h y</span>

<span class="token comment">// 2.构造数组时</span>
<span class="token keyword">const</span> newNames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>names<span class="token punctuation">,</span> <span class="token operator">...</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNames<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'abc', 'cba', 'nba', 'w', 'h', 'y' ]</span>

<span class="token comment">// 3.构建对象字面量时ES2018(ES9)</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>info<span class="token punctuation">,</span> address<span class="token operator">:</span> <span class="token string">"广州市"</span><span class="token punctuation">,</span> <span class="token operator">...</span>names <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
&#123;
  '0': 'abc',
  '1': 'cba',
  '2': 'nba',
  name: 'why',
  age: 18,
  address: '广州市'
&#125;
*/</span></code></pre>

<ul>
<li>注意：展开运算符其实是一种浅拷贝；</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  friend<span class="token operator">:</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"kobe"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>info<span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">"coderwhy"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>friend<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"james"</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>friend<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// james</span></code></pre>



<h2 id="数值的表示"><a href="#数值的表示" class="headerlink" title="数值的表示"></a>数值的表示</h2><ul>
<li><p>在ES6中规范了二进制和八进制的写法： </p>
</li>
<li><p>另外在ES2021新增特性：数字过长时，可以使用_作为连接符</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> num1 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// 十进制</span>

<span class="token comment">// b -> binary</span>
<span class="token keyword">const</span> num2 <span class="token operator">=</span> <span class="token number">0b100</span><span class="token punctuation">;</span> <span class="token comment">// 二进制</span>
<span class="token comment">// o -> octonary</span>
<span class="token keyword">const</span> num3 <span class="token operator">=</span> <span class="token number">0o100</span><span class="token punctuation">;</span> <span class="token comment">// 八进制</span>
<span class="token comment">// x -> hexadecimal</span>
<span class="token keyword">const</span> num4 <span class="token operator">=</span> <span class="token number">0x100</span><span class="token punctuation">;</span> <span class="token comment">// 十六进制</span>

<span class="token comment">// 大的数值的连接符(ES2021 ES12)</span>
<span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token number">10_000_000_000_000_000</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="Symbol-的基本使用"><a href="#Symbol-的基本使用" class="headerlink" title="Symbol 的基本使用"></a>Symbol 的基本使用</h2><ul>
<li><p>Symbol是什么呢？Symbol是ES6中新增的一个基本数据类型，翻译为符号。</p>
</li>
<li><p><strong>那么为什么需要Symbol呢？</strong></p>
<ul>
<li><p>在ES6之前，对象的属性名都是字符串形式，那么很容易造成属性名的冲突； </p>
</li>
<li><p>比如原来有一个对象，我们希望在其中添加一个新的属性和值，但是我们在不确定它原来内部有什么内容的情况下，很容易造成冲突，从而覆盖掉它内部的某个属性； </p>
</li>
<li><p>比如我们前面在讲apply、call、bind实现时，我们有给其中添加一个fn属性，那么如果它内部原来已经有了fn属性了呢？</p>
</li>
<li><p>比如开发中我们使用混入，那么混入中出现了同名的属性，必然有一个会被覆盖掉；</p>
</li>
</ul>
</li>
<li><p>Symbol就是为了解决上面的问题，用来<strong>生成一个独一无二的值</strong>。 </p>
<ul>
<li><p>Symbol值是通过Symbol函数来生成的，生成后可以作为属性名； </p>
</li>
<li><p>也就是在ES6中，对象的属性名可以使用字符串，也可以使用Symbol值； </p>
</li>
</ul>
</li>
<li><p><strong>Symbol即使多次创建值，它们也是不同的：</strong>Symbol函数执行后每次创建出来的值都是独一无二的；</p>
</li>
<li><p><strong>我们也可以在创建Symbol值的时候传入一个描述description</strong>：这个是ES2019（ES10）新增的特性；</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 1.ES6之前, 对象的属性名(key)</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  friend<span class="token operator">:</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"kobe"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 新增属性容易重复，特别是在使用第三方库或框架时。</span>
obj<span class="token punctuation">[</span><span class="token string">"newName"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"james"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 2.ES6中Symbol的基本使用</span>
<span class="token keyword">const</span> s1 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> s2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1 <span class="token operator">===</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

<span class="token comment">// ES2019(ES10)中, Symbol还有一个描述(description)</span>
<span class="token keyword">const</span> s3 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s3<span class="token punctuation">.</span>description<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// aaa</span></code></pre>

<ul>
<li>我们通常会使用Symbol在对象中表示唯一的属性名：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 3.Symbol值作为key</span>
<span class="token comment">// 3.1.在定义对象字面量时使用</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span>s1<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">"abc"</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>s2<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">"cba"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 3.2.新增属性</span>
obj<span class="token punctuation">[</span>s3<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"nba"</span><span class="token punctuation">;</span>

<span class="token comment">// 3.3.Object.defineProperty方式</span>
<span class="token keyword">const</span> s4 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> s4<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  value<span class="token operator">:</span> <span class="token string">"mba"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>s1<span class="token punctuation">]</span><span class="token punctuation">,</span> obj<span class="token punctuation">[</span>s2<span class="token punctuation">]</span><span class="token punctuation">,</span> obj<span class="token punctuation">[</span>s3<span class="token punctuation">]</span><span class="token punctuation">,</span> obj<span class="token punctuation">[</span>s4<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 注意: 不能通过.语法获取</span>
<span class="token comment">// console.log(obj.s1)</span></code></pre>

<ul>
<li>使用Symbol作为key的属性名,在遍历/Object.keys等中是获取不到这些Symbol值。需要Object.getOwnPropertySymbols来获取所有Symbol的key。</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// []</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// []</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ Symbol(), Symbol(), Symbol(aaa), Symbol() ]</span>
<span class="token keyword">const</span> sKeys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> sKey <span class="token keyword">of</span> sKeys<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>sKey<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<ul>
<li><p>前面我们讲Symbol的目的是为了创建一个独一无二的值，那么如果我们现在就是想创建相同的Symbol应该怎么来做呢？</p>
<ul>
<li><p>我们可以使用Symbol.for方法来做到这一点；</p>
</li>
<li><p>并且我们可以通过Symbol.keyFor方法来获取对应的key；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> sa <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sb <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sa <span class="token operator">===</span> sb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token keyword">const</span> key <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">keyFor</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// aaa</span>
<span class="token keyword">const</span> sc <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sa <span class="token operator">===</span> sc<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre>



<h2 id="Set的基本使用"><a href="#Set的基本使用" class="headerlink" title="Set的基本使用"></a>Set的基本使用</h2><ul>
<li><p>在ES6之前，我们存储数据的结构主要有两种：数组、对象。</p>
<ul>
<li>在ES6中新增了另外两种数据结构：Set、Map，以及它们的另外形式WeakSet、WeakMap。 </li>
</ul>
</li>
<li><p>Set是一个新增的数据结构，可以用来保存数据，类似于数组，但是和数组的区别是<strong>元素不能重复</strong>。 </p>
<ul>
<li>创建Set我们需要通过Set构造函数（暂时没有字面量创建的方式）： </li>
</ul>
</li>
<li><p>我们可以发现Set中存放的元素是不会重复的，Set有一个非常常用的功能就是给数组去重。</p>
</li>
</ul>
<ul>
<li><p>Set常见的属性：</p>
<ul>
<li>size：返回Set中元素的个数；</li>
</ul>
</li>
<li><p>Set常用的方法：</p>
<ul>
<li><p>add(value)：添加某个元素，返回Set对象本身； </p>
</li>
<li><p>delete(value)：从set中删除和这个值相等的元素，返回boolean类型；</p>
</li>
<li><p>has(value)：判断set中是否存在某个元素，返回boolean类型；</p>
</li>
<li><p>clear()：清空set中所有的元素，没有返回值；</p>
</li>
<li><p>forEach(callback, [, thisArg])：通过forEach遍历set； </p>
</li>
</ul>
</li>
<li><p>另外Set是支持for of的遍历的。</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 10, 20, 40, 333</span>
<span class="token comment">// 1.创建Set结构</span>
<span class="token keyword">const</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">333</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2.添加对象时特别注意: 对象即便内容一致，但对象本身地址不同，仍是两个对象，而不是相同的一个对象</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 像下面这种添加方式，才为添加同一个对象</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// console.log(set)</span>

<span class="token comment">// 3.对数组去重(去除重复的元素)</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 原始方法</span>
<span class="token comment">// const newArr = []</span>
<span class="token comment">// for (const item of arr) &#123;</span>
<span class="token comment">//   if (newArr.indexOf(item) !== -1) &#123;</span>
<span class="token comment">//     newArr.push(item)</span>
<span class="token comment">//   &#125;</span>
<span class="token comment">// &#125;</span>

<span class="token comment">// 使用 new Set 进行去重</span>
<span class="token comment">// 先用 new Set 去重</span>
<span class="token keyword">const</span> arrSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 再使用 Array.from 或 [...Array] 的方式将 Set 转为数组</span>
<span class="token keyword">const</span> newArr <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arrSet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// const newArr = [...arrSet]; // set 也是支持展开运算符的</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 33, 10, 26, 30 ]</span>

<span class="token comment">// 4.size属性</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrSet<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//4</span>

<span class="token comment">// 5.Set的方法</span>
<span class="token comment">// add</span>
arrSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrSet<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set(5) &#123; 33, 10, 26, 30, 100 &#125;</span>

<span class="token comment">// delete</span>
arrSet<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrSet<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set(4) &#123; 10, 26, 30, 100 &#125;</span>

<span class="token comment">// has</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrSet<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token comment">// clear</span>
arrSet<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrSet<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set(0) &#123;&#125;</span>

<span class="token comment">// 6.对Set进行遍历</span>
arrSet<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> arrSet<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>



<h2 id="WeakSet-的基本使用"><a href="#WeakSet-的基本使用" class="headerlink" title="WeakSet 的基本使用"></a>WeakSet 的基本使用</h2><ul>
<li><p>和Set类似的另外一个数据结构称之为WeakSet，也是内部元素不能重复的数据结构。 </p>
</li>
<li><p><strong>那么和Set有什么区别呢？</strong></p>
<ul>
<li><p>区别一：WeakSet中只能存放对象类型，不能存放基本数据类型；</p>
</li>
<li><p>区别二：WeakSet对元素的引用是弱引用，如果没有其他引用对某个对象进行引用，那么GC可以对该对象进行回收； </p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> weakSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 1.区别一: 只能存放对象类型</span>
<span class="token comment">// weakSet.add(10)   // TypeError: Invalid value used in weak set</span>

<span class="token comment">// 2.区别二: 对对象是一个弱引用</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">// 此处的weakSet.add(obj)对obj建立的是弱引用</span>
<span class="token comment">// 建立的是弱引用(弱引用虽然能够获取数据，当GC会将其忽略，认为其所指向的对象仍然是未被指向的)</span>
<span class="token comment">// weakSet.add(obj)</span>

<span class="token comment">// 此处的set.add(obj)对obj建立的是强引用</span>
<span class="token keyword">const</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>


console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>weakSet<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined  weakSet 没有 size 属性</span></code></pre>

<ul>
<li><p>WeakSet常见的方法： </p>
<ul>
<li><p>add(value)：添加某个元素，返回WeakSet对象本身；</p>
</li>
<li><p>delete(value)：从WeakSet中删除和这个值相等的元素，返回boolean类型；</p>
</li>
<li><p>has(value)：判断WeakSet中是否存在某个元素，返回boolean类型；</p>
</li>
</ul>
</li>
</ul>
<h2 id="WeakSet-的应用场景"><a href="#WeakSet-的应用场景" class="headerlink" title="WeakSet 的应用场景"></a>WeakSet 的应用场景</h2><ul>
<li><p>注意：WeakSet不能遍历</p>
<ul>
<li><p>因为WeakSet只是对对象的弱引用，如果我们遍历获取到其中的元素，那么有可能造成对象不能正常的销毁。 </p>
</li>
<li><p>所以存储到WeakSet中的对象是没办法获取的；</p>
</li>
</ul>
</li>
<li><p>那么这个东西有什么用呢？</p>
<ul>
<li>事实上这个问题并不好回答，我们来使用一个Stack Overflow上的答案：</li>
<li>可以看到，使用WeakSet 后，将构造函数 this 加入WeakSet实例对象，之后在调用 running 函数时，通过判断其内部的 this，确保是通过实例进行直接调用的，而不是通过 call 等方式调用，保证了内部 this 指向的安全。</li>
<li>为什么不用 Set ? 因为使用 WeakSet 后，由于其是弱引用，其内部添加的 this （及实例对象）指向 null 时，其会自动销毁。而若使用 Set ，由于Set 中仍然有一个强引用指向 this，会导致其无法销毁。</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> personSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    personSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>personSet<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"不能通过非构造方法创建出来的对象调用running方法"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"running~"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

p<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"why"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 报错</span></code></pre>



<h2 id="Map-的基本使用"><a href="#Map-的基本使用" class="headerlink" title="Map 的基本使用"></a>Map 的基本使用</h2><ul>
<li><p>另外一个新增的数据结构是Map，用于存储映射关系。 </p>
</li>
<li><p>但是我们可能会想，在之前我们可以使用对象来存储映射关系，他们有什么区别呢？</p>
<ul>
<li><p>事实上我们对象存储映射关系只能用字符串（ES6新增了Symbol）作为属性名（key）； </p>
</li>
<li><p>某些情况下我们可能希望通过其他类型作为key，比如对象，这个时候会自动将对象转成字符串来作为key； </p>
</li>
</ul>
</li>
<li><p>那么我们就可以使用Map：</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 1.JavaScript中对象中是不能使用对象来作为key的</span>
<span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"why"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"kobe"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span>obj1<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">"aaa"</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>obj2<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">"bbb"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123; '[object Object]': 'bbb' &#125;  // obj1和 obj2 都会被转成字符串[object Object]，同时前面的字符串会替代后面的，从而导致了这样的输出结果</span>

<span class="token comment">// 2.Map就是允许我们对象类型来作为key的</span>
<span class="token comment">// 构造方法的使用</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj1<span class="token punctuation">,</span> <span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj2<span class="token punctuation">,</span> <span class="token string">"bbb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"ccc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
&#123;
  &#123; name: 'why' &#125; => 'aaa',
  &#123; name: 'kobe' &#125; => 'bbb',
  2 => 'ddd'
&#125;
*/</span>

<span class="token keyword">const</span> map2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span>obj1<span class="token punctuation">,</span> <span class="token string">"aaa"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>obj2<span class="token punctuation">,</span> <span class="token string">"bbb"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"ddd"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
Map(3) &#123;
  &#123; name: 'why' &#125; => 'aaa',
  &#123; name: 'kobe' &#125; => 'bbb',
  2 => 'ddd'
&#125;
*/</span></code></pre>



<ul>
<li><p>Map常见的属性：</p>
<ul>
<li>size：返回Map中元素的个数；</li>
</ul>
</li>
<li><p>Map常见的方法：</p>
<ul>
<li><p>set(key, value)：在Map中添加key、value，并且返回整个Map对象；</p>
</li>
<li><p>get(key)：根据key获取Map中的value； </p>
</li>
<li><p>has(key)：判断是否包括某一个key，返回Boolean类型；</p>
</li>
<li><p>delete(key)：根据key删除一个键值对，返回Boolean类型；</p>
</li>
<li><p>clear()：清空所有的元素； </p>
</li>
<li><p>forEach(callback, [, thisArg])：通过forEach遍历Map； </p>
</li>
</ul>
</li>
<li><p>Map也可以通过for of进行遍历</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 3.常见的属性和方法</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map2<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 3</span>

<span class="token comment">// set</span>
map2<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">,</span> <span class="token string">"eee"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
Map(4) &#123;
  &#123; name: 'why' &#125; => 'aaa',
  &#123; name: 'kobe' &#125; => 'bbb',
  2 => 'ddd',
  'why' => 'eee'
&#125;
*/</span>

<span class="token comment">// get(key)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map2<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// eee</span>

<span class="token comment">// has(key)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map2<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token comment">// delete(key)</span>
map2<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// clear</span>
<span class="token comment">// map2.clear()</span>
<span class="token comment">// console.log(map2)</span>

<span class="token comment">// 4.遍历map</span>
map2<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> map2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 直接将数组解构</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> map2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>



<h2 id="WeakMap-的基本使用"><a href="#WeakMap-的基本使用" class="headerlink" title="WeakMap 的基本使用"></a>WeakMap 的基本使用</h2><ul>
<li><p>和Map类型x类似的另外一个数据结构称之为WeakMap，也是以键值对的形式存在的。</p>
</li>
<li><p>那么和Map有什么区别呢？</p>
<ul>
<li><p>区别一：WeakMap的key只能使用对象，不接受其他的类型作为key； </p>
</li>
<li><p>区别二：WeakMap的key对对象想的引用是弱引用，如果没有其他引用引用这个对象，那么GC可以回收该对象；</p>
</li>
</ul>
</li>
<li><p>WeakMap常见的方法有四个：</p>
<ul>
<li><p>set(key, value)：在Map中添加key、value，并且返回整个Map对象；</p>
</li>
<li><p>get(key)：根据key获取Map中的value； </p>
</li>
<li><p>has(key)：判断是否包括某一个key，返回Boolean类型；</p>
</li>
<li><p>delete(key)：根据key删除一个键值对，返回Boolean类型；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"obj1"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">// 1.WeakMap和Map的区别二: WeakMap 是弱引用</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> weakMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
weakMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2.区别一: weakMap不能使用基本数据类型</span>
<span class="token comment">// weakMap.set(1, "ccc")</span>

<span class="token comment">// 3.常见方法</span>
<span class="token comment">// get方法</span>

<span class="token comment">// console.log(weakMap.size); // undefined  weakMap 没有对应的 size 属性</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>weakMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// has方法</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>weakMap<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// delete方法</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>weakMap<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// WeakMap &#123; &lt;items unknown> &#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>weakMap<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h2 id="WeakMap-的应用场景"><a href="#WeakMap-的应用场景" class="headerlink" title="WeakMap 的应用场景"></a>WeakMap 的应用场景</h2><ul>
<li><p>注意：WeakMap也是不能遍历的 </p>
<ul>
<li>因为没有forEach方法，也不支持通过for of的方式进行遍历； </li>
</ul>
</li>
<li><p>那么我们的WeakMap有什么作用呢？</p>
<ul>
<li>响应式原理中就使用到了WeakMap。</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 应用场景(vue3响应式原理)</span>
<span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">obj1NameFn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"obj1NameFn1被执行"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">obj1NameFn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"obj1NameFn2被执行"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">obj1AgeFn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"obj1AgeFn1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">obj1AgeFn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"obj1AgeFn2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"kobe"</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">1.88</span><span class="token punctuation">,</span>
  address<span class="token operator">:</span> <span class="token string">"广州市"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">obj2NameFn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"obj1NameFn1被执行"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">obj2NameFn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"obj1NameFn2被执行"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 1.创建WeakMap</span>
<span class="token comment">// 使用 WeakMap ，保证之后当 obj1、obj2 为 null的时候，WeakMap 内部相关依赖也会同时销毁。</span>
<span class="token keyword">const</span> weakMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2.收集依赖结构</span>
<span class="token comment">// 2.1.对obj1收集的数据结构</span>
<span class="token keyword">const</span> obj1Map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj1Map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>obj1NameFn1<span class="token punctuation">,</span> obj1NameFn2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj1Map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>obj1AgeFn1<span class="token punctuation">,</span> obj1AgeFn2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
weakMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj1<span class="token punctuation">,</span> obj1Map<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2.2.对obj2收集的数据结构</span>
<span class="token keyword">const</span> obj2Map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj2Map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>obj2NameFn1<span class="token punctuation">,</span> obj2NameFn2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
weakMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj2<span class="token punctuation">,</span> obj2Map<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3.如果obj1.name发生了改变</span>
<span class="token comment">// Proxy/Object.defineProperty</span>
obj1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"james"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> targetMap <span class="token operator">=</span> weakMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fns <span class="token operator">=</span> targetMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fns<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">item</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<h1 id="ES6-相关知识点-1"><a href="#ES6-相关知识点-1" class="headerlink" title="ES6+ 相关知识点"></a>ES6+ 相关知识点</h1><h2 id="ES7-相关知识点"><a href="#ES7-相关知识点" class="headerlink" title="ES7 相关知识点"></a>ES7 相关知识点</h2><p>###数组方法 includes</p>
<ul>
<li><p>在ES7之前，如果我们想判断一个数组中是否包含某个元素，需要通过 indexOf 获取结果，并且判断是否为 -1。 </p>
</li>
<li><p>在ES7中，我们可以通过includes来判断一个数组中是否包含一个指定的元素，根据情况，如果包含则返回 true，否则返回false。</p>
</li>
<li><p>includes 与 indexOf 的区别之一在于 ： includes 可以判断 NaN，而 indexOf 无法正确判断 NaN。</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">,</span> <span class="token string">"nba"</span><span class="token punctuation">,</span> <span class="token string">"mba"</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>names<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"cba"</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"包含abc元素"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ES7 ES2016</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>names<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"cba"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// 第二个参数表示从第几个元素开始判断是否包含</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"包含abc元素"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>names<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// indexOf 无法正确判断 NaN </span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"包含NaN"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>names<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"包含NaN"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>



<h3 id="指数-乘方-exponentiation运算符"><a href="#指数-乘方-exponentiation运算符" class="headerlink" title="指数(乘方) exponentiation运算符"></a>指数(乘方) exponentiation运算符</h3><ul>
<li><p>在ES7之前，计算数字的乘方需要通过 Math.pow 方法来完成。</p>
</li>
<li><p>在ES7中，增加了 ** 运算符，可以对数字来计算乘方。</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> result1 <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment">// ES7: **</span>
<span class="token keyword">const</span> result2 <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">**</span> <span class="token number">3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result1<span class="token punctuation">,</span> result2<span class="token punctuation">)</span>	<span class="token comment">// 27 27</span></code></pre>



<h2 id="ES8-相关知识点"><a href="#ES8-相关知识点" class="headerlink" title="ES8 相关知识点"></a>ES8 相关知识点</h2><h3 id="Object-Values"><a href="#Object-Values" class="headerlink" title="Object Values"></a>Object Values</h3><ul>
<li>之前我们可以通过 Object.keys 获取一个对象所有的key，在ES8中提供了 Object.values 来获取所有的value值：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'name', 'age' ]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'why', 18 ]</span>

<span class="token comment">// 用的非常少</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">,</span> <span class="token string">"nba"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'abc', 'cba', 'nba' ]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'a', 'b', 'c' ]</span></code></pre>



<h3 id="Object-entries"><a href="#Object-entries" class="headerlink" title="Object entries"></a>Object entries</h3><ul>
<li>通过Object.entries 可以获取到一个数组，数组中会存放可枚举属性的键值对数组。</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ [ 'name', 'why' ], [ 'age', 18 ] ]</span>
<span class="token keyword">const</span> objEntries <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
objEntries<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">,</span> <span class="token string">"nba"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ [ '0', 'abc' ], [ '1', 'cba' ], [ '2', 'nba' ] ]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  [ [ '0', 'a' ], [ '1', 'b' ], [ '2', 'c' ] ]</span></code></pre>



<h3 id="String-Padding"><a href="#String-Padding" class="headerlink" title="String Padding"></a>String Padding</h3><ul>
<li>某些字符串我们需要对其进行前后的填充，来实现某种格式化效果，ES8中增加了 padStart 和 padEnd 方法，分别是对字符串的首尾进行填充的。</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token string">"Hello World"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> newMessage <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">padEnd</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newMessage<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ****Hello World-----</span>

<span class="token comment">// 案例</span>
<span class="token keyword">const</span> cardNumber <span class="token operator">=</span> <span class="token string">"321324234242342342341312"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> lastFourCard <span class="token operator">=</span> cardNumber<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> finalCard <span class="token operator">=</span> lastFourCard<span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span>cardNumber<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>finalCard<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ********************1312</span></code></pre>



<h3 id="Trailing-Commas"><a href="#Trailing-Commas" class="headerlink" title="Trailing Commas"></a>Trailing Commas</h3><ul>
<li>在ES8中，我们允许在函数定义和调用时多加一个逗号：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> n<span class="token punctuation">,</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span><span class="token punctuation">)</span></code></pre>



<h3 id="Object-getOwnPropertyDescriptors"><a href="#Object-getOwnPropertyDescriptors" class="headerlink" title="Object.getOwnPropertyDescriptors"></a>Object.getOwnPropertyDescriptors</h3><ul>
<li>ES8中增加了另一个对对象的操作是 Object.getOwnPropertyDescriptors ，这个在之前已经讲过了，这里不再重复。</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
&#123;
  length: &#123; value: 0, writable: false, enumerable: false, configurable: true &#125;,
  name: &#123;
    value: 'Foo',
    writable: false,
    enumerable: false,
    configurable: true
  &#125;,
  arguments: &#123;
    value: null,
    writable: false,
    enumerable: false,
    configurable: false
  &#125;,
  caller: &#123;
    value: null,
    writable: false,
    enumerable: false,
    configurable: false
  &#125;,
  prototype: &#123; value: &#123;&#125;, writable: true, enumerable: false, configurable: false &#125;
&#125;
*/</span>
</code></pre>



<h2 id="ES9-相关知识点"><a href="#ES9-相关知识点" class="headerlink" title="ES9 相关知识点"></a>ES9 相关知识点</h2><ul>
<li><p><strong>Async iterators：后续迭代器讲解</strong></p>
</li>
<li><p><strong>Object spread operators：前面讲过了</strong></p>
</li>
<li><p><strong>Promise finally：后续讲Promise讲解</strong></p>
</li>
</ul>
<h2 id="ES10-相关知识点"><a href="#ES10-相关知识点" class="headerlink" title="ES10 相关知识点"></a>ES10 相关知识点</h2><h3 id="flat-flatMap"><a href="#flat-flatMap" class="headerlink" title="flat flatMap"></a>flat flatMap</h3><ul>
<li>flat() 方法会按照一个可指定的深度递归遍历数组，并将所有元素与遍历到的子数组中的元素合并为一个新数组返回。 </li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 1.flat的使用 （降维）</span>
<span class="token keyword">const</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> newNums <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">// 不传默认深度为1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNums<span class="token punctuation">)</span>    <span class="token comment">// [ 10, 20, 2, 9, [ 30, 40 ], [ 10, 45 ], 78, 55, 88 ]</span>

<span class="token keyword">const</span> newNums2 <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNums2<span class="token punctuation">)</span>   <span class="token comment">// [10, 20,  2,  9, 30, 40, 10, 45, 78, 55, 88]</span></code></pre>

<ul>
<li><p>flatMap() 方法首先使用映射函数映射每个元素，然后将结果压缩成一个新数组。</p>
<ul>
<li><p>注意一：flatMap是先进行map操作，再做flat的操作；</p>
</li>
<li><p>注意二：flatMap中的flat相当于深度为1；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 2.flatMap的使用</span>
<span class="token keyword">const</span> nums2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newNums3 <span class="token operator">=</span> nums2<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> item <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newNums4 <span class="token operator">=</span> nums2<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> item <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNums3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 20, 40, 60 ]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNums4<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 20, 40, 60 ]</span>

<span class="token comment">// 3.flatMap的应用场景</span>
<span class="token keyword">const</span> messages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Hello World"</span><span class="token punctuation">,</span> <span class="token string">"hello lyh"</span><span class="token punctuation">,</span> <span class="token string">"my name is coderwhy"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> words <span class="token operator">=</span> messages<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
[
  'Hello', 'World',
  'hello', 'lyh',
  'my',    'name',
  'is',    'coderwhy'
]
*/</span></code></pre>

<h3 id="Object-fromEntries"><a href="#Object-fromEntries" class="headerlink" title="Object fromEntries"></a>Object fromEntries</h3><ul>
<li><p>在前面，我们可以通过 Object.entries 将一个对象转换成 entries，那么如果我们有一个entries了，如何将其转换成对象呢？</p>
<ul>
<li>ES10提供了 Object.formEntries来完成转换： </li>
</ul>
</li>
<li><p>那么这个方法有什么应用场景呢？</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">1.88</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> entries <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>entries<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ [ 'name', 'why' ], [ 'age', 18 ], [ 'height', 1.88 ] ]</span>

<span class="token comment">// const newObj = &#123;&#125;;</span>
<span class="token comment">// for (const entry of entries) &#123;</span>
<span class="token comment">//   newObj[entry[0]] = entry[1];</span>
<span class="token comment">// &#125;</span>

<span class="token comment">// 1.ES10中新增了Object.fromEntries方法</span>
<span class="token keyword">const</span> newObj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span>entries<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123; name: 'why', age: 18, height: 1.88 &#125;</span>

<span class="token comment">// 2.Object.fromEntries的应用场景</span>
<span class="token keyword">const</span> queryString <span class="token operator">=</span> <span class="token string">"name=why&amp;age=18&amp;height=1.88"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> queryParams <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>queryString<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> param <span class="token keyword">of</span> queryParams<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> paramObj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span>queryParams<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>paramObj<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h3 id="trimStart-与-trimEnd"><a href="#trimStart-与-trimEnd" class="headerlink" title="trimStart 与 trimEnd"></a>trimStart 与 trimEnd</h3><ul>
<li>去除一个字符串首尾的空格，我们可以通过trim方法，如果单独去除前面或者后面呢？<ul>
<li>ES10中给我们提供了trimStart和trimEnd；</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token string">"    Hello World    "</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">trimStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">trimEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>



<h3 id="ES10其它知识点"><a href="#ES10其它知识点" class="headerlink" title="ES10其它知识点"></a>ES10其它知识点</h3><ul>
<li><p><strong>Symbol description：已经讲过了</strong></p>
</li>
<li><p><strong>Optional catch binding：后面讲解try cach讲解</strong></p>
</li>
</ul>
<h2 id="ES11-相关知识点"><a href="#ES11-相关知识点" class="headerlink" title="ES11 相关知识点"></a>ES11 相关知识点</h2><h3 id="BigInt"><a href="#BigInt" class="headerlink" title="BigInt"></a>BigInt</h3><ul>
<li><p>在早期的JavaScript中，我们不能正确的表示过大的数字：</p>
<ul>
<li>大于MAX_SAFE_INTEGER的数值，表示的可能是不正确的。</li>
</ul>
</li>
<li><p>那么ES11中，引入了新的数据类型BigInt，用于表示大的整数：</p>
<ul>
<li>BitInt的表示方法是在数值的后面加上n</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// ES11之前 max_safe_integer</span>
<span class="token keyword">const</span> maxInt <span class="token operator">=</span> Number<span class="token punctuation">.</span><span class="token constant">MAX_SAFE_INTEGER</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>maxInt<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 9007199254740991</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>maxInt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>maxInt <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ES11之后: BigInt</span>
<span class="token keyword">const</span> bigInt <span class="token operator">=</span> <span class="token number">900719925474099100n</span><span class="token punctuation">;</span>
<span class="token comment">// console.log(bigInt + 10)   // 报错，此处不会隐式转换</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bigInt <span class="token operator">+</span> <span class="token number">10n</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bigInt <span class="token operator">+</span> <span class="token function">BigInt</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 将大数转为 Number 类型</span>
<span class="token keyword">const</span> smallNum <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>bigInt<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>smallNum<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>



<h3 id="Nullish-Coalescing-Operator（？？）"><a href="#Nullish-Coalescing-Operator（？？）" class="headerlink" title="Nullish Coalescing Operator（？？）"></a>Nullish Coalescing Operator（？？）</h3><ul>
<li>ES11，增加了空值合并操作符(Nullish Coalescing Operator)：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// ES11: 空值合并运算 ??</span>

<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">// const bar = foo || "default value"   // || 的问题：若我们想要 foo 为 "" 时，并返回 ""，而|| 会返回后面的值</span>
<span class="token keyword">const</span> bar <span class="token operator">=</span> foo <span class="token operator">??</span> <span class="token string">"defualt value"</span><span class="token punctuation">;</span> <span class="token comment">// ?? 只有在前面为 undefined或 null 时，才会返回后面的值</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bar<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// default value</span></code></pre>

<h3 id="Optional-Chaining（可选链）"><a href="#Optional-Chaining（可选链）" class="headerlink" title="Optional Chaining（可选链）"></a>Optional Chaining（可选链）</h3><ul>
<li>可选链也是ES11中新增一个特性，主要作用是让我们的代码在进行null和undefined判断时更加清晰和简洁：</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  <span class="token comment">// friend: &#123;</span>
  <span class="token comment">//   girlFriend: &#123;</span>
  <span class="token comment">//     name: "hmm"</span>
  <span class="token comment">//   &#125;</span>
  <span class="token comment">// &#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">// console.log(info.friend.girlFriend.name)</span>
<span class="token comment">// if (info &amp;&amp; info.friend &amp;&amp; info.friend.girlFriend) &#123;</span>
<span class="token comment">//   console.log(info.friend.girlFriend.name)</span>
<span class="token comment">// &#125;</span>

<span class="token comment">// ES11提供了可选链(Optional Chainling)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>friend<span class="token operator">?.</span>girlFriend<span class="token operator">?.</span>name<span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'其他的代码逻辑'</span><span class="token punctuation">)</span></code></pre>



<h3 id="globalThis"><a href="#globalThis" class="headerlink" title="globalThis"></a>globalThis</h3><ul>
<li><p>在之前我们希望获取JavaScript环境的全局对象，不同的环境获取的方式是不一样的 </p>
<ul>
<li><p>比如在浏览器中可以通过this、window来获取；</p>
</li>
<li><p>比如在Node中我们需要通过global来获取；</p>
</li>
</ul>
</li>
<li><p>那么在ES11中对获取全局对象进行了统一的规范：globalThis</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 获取某一个环境下的全局对象(Global Object)</span>

<span class="token comment">// 在浏览器下</span>
<span class="token comment">// console.log(window)</span>
<span class="token comment">// console.log(this)</span>

<span class="token comment">// 在node下</span>
<span class="token comment">// console.log(global)</span>

<span class="token comment">// ES11</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>globalThis<span class="token punctuation">)</span></code></pre>



<h3 id="for…in-标准化"><a href="#for…in-标准化" class="headerlink" title="for…in 标准化"></a>for…in 标准化</h3><ul>
<li><p>在ES11之前，虽然很多浏览器支持for…in来遍历对象类型，但是并没有被ECMA标准化。 </p>
</li>
<li><p>在ES11中，对其进行了标准化，for…in是用于遍历对象的key的：</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// for...in 标准化: ECMA</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>   <span class="token comment">// name age</span>
<span class="token punctuation">&#125;</span></code></pre>

<h3 id="ES11-其它知识点"><a href="#ES11-其它知识点" class="headerlink" title="ES11 其它知识点"></a>ES11 其它知识点</h3><ul>
<li><p><strong>Dynamic Import：</strong>后续ES Module模块化中讲解。 </p>
</li>
<li><p><strong>Promise.allSettled：</strong>后续讲Promise的时候讲解。 </p>
</li>
<li><p><strong>import meta：</strong>后续ES Module模块化中讲解。</p>
</li>
</ul>
<h2 id="ES12-相关知识点"><a href="#ES12-相关知识点" class="headerlink" title="ES12 相关知识点"></a>ES12 相关知识点</h2><h3 id="FinalizationRegistry"><a href="#FinalizationRegistry" class="headerlink" title="FinalizationRegistry"></a>FinalizationRegistry</h3><ul>
<li><p>FinalizationRegistry 对象可以让你在对象被垃圾回收时请求一个回调。 </p>
<ul>
<li><p>FinalizationRegistry 提供了这样的一种方法：当一个在注册表中注册的对象被回收时，请求在某个时间点上调用一个清理回调。（清理回调有时被称为 finalizer ）; </p>
</li>
<li><p>你可以通过调用register方法，注册任何你想要清理回调的对象，传入该对象和所含的值;</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// ES12: FinalizationRegistry类</span>
<span class="token keyword">const</span> finalRegistry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FinalizationRegistry</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"注册在finalRegistry的对象, 某一个被销毁"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>		<span class="token comment">// 此处的 value 对应 register 时传入的第二个参数</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"why"</span> <span class="token punctuation">&#125;</span>
<span class="token keyword">let</span> info <span class="token operator">=</span> <span class="token punctuation">&#123;</span> age<span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">&#125;</span>

finalRegistry<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">"obj"</span><span class="token punctuation">)</span>
finalRegistry<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>info<span class="token punctuation">,</span> <span class="token string">"value"</span><span class="token punctuation">)</span>

obj <span class="token operator">=</span> <span class="token keyword">null</span>
info <span class="token operator">=</span> <span class="token keyword">null</span></code></pre>

<h3 id="WeakRef"><a href="#WeakRef" class="headerlink" title="WeakRef"></a>WeakRef</h3><ul>
<li>如果我们默认将一个对象赋值给另外一个引用，那么这个引用是一个强引用：<ul>
<li>如果我们希望是一个弱引用的话，可以使用WeakRef；</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// ES12: WeakRef类</span>
<span class="token comment">// WeakRef.prototype.deref: </span>
<span class="token comment">// > 如果原对象没有销毁, 那么可以获取到原对象</span>
<span class="token comment">// > 如果原对象已经销毁, 那么获取到的是undefined</span>
<span class="token keyword">const</span> finalRegistry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FinalizationRegistry</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"注册在finalRegistry的对象, 某一个被销毁"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"why"</span> <span class="token punctuation">&#125;</span>
<span class="token keyword">let</span> info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakRef</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>

finalRegistry<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">"obj"</span><span class="token punctuation">)</span>

obj <span class="token operator">=</span> <span class="token keyword">null</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span><span class="token function">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?.</span>name<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span><span class="token function">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> info<span class="token punctuation">.</span><span class="token function">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span></code></pre>

<h3 id="logical-assignment-operators"><a href="#logical-assignment-operators" class="headerlink" title="logical assignment operators"></a>logical assignment operators</h3><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 1.||= 逻辑或赋值运算</span>
<span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token string">"hello world"</span><span class="token punctuation">;</span>
message <span class="token operator">=</span> message <span class="token operator">||</span> <span class="token string">"default value"</span><span class="token punctuation">;</span>
message <span class="token operator">||=</span> <span class="token string">"default value"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// hello world</span>

<span class="token comment">// 2.&amp;&amp;= 逻辑与赋值运算</span>
<span class="token comment">// &amp;&amp;</span>
<span class="token comment">// const obj = &#123;</span>
<span class="token comment">//   name: "why",</span>
<span class="token comment">//   foo: function() &#123;</span>
<span class="token comment">//     console.log("foo函数被调用")</span>

<span class="token comment">//   &#125;</span>
<span class="token comment">// &#125;</span>

<span class="token comment">// obj.foo &amp;&amp; obj.foo()</span>

<span class="token comment">// &amp;&amp;=</span>
<span class="token keyword">let</span> info <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// // 1.判断info</span>
<span class="token comment">// // 2.有值的情况下, 取出info.name</span>
<span class="token comment">// // info = info &amp;&amp; info.name</span>
info <span class="token operator">&amp;&amp;=</span> info<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// why</span>

<span class="token comment">// 3.??= 逻辑空赋值运算</span>
<span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
message <span class="token operator">??=</span> <span class="token string">"default value"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span></code></pre>

<h3 id="ES12-其它知识点"><a href="#ES12-其它知识点" class="headerlink" title="ES12 其它知识点"></a>ES12 其它知识点</h3><ul>
<li><p><strong>Numeric Separator：讲过了；</strong></p>
</li>
<li><p><strong>String.replaceAll：字符串替换；</strong></p>
</li>
</ul>
<h1 id="Proxy-Reflect-响应式"><a href="#Proxy-Reflect-响应式" class="headerlink" title="Proxy-Reflect-响应式"></a>Proxy-Reflect-响应式</h1><h2 id="监听对象的操作"><a href="#监听对象的操作" class="headerlink" title="监听对象的操作"></a>监听对象的操作</h2><ul>
<li><p><strong>我们先来看一个需求：有一个对象，我们希望监听这个对象中的属性被设置或获取的过程</strong></p>
<ul>
<li><p>通过我们前面所学的知识，能不能做到这一点呢？</p>
</li>
<li><p>其实是可以的，我们可以通过之前的属性描述符中的存储属性描述符来做到；</p>
</li>
</ul>
</li>
<li><p>下面这段代码就利用了前面讲过的 Object.defineProperty 的存储属性描述符来对属性的操作进行监听。</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"监听到obj对象的name属性被访问了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"监听到obj对象的name属性被设置值"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 循环遍历，对整个对象都做监听</span>
Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>

  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到obj对象的</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>key<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">属性被访问了</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到obj对象的</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>key<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">属性被设置值</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      value <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"kobe"</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">1.88</span><span class="token punctuation">;</span></code></pre>

<ul>
<li><p><strong>但是这样做有什么缺点呢？</strong></p>
<ul>
<li><p>首先，Object.defineProperty设计的初衷，不是为了去监听截止一个对象中所有的属性的。</p>
<ul>
<li>我们在定义某些属性的时候，初衷其实是定义普通的属性，但是后面<code>我们强行将它变成了数据属性描述符(defineProperty)</code>。</li>
</ul>
</li>
<li><p>其次，如果我们想监听更加丰富的操作，比如新增属性、删除属性，那么Object.defineProperty是无能为力的。</p>
</li>
<li><p>所以我们要知道，存储数据描述符设计的初衷并不是为了去监听一个完整的对象。</p>
</li>
</ul>
</li>
</ul>
<h2 id="Proxy-的基本使用"><a href="#Proxy-的基本使用" class="headerlink" title="Proxy 的基本使用"></a>Proxy 的基本使用</h2><ul>
<li><p>在ES6中，新增了一个<strong>Proxy类</strong>，这个类从名字就可以看出来，是用于帮助我们创建一个<strong>代理</strong>的：</p>
<ul>
<li><p>也就是说，如果我们希望监听一个对象的相关操作，那么我们可以先创建一个代理对象（Proxy对象）； </p>
</li>
<li><p>之后对该对象的所有操作，都通过代理对象来完成，代理对象可以监听我们想要对原对象进行哪些操作； </p>
</li>
</ul>
</li>
<li><p>我们可以将上面的案例用Proxy来实现一次：</p>
<ul>
<li><p>首先，我们需要new Proxy对象，并且传入需要侦听的对象以及一个处理对象，可以称之为handler； </p>
<ul>
<li>const p = new Proxy(target, handler)</li>
</ul>
</li>
<li><p>其次，我们之后的操作都是直接对Proxy的操作，而不是原有的对象，因为我们需要在handler里面进行侦听；</p>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> objProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 获取值时的捕获器</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到对象的</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>key<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">属性被访问了</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>

  <span class="token comment">// 设置、添加值时的捕获器</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newValue</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到对象的</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>key<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">属性被设置值</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objProxy<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// why</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objProxy<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 18</span>

objProxy<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"kobe"</span><span class="token punctuation">;</span>
objProxy<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
objProxy<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">"男"</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// kobe</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 30</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>sex<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 男</span></code></pre>



<h2 id="Proxy-的-set-和-get-捕获器"><a href="#Proxy-的-set-和-get-捕获器" class="headerlink" title="Proxy 的 set 和 get 捕获器"></a>Proxy 的 set 和 get 捕获器</h2><ul>
<li><p>如果我们想要侦听某些具体的操作，那么就可以在handler中添加对应的捕捉器（Trap）：</p>
</li>
<li><p>set和get分别对应的是函数类型；</p>
<ul>
<li><p>set函数有四个参数：</p>
<ul>
<li><p>target：目标对象（侦听的对象）；</p>
</li>
<li><p>property：将被设置的属性key； </p>
</li>
<li><p>value：新属性值；</p>
</li>
<li><p>receiver：调用的代理对象；</p>
</li>
</ul>
</li>
<li><p>get函数有三个参数：</p>
<ul>
<li><p>target：目标对象（侦听的对象）；</p>
</li>
<li><p>property：被获取的属性key； </p>
</li>
<li><p>receiver：调用的代理对象；</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span> <span class="token comment">// 数据属性描述符</span>
  age<span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> objProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 获取值时的捕获器</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到对象的</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>key<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">属性被访问了</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> target<span class="token punctuation">)</span>
    <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>

  <span class="token comment">// 设置值时的捕获器</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newValue</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到对象的</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>key<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">属性被设置值</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> target<span class="token punctuation">)</span>
    target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newValue
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>

  <span class="token comment">// 监听in的捕获器</span>
  <span class="token function-variable function">has</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到对象的</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>key<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">属性in操作</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> target<span class="token punctuation">)</span>
    <span class="token keyword">return</span> key <span class="token keyword">in</span> target
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>

  <span class="token comment">// 监听delete的捕获器</span>
  <span class="token function-variable function">deleteProperty</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到对象的</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>key<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">属性in操作</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> target<span class="token punctuation">)</span>
    <span class="token keyword">delete</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>


<span class="token comment">// in操作符</span>
<span class="token comment">// console.log("name" in objProxy)</span>

<span class="token comment">// delete操作</span>
<span class="token keyword">delete</span> objProxy<span class="token punctuation">.</span>name</code></pre>



<h2 id="Proxy-的所有捕获器"><a href="#Proxy-的所有捕获器" class="headerlink" title="Proxy 的所有捕获器"></a>Proxy 的所有捕获器</h2><ul>
<li><p>handler.getPrototypeOf()</p>
</li>
<li><p>Object.getPrototypeOf 方法的捕捉器。</p>
</li>
<li><p>handler.setPrototypeOf()</p>
</li>
<li><p>Object.setPrototypeOf 方法的捕捉器。</p>
</li>
<li><p>handler.isExtensible()</p>
</li>
<li><p>Object.isExtensible 方法的捕捉器。</p>
</li>
<li><p>handler.preventExtensions()</p>
</li>
<li><p>Object.preventExtensions 方法的捕捉器。</p>
</li>
<li><p>handler.getOwnPropertyDescriptor()</p>
</li>
<li><p>Object.getOwnPropertyDescriptor 方法的捕捉器。</p>
</li>
<li><p>handler.defineProperty()</p>
</li>
<li><p>Object.defineProperty 方法的捕捉器。</p>
</li>
<li><p>handler.ownKeys()</p>
<ul>
<li><p>Object.getOwnPropertyNames 方法和</p>
<p>Object.getOwnPropertySymbols 方法的捕捉器。</p>
</li>
</ul>
</li>
<li><p><strong>handler.has()</strong></p>
</li>
<li><p>in 操作符的捕捉器。</p>
</li>
<li><p><strong>handler.get()</strong></p>
</li>
<li><p>属性读取操作的捕捉器。</p>
</li>
<li><p><strong>handler.set()</strong></p>
</li>
<li><p>属性设置操作的捕捉器。</p>
</li>
<li><p><strong>handler.deleteProperty()</strong></p>
</li>
<li><p>delete 操作符的捕捉器。</p>
</li>
<li><p>handler.apply()</p>
</li>
<li><p>函数调用操作的捕捉器。</p>
</li>
<li><p>handler.construct()</p>
<ul>
<li>new 操作符的捕捉器。</li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> fooProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">apply</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> thisArg<span class="token punctuation">,</span> argArray</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"对foo函数进行了apply调用"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">target</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>thisArg<span class="token punctuation">,</span> argArray<span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">construct</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> argArray<span class="token punctuation">,</span> newTarget</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"对foo函数进行了new调用"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">target</span><span class="token punctuation">(</span><span class="token operator">...</span>argArray<span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

<span class="token function">fooProxy</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">fooProxy</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"cba"</span><span class="token punctuation">)</span></code></pre>



<h2 id="Reflect-的作用"><a href="#Reflect-的作用" class="headerlink" title="Reflect 的作用"></a>Reflect 的作用</h2><ul>
<li><p>Reflect也是ES6新增的一个API，它是<strong>一个对象</strong>，字面的意思是<strong>反射</strong>。 </p>
</li>
<li><p><strong>那么这个Reflect有什么用呢？</strong></p>
<ul>
<li><p>它主要提供了很多操作JavaScript对象的方法，有点像Object中操作对象的方法； </p>
</li>
<li><p>比如Reflect.getPrototypeOf(target)类似于 Object.getPrototypeOf()； </p>
</li>
<li><p>比如Reflect.defineProperty(target, propertyKey, attributes)类似于Object.defineProperty() ； </p>
</li>
</ul>
</li>
<li><p>如果我们有Object可以做这些操作，那么<strong>为什么还需要有Reflect这样的新增对象</strong>呢？</p>
<ul>
<li><p>这是因为在早期的ECMA规范中没有考虑到这种对 <strong>对象本身</strong> 的操作如何设计会更加规范，所以将这些API放到了Object上面； </p>
</li>
<li><p>但是Object作为一个构造函数，这些操作实际上放到它身上并不合适； </p>
</li>
<li><p>另外还包含一些类似于 in、delete操作符，让JS看起来是会有一些奇怪的；</p>
</li>
<li><p>所以在ES6中新增了Reflect，让我们这些操作都集中到了Reflect对象上；</p>
</li>
</ul>
</li>
<li><p>那么Object和Reflect对象之间的API关系，可以参考MDN文档：</p>
</li>
</ul>
<p> <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect/Comparing_Reflect_and_Object_methods">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect/Comparing_Reflect_and_Object_methods</a></p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> objProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"get---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// return target[key];  这种方式实际上还是对原来的对象进行操作。</span>
    <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newValue<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"set---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newValue<span class="token punctuation">;</span>

    <span class="token keyword">const</span> result <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Reflect.set 可以判断是否添加或修改元素成功，而原始的方式无法得知</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

objProxy<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"kobe"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objProxy<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<h2 id="Reflect-的常见方法"><a href="#Reflect-的常见方法" class="headerlink" title="Reflect 的常见方法"></a>Reflect 的常见方法</h2><ul>
<li><p>Reflect中有哪些常见的方法呢？它和Proxy是一一对应的，也是13个：</p>
</li>
<li><p>Reflect.getPrototypeOf(target)</p>
<ul>
<li>类似于 Object.getPrototypeOf()。 </li>
</ul>
</li>
<li><p>Reflect.setPrototypeOf(target, prototype)</p>
<ul>
<li>设置对象原型的函数. 返回一个 Boolean， 如果更新成功，则返回true。 </li>
</ul>
</li>
<li><p>Reflect.isExtensible(target)</p>
<ul>
<li>类似于 Object.isExtensible()</li>
</ul>
</li>
<li><p>Reflect.preventExtensions(target)</p>
<ul>
<li>类似于 Object.preventExtensions()。返回一个Boolean。 </li>
</ul>
</li>
<li><p>Reflect.getOwnPropertyDescriptor(target, propertyKey) </p>
<ul>
<li>类似于 Object.getOwnPropertyDescriptor()。如果对象中存在该属性，则返回对应的属性描述符, 否则返回 undefined.</li>
</ul>
</li>
<li><p>Reflect.defineProperty(target, propertyKey, attributes)</p>
<ul>
<li>和 Object.defineProperty() 类似。如果设置成功就会返回 true</li>
</ul>
</li>
<li><p>Reflect.ownKeys(target)</p>
<ul>
<li>返回一个包含所有自身属性（不包含继承属性）的数组。(类似于Object.keys(), 但不会受enumerable影响).</li>
</ul>
</li>
<li><p>Reflect.has(target, propertyKey) </p>
<ul>
<li>判断一个对象是否存在某个属性，和 in 运算符 的功能完全相同。</li>
</ul>
</li>
<li><p>Reflect.get(target, propertyKey[, receiver])</p>
<ul>
<li>获取对象身上某个属性的值，类似于 target[name]。 </li>
</ul>
</li>
<li><p>Reflect.set(target, propertyKey, value[, receiver])</p>
<ul>
<li>将值分配给属性的函数。返回一个Boolean，如果更新成功，则返回true。 </li>
</ul>
</li>
<li><p>Reflect.deleteProperty(target, propertyKey) </p>
<ul>
<li>作为函数的delete操作符，相当于执行 delete target[name]。 </li>
</ul>
</li>
<li><p>Reflect.apply(target, thisArgument, argumentsList) </p>
<ul>
<li>对一个函数进行调用操作，同时可以传入一个数组作为调用参数。和Function.prototype.apply() 功能类似。</li>
</ul>
</li>
<li><p>Reflect.construct(target, argumentsList[, newTarget])</p>
<ul>
<li>对构造函数进行 new 操作，相当于执行 new target(…args)。</li>
</ul>
</li>
</ul>
<h2 id="Receiver-的作用"><a href="#Receiver-的作用" class="headerlink" title="Receiver 的作用"></a>Receiver 的作用</h2><ul>
<li><p>我们发现在使用getter、setter的时候有一个receiver的参数，它的作用是什么呢？</p>
<ul>
<li>如果我们的源对象（obj）有setter、getter的访问器属性，那么可以通过receiver来改变里面的this； </li>
</ul>
</li>
<li><p>我们来看这样的一个对象：</p>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  _name<span class="token operator">:</span> <span class="token string">"why"</span><span class="token punctuation">,</span>
  <span class="token keyword">get</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 我们希望如果是通过代理获取了 name ，然后返回 this._name 时，this 是代理对象objProxy，而不是 obj。那么我们便可以在 Reflect.get 时使用 receiver</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_name<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token keyword">set</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_name <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> objProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// receiver是创建出来的代理对象</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"get方法被访问--------"</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>receiver <span class="token operator">===</span> objProxy<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
    <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newValue<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"set方法被访问--------"</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 在 set 中设置 receiver 时，set 不仅会因 name触发，还会因为 _name 的修改而被触发。</span>
    Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newValue<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// console.log(objProxy.name)</span>
objProxy<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"kobe"</span><span class="token punctuation">;</span></code></pre>

<h2 id="Reflect的construct"><a href="#Reflect的construct" class="headerlink" title="Reflect的construct"></a>Reflect的construct</h2><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">Teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

<span class="token comment">// const stu = new Student("why", 18)</span>
<span class="token comment">// console.log(stu)</span>
<span class="token comment">// console.log(stu.__proto__ === Student.prototype)   // true</span>

<span class="token comment">// 执行Student函数中的内容, 但是创建出来对象是Teacher对象</span>
<span class="token keyword">const</span> teacher <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>Student<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"why"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Teacher<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>teacher<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Teacher &#123; name: 'why', age: 18 &#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>teacher<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Teacher</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre>



<h2 id="什么是响应式？"><a href="#什么是响应式？" class="headerlink" title="什么是响应式？"></a>什么是响应式？</h2><ul>
<li><p>我们先来看一下响应式意味着什么？我们来看一段代码：</p>
<ul>
<li><p>m有一个初始化的值，有一段代码使用了这个值；</p>
</li>
<li><p>那么在m有一个新的值时，这段代码可以自动重新执行；</p>
</li>
</ul>
</li>
</ul>
<p><img src="/blogs/f3f94af8/3_webfront2021\four_front\Blog\source_posts\CodeWhy-JavaScript高级-学习笔记1\59.jpg" loading="lazy"></p>
<ul>
<li>上面的这样一种可以自动响应数据变量的代码机制，我们就称之为是响应式的。 <ul>
<li>那么我们再来看一下对象的响应式：</li>
</ul>
</li>
</ul>
<h1 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h1><p><img src="/blogs/f3f94af8/.jpg" loading="lazy"></p>
</div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>语轻星子</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://xxcijmz.top/blogs/f3f94af8/" title="CodeWhy-JavaScript高级-学习笔记1">https://xxcijmz.top/blogs/f3f94af8/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/blogs/6af01b42/" rel="prev" title="CodeWhy-JavaScript高级-学习笔记2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">CodeWhy-JavaScript高级-学习笔记2</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/blogs/3c70d866/" rel="next" title="CodeWhy-Vue3-TS-学习笔记3"><span class="post-nav-text">CodeWhy-Vue3-TS-学习笔记3</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>要不要和我说些什么？</span><br></div><div id="valine-container"></div><script>Yun.utils.getScript("https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js", () => {
  const valineConfig = {"enable":true,"appId":"MnqOxUn1tp2XfaBiRJqcPNC3-MdYXbMMI","appKey":"BUJAYYUt5IhdIDVVvHH8aHMx","placeholder":"来与我一起讨论吧","avatar":null,"pageSize":10,"visitor":false,"highlight":true,"recordIP":false,"enableQQ":true,"meta":["nick"],"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = "/blogs/f3f94af8/"
  new Valine(valineConfig)
}, window.Valine);</script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">闽ICP备2021017107号-1</a></div><div class="copyright"><span>&copy; 2021 – 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> 语轻星子</span></div><div class="live_time"><span>本博客已运行：</span><span id="display_live_time"></span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2021-09-23T00:03:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " 天 " + passHour + " 小时 " + passMinute + " 分 " + passSecond + " 秒";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#5698c3" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script defer src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script defer src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script defer src="/js/search/algolia-search.js"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div class="algolia-pagination" id="algolia-pagination"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.9},"dialog":{"enable":true},"log":false});</script></body></html>